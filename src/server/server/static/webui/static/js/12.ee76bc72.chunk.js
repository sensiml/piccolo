"use strict";(self.webpackChunksensiml_web=self.webpackChunksensiml_web||[]).push([[12],{20210:(e,t,a)=>{a.d(t,{$:()=>j});var l=a(65043),n=a(53536),i=a.n(n),r=a(11906),s=a(98533),o=a(96446),d=a(67784),c=a(7426),u=a(59478),p=a(7478),m=a(51787),b=a(70579);const h=e=>{let{presetColors:t,defautColor:a,label:n,onUpdate:i}=e;const r=(0,p.A)((e=>({colorBox:{marginRight:e.spacing(1),height:e.spacing(3),width:e.spacing(3),cursor:"pointer",transition:e.transitions.create(["all"],{duration:e.transitions.duration.complex}),"&:hover":{transform:"scale(1.15)"}}})))(),[s,c]=(0,l.useState)(!1),[h,v]=(0,l.useState)(""),g=e=>{v(e),i(e)};return(0,l.useEffect)((()=>{v(a)}),[a]),(0,b.jsxs)("div",{style:{width:"100%"},children:[(0,b.jsx)(d.A,{autoFocus:!0,margin:"dense",id:"labelColorPicker",label:n,value:h,onChange:e=>{var t;return g((null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)||"")},fullWidth:!0,variant:"outlined",InputProps:{startAdornment:(0,b.jsx)(m.A,{position:"start",children:(0,b.jsx)(o.A,{className:r.colorBox,onClick:()=>c(!0),style:{background:h}})})}}),s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.A,{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:()=>c(!1)}),(0,b.jsx)("div",{style:{position:"fixed",zIndex:"2"},children:(0,b.jsx)(u.Xq,{color:h,disableAlpha:!0,onChange:e=>g(e.hex),presetColors:t})})]}):null]})};h.defaultProps={presetColors:[],onUpdate:()=>{}};const v=h;var g=a(18545),x=a(4172),f=a(97557),A=a(81131);const y=e=>{let{isOpen:t,title:a,description:n,labelName:u,defaultLabelColor:p,getLabelNamesToCheck:m,labelGroupOptions:h,defaultLabelGroup:y,onClose:j,onSubmit:C,validationError:S}=e;const{t:L}=(0,c.B)("components"),[w,E]=(0,l.useState)(),[D,U]=(0,l.useState)(),[I,N]=(0,l.useState)(),[k,_]=(0,l.useState)(""),[M,W]=(0,l.useState)(!1),V=(0,l.useMemo)((()=>m(k||y).filter((e=>e!==i().toLower(u)&&e!==i().toLower(f.dG.value)))),[k,y,u,m]),B=(0,l.useMemo)((()=>D||p||(0,f.Vy)(V.length)),[D,V,p]),R=()=>{j()},O=()=>{W(!1),N(""),E("")};return(0,l.useEffect)((()=>{S&&(W(!1),N(S))}),[S]),(0,l.useEffect)((()=>{E(u)}),[u]),(0,l.useEffect)((()=>{t||O()}),[t]),(0,l.useEffect)((()=>()=>O()),[]),(0,b.jsx)(x.A,{disableEscapeKeyDown:!0,isOpen:t,onClose:R,title:a,actionsComponent:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.A,{onClick:R,color:"primary",variant:"outlined",fullWidth:!0,children:L("Cancel")}),(0,b.jsx)(r.A,{onClick:()=>{var e;((e=w)?!V.includes(i().toLower(e))||(N(L("dialog-form-label.validation-error-duplicate",{labelName:e})),0):(N(L("dialog-form-label.validation-error-empty")),0))&&(W(!0),C(w,B,k))},color:"primary",variant:"contained",fullWidth:!0,children:L("Save")})]}),children:(0,b.jsx)(b.Fragment,{children:M?(0,b.jsx)(A._S,{isOpen:!0}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.A,{id:"form-dialog-content",children:n}),(null===h||void 0===h?void 0:h.length)>1&&!u?(0,b.jsx)(o.A,{mb:2,children:(0,b.jsx)(g.A,{id:"select_label",name:"select_label",label:L("dialog-form-label.label-group"),options:h,variant:"outlined",margin:"dense",defaultValue:y,onChange:(e,t)=>{N(""),_(t)}})}):null,(0,b.jsx)(o.A,{marginBottom:2,children:(0,b.jsx)(d.A,{error:Boolean(I),helperText:I,autoFocus:!0,margin:"dense",id:"DialogFormlabelName",label:L("dialog-form-label.label-name"),required:!0,defaultValue:u,onChange:e=>{var t;N(""),E(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)},fullWidth:!0,variant:"outlined"})}),(0,b.jsx)(o.A,{marginBottom:2,children:(0,b.jsx)(v,{presetColors:f.ji,defautColor:B,label:L("dialog-form-label.label-color"),onUpdate:e=>{U(e)}})})]})})})};y.defaultProps={onSubmit:()=>{},onClose:()=>{}};const j=y},14381:(e,t,a)=>{a.d(t,{A:()=>r});a(65043);var l=a(7478),n=a(96446),i=a(70579);const r=e=>{let{name:t,color:a,className:r=""}=e;const s=(0,l.A)((e=>({wrapper:{display:"flex",alignItems:"center",width:"100%"},colorBox:{marginRight:e.spacing(1),height:"1rem",width:"1rem"}})))();return(0,i.jsxs)(n.A,{className:s.wrapper,children:[(0,i.jsx)(n.A,{className:s.colorBox,style:{background:a}}),(0,i.jsx)("span",{className:"".concat(s.name," ").concat(r),children:t})]})}},29765:(e,t,a)=>{a.d(t,{A:()=>s});a(65043);var l=a(85865),n=a(63336),i=a(96446),r=a(70579);const s=e=>{const{children:t,value:a,index:s,p:o=2,mt:d=2,...c}=e;return(0,r.jsx)(l.A,{component:"div",role:"tabpanel",hidden:a!==s,id:"full-width-tabpanel-".concat(s),"aria-labelledby":"full-width-tab-".concat(s),...c,children:a===s&&(0,r.jsx)(n.A,{elevation:0,children:(0,r.jsx)(i.A,{p:o,mt:d,children:t})})})}},26831:(e,t,a)=>{a.d(t,{A:()=>p});var l=a(65043),n=a(53536),i=a.n(n),r=a(96446),s=a(43845),o=a(51962),d=a(7478),c=a(98424),u=a(70579);const p=e=>{let{parameters:t}=e;const a=(0,d.A)((e=>({descriptionContainer:{width:"100%",margin:"".concat(e.spacing(2)," 0")},descriptionParamsWrapper:{display:"flex",flexDirection:"row"},descriptionParamsWrap:{justifyContent:"flex-start",alignItems:"center",display:"flex",flex:2,marginTop:e.spacing(1),marginBottom:e.spacing(1),"&:first-child":{fontWeight:600,flex:1,color:e.colorBrandText}},paramChipItem:{margin:"0 ".concat(e.spacing(.5))}})))(),n=(0,l.useCallback)((e=>i().isArray(e)?(0,u.jsx)(r.A,{children:e.map(((e,t)=>(0,u.jsx)(s.A,{className:a.paramChipItem,label:e},"param_".concat(t))))}):i().isBoolean(e)?(0,u.jsx)(o.A,{defaultChecked:!0,checked:e}):!i().isObject(e)&&e||(0,l.isValidElement)(e)?e:""),[t]),p=(0,l.useCallback)((e=>i().isObject(e)?"":i().startCase(e)),[t]);return(0,u.jsx)(u.Fragment,{children:i().isEmpty(t)?null:(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(r.A,{className:a.descriptionContainer,children:i().entries(t).map(((e,t)=>{let[l,s]=e;return(0,u.jsx)(r.A,{className:a.descriptionParamsWrapper,children:i().isUndefined(s)?null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(r.A,{className:a.descriptionParamsWrap,children:p(l)}),(0,u.jsx)(r.A,{className:a.descriptionParamsWrap,children:n(s)})]})},"desc_param_".concat(t,"_").concat((0,c.I4)(s)))}))})})})}},91012:(e,t,a)=>{a.r(t),a.d(t,{default:()=>He});var l=a(97508),n=a(34455),i=a(7996),r=a(67500),s=a(41104),o=a(90471);var d=a(20697),c=a(26481),u=a(61703),p=a(53536),m=a.n(p),b=a(56604);const h=(e,t,a,l)=>n=>{const i=a=>({capture:e,...!a.isCreated&&{uuid:a.id},label:t,label_value:a.labelValueUUID,capture_sample_sequence_start:a.start,capture_sample_sequence_end:a.end}),r=[],s=[];let o=[];return o=l.filter((e=>{var t;return!(null!==(t=a[e])&&void 0!==t&&t.isCreated)})),m().values(a).forEach((e=>{e.isCreated&&!l.includes(e.id)?s.push(i(e)):e.isCreated||r.push(i(e))})),[r,s,o]};var v=a(39338),g=a(61689),x=a(50440),f=a(12826),A=a(97557);var y=a(65043),j=a(67254),C=a(7426),S=a(91688),L=a(17022),w=a(39568),E=a(11313),D=a(69120),U=a(96446),I=a(63336),N=a(85865),k=a(56258),_=a(20991),M=a(24056),W=a(63471),V=a(95540),B=a(95004),R=a(77739),O=a(17392),P=a(51962),q=a(11906),F=a(5259),T=a(14381),z=a(18545),G=a(76246),H=a(55692),$=a(52437),Y=a(6011),Z=a(7478);const X=()=>(0,Z.A)((e=>({...e.common,labelFormTitle:{marginBottom:e.spacing(2),textAlign:"center"},formControl:{marginTop:e.spacing(4),marginBottom:e.spacing(2),width:"100%"},boxStartEndWrapper:{display:"flex",gap:e.spacing(2)},boxStartEndWrap:{width:"100%"}})))();var J=a(70579);const K="labelSelected",Q=e=>{let{selectedCapture:t,labels:a=[],editingSegment:l,onChangeEditedLabel:n,onDeleteLabels:i,onRowSelection:r,labeValueOptions:s,isReadOnlyMode:o=!1,isDisabledByAutoSession:d=!1}=e;const c=X(),{t:u}=(0,C.B)("components"),[p,b]=(0,y.useState)([]),[h,v]=(0,y.useState)(""),[g,x]=(0,y.useState)(-1),[f,A]=(0,y.useState)({}),[S,L]=(0,y.useState)(!1),[w,E]=(0,y.useState)(!1),[D,I]=(0,y.useState)(""),[N,k]=(0,y.useState)([]),_=(0,y.useMemo)((()=>a.data.find((e=>e.id===h))||{}),[h,a]),M=(0,y.useMemo)((()=>m().isEmpty(p)||o),[p,o]),Z=(0,y.useMemo)((()=>o||d),[o,d]),Q=(0,y.useMemo)((()=>m().isEmpty(p)&&!d),[S,p,d]),ee=(0,y.useMemo)((()=>m().isEmpty(p)?[h]:p),[p,h]),te=(0,y.useMemo)((()=>({data:m().map(null===a||void 0===a?void 0:a.data,(e=>({[K]:p.includes(e.id)?1:0,...e}))),isFetching:(null===a||void 0===a?void 0:a.isFetching)||!1})),[p,a]),ae=e=>{e&&v(e),L(!0)},le=()=>{L(!1),v("")},ne=(e,t)=>{A((a=>{const l={...a};return l[e]=t,l}))},ie=e=>{E(!0),e&&v(e)},re=()=>{E(!1),v("")};(0,y.useEffect)((()=>{v(l.id)}),[l]),(0,y.useEffect)((()=>{const e=a.data.findIndex((e=>e.id===l.id));x(e)}),[a]);const se=[{title:" ",field:K,sortable:!0,type:$.$.Numeric,lookup:{0:u("label-table.header-unselected"),1:u("label-table.header-selected")},render:(e,t)=>(0,J.jsx)(R.A,{title:p.includes(null===t||void 0===t?void 0:t.id)?u("label-table.tooltip-label-selected"):u("label-table.tooltip-label-not-selected"),children:(0,J.jsx)(O.A,{variant:"contained",color:"primary",size:"small",children:(0,J.jsx)(P.A,{checked:p.includes(null===t||void 0===t?void 0:t.id),onClick:()=>(e=>{p.includes(null===e||void 0===e?void 0:e.id)?b(p.filter((t=>t!==e.id))):b([...p,e.id])})(t),color:"primary"},"capture-label-selection-".concat(null===t||void 0===t?void 0:t.id))})})},{title:u("label-table.header-id"),field:"sequence",sortable:!0,type:$.$.Numeric,render:e=>e||""},{title:u("label-table.header-name"),field:"name",sortable:!0,type:$.$.Text,filterable:!0,render:(e,t)=>(0,J.jsx)(T.A,{name:(null===t||void 0===t?void 0:t.name)||"",color:(null===t||void 0===t?void 0:t.color)||""})},{title:u("label-table.header-start"),field:"start",sortable:!0,type:$.$.Numeric},{title:u("label-table.header-end"),field:"end",sortable:!0,type:$.$.Numeric},{title:u("label-table.header-length"),field:"length",sortable:!0,type:$.$.Numeric,render:(e,t)=>m().subtract(t.end+1,t.start)},{title:u("label-table.header-edit"),field:"id",render:e=>(0,J.jsx)(R.A,{title:u("label-table.tooltip-label-edit-label"),children:(0,J.jsx)(O.A,{variant:"contained",color:"primary",size:"small",onClick:()=>ae(e),disabled:!M||o,children:(0,J.jsx)(V.A,{})})})},{title:u("label-table.header-delete"),field:"id",render:e=>(0,J.jsx)(R.A,{title:u("label-table.tooltip-label-delete-label"),children:(0,J.jsx)(O.A,{variant:"contained",color:"primary",size:"small",onClick:()=>ie(e),disabled:!M||Z,children:(0,J.jsx)(W.A,{})})})}],oe=u("label-table.title"),de={rowsPerPage:30,showPagination:!0,noContentText:u("label-table.empty-content"),excludePrimaryFromDetails:!0,applyFilters:!0,onRowSelection:r,selectedRowId:h,selectedRowIndex:g,isShowSelection:!0,onSelectAllInTable:()=>{b(N.map((e=>e.id)))},onUnSelectAllInTable:()=>{b([])},captureTableData:e=>k(e)};return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Y.f,{title:oe,ActionComponent:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(q.A,{startIcon:(0,J.jsx)(V.A,{}),variant:"outlined",color:"primary",className:c.mr1,disabled:M,onClick:()=>ae(),children:u("label-table.panel-btn-edit")}),(0,J.jsx)(q.A,{startIcon:(0,J.jsx)(W.A,{}),variant:"outlined",color:"primary",className:c.mr1,disabled:M||Z,onClick:()=>ie(),children:u("label-table.panel-btn-delete")})]})}),(0,J.jsx)(F.A,{tableId:"lableTable",tableData:te,tableColumns:se,tableOptions:de}),(0,J.jsxs)(H.A,{isOpen:S,title:u("label-table.form-edit-title"),onClose:le,onSubmit:()=>{I("");const{name:e,color:l,labelValueUUID:i,start:r,end:s}=f;((e,l)=>!Q||(e>l?(I(u("label-table.lalel-form-error-stat-greater-end")),!1):e<0?(I(u("label-table.lalel-form-error-stat-less-0")),!1):l>t.max_sequence?(I(u("label-table.lalel-form-error-end-greater-max")),!1):!a.data.find((t=>t.start===e&&t.end===l&&t.id!==h))||(I(u("label-table.lalel-form-error-dublicates")),!1)))(r,s)&&(ee.forEach((t=>{n({id:t,name:e,color:l,labelValueUUID:i,start:r,end:s})})),le(),b([]))},children:[m().isEmpty(D)?null:(0,J.jsx)(j.A,{severity:"error",children:D}),(0,J.jsx)(U.A,{className:c.formControl,children:(0,J.jsx)(z.A,{className:c.labelSelector,id:"select_label",fullWidth:!0,name:"labelValueUUID",label:u("label-table.form-edit-label-label"),defaultValue:null===_||void 0===_?void 0:_.labelValueUUID,options:s.map((e=>({name:(0,J.jsx)(T.A,{name:null===e||void 0===e?void 0:e.name,color:null===e||void 0===e?void 0:e.color}),value:null===e||void 0===e?void 0:e.uuid}))),onChange:(e,t)=>{const{color:a,name:l,uuid:n}=s.find((e=>e.uuid===t));A({...f,name:l,color:a,uuid:n,labelValueUUID:t})}},_.id)}),Q?(0,J.jsx)(U.A,{className:c.formControl,children:(0,J.jsxs)(U.A,{className:c.boxStartEndWrapper,children:[(0,J.jsx)(U.A,{className:c.boxStartEndWrap,children:(0,J.jsx)(G.A,{id:"start",name:"start",label:u("label-table.form-edit-label-start"),defaultValue:_.start,onChange:ne,fullWidth:!0})}),(0,J.jsx)(U.A,{className:c.boxStartEndWrap,children:(0,J.jsx)(G.A,{id:"end",name:"end",label:u("label-table.form-edit-label-end"),defaultValue:_.end,onChange:ne,fullWidth:!0})})]})}):null]}),(0,J.jsx)(B.Z,{isOpen:w,title:u("label-table.alert-deleting-title"),text:u("label-table.alert-deleting-text"),onConfirm:()=>{i(ee),b([]),re()},onCancel:re,cancelText:u("dialog-confirm-delete.cancel"),confirmText:u("dialog-confirm-delete.delete")})]})};Q.defaultProps={onChangeEditedLabel:()=>{},onDeleteLabels:()=>{}};const ee=Q;var te=a(1577),ae=a(69413),le=a(74605),ne=a(54469),ie=a(7323),re=a(39720),se=a(88911),oe=a(1965),de=a(70939),ce=a(34294),ue=a(98424);const pe=()=>(0,Z.A)((()=>({unSelectedLegendValue:{textDecoration:"line-through",opacity:"0.3"},legendWrapper:{padding:"0 2rem"}})))();var me=a(37352),be=a(26722),he=a(1645),ve=a(1280),ge=a(74893),xe=a(99224),fe=a(31739);const Ae=e=>[e[1],e[0]],ye=e=>{const t=(e=>{switch(e){case"x":return(0,fe.brushX)();case"y":return(0,fe.brushY)();case"xy":return(0,fe.brush)()}})(e),a=(0,ve.A)("brush","start","end");let l=(0,be.A)(),n=(0,be.A)();const i=(0,xe.Ay)("g","brush"),r=(t,a,l)=>{switch(e){case"x":return t.map(a);case"y":return t.map(l);case"xy":return[[a(t[0][0]),l(t[0][1])],[a(t[1][0]),l(t[1][1])]]}},s=t=>{const a=(0,he.A)().domain(l.domain());return"x"===e?t.map(a.invert):"xy"===e?[a.invert(t[0][0]),a.invert(t[1][0])]:void 0},o=t=>{const a=(0,he.A)().domain(Ae(n.domain()));return"y"===e?[t[1],t[0]].map(a.invert):"xy"===e?[a.invert(t[1][1]),a.invert(t[0][1])]:void 0},d=(e,t,i)=>{if(e.sourceEvent&&"draw"===e.sourceEvent.type)return;const d=e=>{let[a,l]=e;i.call(t).call(t.move,[a,l])};if(e.selection){const t=(c=e.selection,r(c,(0,he.A)().domain(l.range()),(0,he.A)().domain(Ae(n.range()))));a.call(e.type,{},{moveBrush:d,selection:t,windowlSelection:e.selection,xDomain:s(t),yDomain:o(t)})}else a.call(e.type,{},{});var c},c=e=>{e.each(((e,a,s)=>{t.extent([[l.range()[0],n.range()[1]],[l.range()[1],n.range()[0]]]);const o=i((0,me.A)(s[a]),[e]);t.on("end",(e=>d(e,t,o))).on("brush",(e=>d(e,t,o))).on("start",(e=>d(e,t,o))),o.call(t).call(t.move,e?r(e,(0,he.A)().domain(l.range()).invert,(0,he.A)().domain(Ae(n.range())).invert):null)}))};return c.xScale=function(){return arguments.length?(l=arguments.length<=0?void 0:arguments[0],c):l},c.yScale=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],c):n},(0,ge.A)(c,a,"on"),(0,ge.A)(c,t,"filter","handleSize"),c};const je=(0,a(34535).Ay)(re.Ay)((()=>({"& .MuiSlider-thumb":{transition:"none"},"& .MuiSlider-track":{transition:"none"}}))),Ce="#0071C5",Se=oe.m4Y(),Le=oe.m4Y(),we=e=>{let{audioFile:t,data:a,seriesNameList:l,segmentData:n,newSegment:i,editingSegment:r,onSementMove:s,onNewSegmentMove:o,onSetEditedSegment:d,audioFileSampleRate:c=16e3,isReadOnlyMode:u=!1}=e;const p=pe(),b=(0,y.useRef)(null),h=(0,y.useRef)(),[v,g]=(0,y.useState)(-1),[x,f]=(0,y.useState)([1,1]),[j,C]=(0,y.useState)([0,0]),[S,L]=(0,y.useState)([0,1]),[w,E]=(0,y.useState)([]),[D,I]=(0,y.useState)(!1),[N,k]=(0,y.useState)(0),[_,M]=(0,y.useState)(0),W=oe.UMr(A.ji).domain([...l]),V=de.extentLinear().accessors([e=>e.value]),B=de.extentLinear().accessors([e=>e.sequence]);let R=-1,O=!1,q=[0,1];const F=e=>"segment_".concat(e),z=(0,y.useMemo)((()=>a[0]),[a]),G=(0,y.useMemo)((()=>{const e=a.reduce(((e,t,a)=>{var l,n;null!==(l=t[0])&&void 0!==l&&l.name&&(e[a]=null===(n=t[0])||void 0===n?void 0:n.name);return e}),{});return a.filter(((t,a)=>!w.includes(e[a])))}),[a,w]),H=de.seriesCanvasLine().mainValue((e=>e.value)).crossValue((e=>e.sequence)),$=de.seriesCanvasRepeat().xScale(Se).yScale(Le).series(H).decorate(((e,t,a)=>{var l,n,i;null!==(l=t[a][0])&&void 0!==l&&l.name&&W(null===(n=t[a][0])||void 0===n?void 0:n.name)?e.strokeStyle=W(null===(i=t[a][0])||void 0===i?void 0:i.name):e.strokeStyle=W(a)})).orient("horizontal"),Y=de.seriesCanvasLine().mainValue((e=>e.value)).crossValue((e=>e.sequence)).decorate((e=>{e.strokeStyle=Ce})),Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0];return[Math.round(Se.invert(e[0])),Math.round(Se.invert(e[1]))]},X=(e,t,a,l,n)=>{const i=document.querySelector("d3fc-svg");if(!i)return;const r=oe.Ltv(i).select("svg");if(g(l),R!==l){r.select(".brushes").select("#band_brash_".concat(R)).select(".selection").attr("stroke-width","0")}const o=oe.n55().on("end",(e=>{null!==e&&void 0!==e&&e.mode&&((e,t)=>{if(e.selection){const[a,l]=Z(e.selection);s(a,l,t)}})(e,l)})),d=r.node().getBoundingClientRect().width,c=r.node().getBoundingClientRect().height,u=[[0,0],[d,c]];0!==S[0]&&(u[0]=[Se(S[0]),0]),1!==S[1]&&(u[1]=[d+m().multiply(d,1-S[1]),c]),o.extent(u);const p=r.select(".brushes").append("g").call(o).call(o.move,[Se(e),Se(t)]).attr("id","band_brash_".concat(l)).attr("class","brash");R=l,p.selectAll(".overlay").remove(),p.selectAll(".selection").attr("fill",a).attr("fill-opacity","0.5").attr("stroke",Ce).attr("stroke-width","2"),oe.ZRL(p)},K=(e,t)=>{const a=oe.n55().on("end",(e=>{null!==e&&void 0!==e&&e.mode&&((e,t)=>{if(e.selection){const[a,l]=Z(e.selection);o(a,l,t)}})(e,t)})),l=e.select(".brushes").append("g").call(a).attr("id","band_brash_".concat(t)).attr("class","brash");oe.ZRL(l)},Q=de.annotationSvgBand().orient("vertical").xScale(Se).yScale(Le).fromValue((e=>e.start)).toValue((e=>e.end)).decorate((e=>{e.attr("id",(e=>F(e.id))).style("fill",(e=>e.color)).style("opacity","0.5").attr("cursor","pointer"),e.on("click",((e,t)=>{if(!O){const{id:e}=t;d(e)}}))})),ee=(e,t)=>{const a=document.querySelector("d3fc-svg");if(!a)return;const l=oe.Ltv(a).select("svg"),i=t||v;oe.Ltv(a).on("draw",(()=>{const t=n.find((e=>i===e.id));oe.Ltv(".svg-plot-area").selectAll(".brushes").remove();var a,r,s,o,d;l.datum((a=n,j[0]?a.filter((e=>i!==e.id&&e.end>j[0]&&j[1]>e.start)):a.filter((e=>i!==e.id)))),l.call(Q),l.append("g").attr("class","brushes"),t&&(u?l.datum([1]).select(".brushes").append("g").call((r=t.start,s=t.end,o=t.color,d=t.id,de.annotationSvgBand().orient("vertical").xScale(Se).yScale(Le).fromValue(r).toValue(s).decorate((e=>{e.attr("id",F(d)).attr("fill-opacity","0.5").attr("fill",o).attr("cursor","pointer").attr("stroke",Ce).attr("stroke-width","2").attr("class","brash")})))):X(t.start,t.end,t.color,t.id)),e&&K(l,e),l.append("g").append("line").attr("id","line").attr("x1",0).attr("stroke-width",3).attr("y1",0).attr("x2",0).attr("y2",500),l.append("use").attr("xlink:href","#line")})).on("measure",(e=>{})),a.requestRedraw()},te=e=>{const t=document.querySelector("d3fc-svg"),a=oe.Ltv(t).select("svg"),l=Se(e*c);a.select("line").attr("x1",l).attr("x2",l).attr("stroke","red")};let re=oe.m4Y().range();const me=e=>{if(e.windowlSelection&&e.windowlSelection[1]-e.windowlSelection[0]<5?e.moveBrush(re):re=e.windowlSelection,!(e.xDomain&&e.xDomain[1]-e.xDomain[0]<10)&&e.selection&&e.selection!==[0,1]){q=e.selection,L(q);const t=[Math.round(e.xDomain[0]),Math.round(e.xDomain[1])];xe(t)}},be=ye("x").on("brush",me).on("end",me),he=de.seriesSvgMulti().series([be]).mapping(((e,t,a)=>(a[t],q))),ve=de.chartCartesian(Se.copy(),Le.copy()).yAxisWidth(0).yDomain(V(z)).xDomain(B(z)).svgPlotArea(he).canvasPlotArea(Y),ge=de.seriesSvgMulti().series([]),xe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;C(e);let t=[...G];(e[0]||e[1])&&oe.Ltv("#chart")&&(t=G.map((t=>m().filter(t,(t=>t.sequence>e[0]&&t.sequence<e[1])))));const a=t.reduce(((e,t)=>m().union(e,t)),[]),l=B(a),n=V(a),i=de.chartCartesian({xScale:Se,yScale:Le,xAxis:{bottom:(e,t)=>de.axisBottom(e)}}).xDomain(l).yDomain(n).svgPlotArea(ge).canvasPlotArea($);return oe.Ltv("#chart").datum(t).call(i),f(n)},fe=()=>{clearInterval(h.current)},Ae=()=>{I(!0),fe(),h.current=setInterval((()=>{b.current.ended&&(I(!1),fe()),te(b.current.currentTime),k(b.current.currentTime)}),[50]),b.current.play()};(0,y.useEffect)((()=>{m().isEmpty(G)||(xe(),q=S),oe.Ltv("#navigator-chart").datum(z).call(ve),oe.Ubm(".handle").attr("fill",Ce).attr("width",8).attr("heigt",34).attr("y",4).attr("ry",10),oe.Ltv("#navigator-chart").selectAll(".overlay").attr("pointer-events","none")}),[z,G]);return(0,y.useEffect)((()=>()=>{oe.Ubm("#chart").remove("*")}),[]),(0,y.useEffect)((()=>{n&&(ee(),q=S)}),[n,j,x]),(0,y.useEffect)((()=>{m().isEmpty(i)?(O=!1,ee()):(g(-1),O=!0,i.start?i.color&&oe.Ltv("#band_brash_".concat(i.id)).selectAll(".selection").attr("fill",i.color).attr("fill-opacity","0.5").attr("stroke",i.color).attr("stroke-width","2"):ee(i.id))}),[i]),(0,y.useEffect)((()=>{m().isEmpty(r)||v===r.id||(g(r.id),ee(void 0,r.id))}),[r]),(0,y.useEffect)((()=>()=>{var e;null===(e=b.current)||void 0===e||e.pause(),fe()}),[]),(0,y.useEffect)((()=>{t&&(b.current=new Audio(t),b.current.addEventListener("loadedmetadata",(()=>{const{duration:e}=b.current;M(e)})))}),[t]),(0,J.jsxs)("div",{className:"base__container",children:[(0,J.jsx)("div",{id:"chart",style:{height:"500px"}}),(0,J.jsx)(ae.A,{row:!0,className:p.legendWrapper,children:l.map((e=>(0,J.jsx)(le.A,{control:(0,J.jsx)(P.A,{style:{display:"none"},checked:!w.includes(e),onChange:t=>((e,t)=>{e?E(w.filter((e=>e!==t))):w.length<l.length-1&&E([...w,t])})(t.target.checked,e),name:e}),label:(0,J.jsx)(T.A,{className:w.includes(e)?p.unSelectedLegendValue:"",name:e,color:W(e)})},e)))}),(0,J.jsx)("div",{id:"navigator-chart",style:{height:"100px",marginRight:"48px"}}),b.current?(0,J.jsxs)(se.A,{sx:{paddingLeft:"1rem",marginRight:"calc(48px + 1rem)"},children:[(0,J.jsx)(je,{"aria-label":"audio-player-time-indicator",size:"small",value:N,min:0,max:_,step:.1,onChange:e=>{return t=e.target.value,D&&(fe(),b.current.pause()),te(t),k(t),void(b.current.currentTime=t);var t},onChangeCommitted:()=>{D&&Ae()}}),(0,J.jsxs)(U.A,{sx:{display:"grid",alignItems:"center",justifyContent:"space-between",gridTemplateColumns:"5rem auto 5rem",fontSize:"0.875rem"},children:[(0,J.jsx)(U.A,{sx:{marginTop:"-1rem",display:"flex",justifyContent:"flex-start"},children:(0,ue.O_)(N)}),(0,J.jsx)(U.A,{children:D?(0,J.jsx)(ce.tA,{color:"primary",onClick:()=>{fe(),I(!1),b.current.pause()},children:(0,J.jsx)(ie.A,{})}):(0,J.jsx)(ce.tA,{color:"primary",onClick:Ae,children:(0,J.jsx)(ne.A,{})})}),(0,J.jsxs)(U.A,{sx:{marginTop:"-1rem",display:"flex",justifyContent:"flex-end"},children:["-",(0,ue.O_)(_-N)]})]})]}):null]})};we.defaultProps={onSementMove:()=>{}};const Ee=we;var De=a(59352),Ue=a(29765),Ie=a(26831),Ne=a(97111),ke=a(81131),_e=a(92653),Me=a(33206),We=a(20210);const Ve=()=>(0,Z.A)((e=>({segmentsChartPanelWrapper:{width:"calc(100% - 2rem)",justifyContent:"flex-start",display:"inline-flex",columnGap:"2em","@media (max-width: 900px)":{display:"block",justifyContent:"center"}},segmentsChartPanelCenterWrap:{fontWeight:500,color:e.palette.primary.main,marginLeft:"auto","@media (max-width: 900px)":{width:"100%",marginBottom:"1em"}},segmentsAlterWrapper:{marginLeft:"1em","@media (max-width: 900px)":{width:"100%",marginBottom:"1em"}},labelWrapper:{maxWidth:"50%",flexGrow:1,marginLeft:"auto","@media (max-width: 900px)":{width:"100%",marginBottom:"1em"}},labelSelector:{},labelingPanelActionWrapper:{display:"flex",alignItems:"center",justifyContent:"flex-end",height:"100%",columnGap:e.spacing(2),marginLeft:"auto",marginTop:"auto",marginBottom:"auto"},labelActionWrapper:{display:"flex",alignItems:"center",gap:e.spacing(2),height:"100%"},labelActionButton:{border:"1px solid ".concat(e.palette.primary.main)},loadingBox:{position:"absolute",top:0,left:0,width:"100%"},cordinateWrap:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"0 ".concat(e.spacing(2))},captureMetadataWrapper:{display:"flex",maxWidth:e.spacing(80),paddingLeft:e.spacing(4)},chartInformationWrapper:{padding:"".concat(e.spacing(.5)," ").concat(e.spacing(2)),display:"flex",alignItems:"center",justifyContent:"space-between",gap:e.spacing(1),borderBottom:"2px solid ".concat(e.backgroundApp)},chartInformation:{display:"flex",gap:e.spacing(1),"@media (max-width: 1400px)":{minWidth:"30%"},"@media (max-width: 900px)":{flexDirection:"column",gap:"0"}},chartInformationAlertWholeLine:{width:"100%",borderBottom:"2px solid ".concat(e.backgroundApp),"& .MuiAlert-root":{padding:"0 0.5rem"}},chartInformationHeader:{color:e.palette.primary.main,fontWeight:500,marginRight:e.spacing(1)}})))();var Be=a(94329),Re=a(85742),Oe=a(6502),Pe=a(22505);const qe=e=>{let{isDisabledByAutoSession:t,isReadOnlyMode:a,isHasChanges:l,editedLabel:n,editingLabelIndex:i,labelsCount:r,newLabel:s,lastLabelValueUUID:o,labeValueOptions:d,onSetEditedLabel:c,onOpenCreateLabelDialog:u,onChangeEditedLabel:p,onDeleteEditedLabel:b,onSaveChanges:h,onDiscardChanges:v,onChangeNewLabel:g,onCreateLabel:x,onDiscardNewLabel:f}=e;const A=Ve(),{t:S}=(0,C.B)("data-manager"),[L,w]=(0,y.useState)(!1),E=(0,y.useMemo)((()=>null!==n&&void 0!==n&&n.start&&null!==n&&void 0!==n&&n.end?n:null!==s&&void 0!==s&&s.start&&null!==s&&void 0!==s&&s.end?s:{}),[n,s]),I=(0,y.useMemo)((()=>0===i),[i]),N=(0,y.useMemo)((()=>i===r-1),[n,i,r]),k=(0,y.useMemo)((()=>Number(E.end)+1-Number(E.start)),[E]),_=e=>{c(e)};return(0,Me.G4)((e=>{w(e.innerWidth<1850)})),(0,J.jsx)(J.Fragment,{children:(0,J.jsxs)(U.A,{className:A.segmentsChartPanelWrapper,children:[m().isEmpty(E)?null:(0,J.jsxs)(U.A,{display:"flex",justifyContent:"center",className:A.segmentsChartPanelCenterWrap,children:[(0,J.jsx)(ce.tA,{disabled:I,onClick:e=>_(i-1),children:(0,J.jsx)(D.A,{})}),(0,J.jsxs)(U.A,{className:A.cordinateWrap,children:[(0,J.jsxs)(U.A,{children:[null===E||void 0===E?void 0:E.start.toLocaleString()," -"," ",null===E||void 0===E?void 0:E.end.toLocaleString()]}),(0,J.jsx)(U.A,{children:k})]}),(0,J.jsx)(ce.tA,{disabled:N,onClick:e=>_(i+1),children:(0,J.jsx)(Oe.A,{})})]}),m().isEmpty(s)?m().isEmpty(n)?(0,J.jsx)(U.A,{className:A.segmentsAlterWrapper,children:(0,J.jsx)(j.A,{severity:"info",children:S("capture-chart-panel.alert-info-creating-label")})}):(0,J.jsx)(U.A,{className:A.labelWrapper,children:(0,J.jsx)(z.A,{className:A.labelSelector,id:"select_query",fullWidth:!0,labelId:"select_query_label",name:n.id,variant:"outlined",label:"",addBtnText:S("capture-chart-panel.btn-add-label"),onClickAdd:u,defaultValue:(null===n||void 0===n?void 0:n.labelValueUUID)||o,isObserveDefaultValue:!0,options:d.map((e=>({name:(0,J.jsx)(T.A,{name:null===e||void 0===e?void 0:e.name,color:null===e||void 0===e?void 0:e.color}),value:null===e||void 0===e?void 0:e.uuid}))),onChange:(e,t)=>{const{color:a,name:l,uuid:n}=d.find((e=>e.uuid===t))||{};p({id:e,name:l,color:a,uuid:n,labelValueUUID:t})},isUpdateWithDefault:!1,disabled:a})}):null!==s&&void 0!==s&&s.start?(0,J.jsx)(U.A,{className:A.labelWrapper,children:(0,J.jsx)(z.A,{className:A.labelSelector,id:"select_label",fullWidth:!0,name:s.id,label:"Selected label",variant:"outlined",addBtnText:S("capture-chart-panel.btn-add-label"),onClickAdd:u,defaultValue:(null===s||void 0===s?void 0:s.labelValueUUID)||o,isObserveDefaultValue:!0,options:d.map((e=>({name:(0,J.jsx)(T.A,{name:null===e||void 0===e?void 0:e.name,color:null===e||void 0===e?void 0:e.color}),value:null===e||void 0===e?void 0:e.uuid}))),onChange:(e,t)=>{const{color:a,name:l,uuid:n}=d.find((e=>e.uuid===t))||{};g({name:l,color:a,uuid:n,labelValueUUID:t})},isUpdateWithDefault:!0,disabled:a},s.id)}):(0,J.jsx)(U.A,{className:A.segmentsAlterWrapper,children:(0,J.jsx)(j.A,{severity:"info",children:S("capture-chart-panel.alert-info-editing-label")})}),(0,J.jsx)(U.A,{className:A.labelingPanelActionWrapper,children:m().isEmpty(s)?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(ce.bw,{variant:"outlined",color:"primary",size:"large",disabled:t||a,onClick:()=>{x()},isShort:L,tooltip:S("capture-chart-panel.btn-create-label-tooltip"),text:S("capture-chart-panel.btn-create-label"),icon:(0,J.jsx)(Pe.A,{})}),(0,J.jsx)(ce.bw,{variant:"outlined",color:"primary",size:"large",disabled:m().isEmpty(n)||t||a,onClick:()=>{b(n.id)},isShort:L,tooltip:S("capture-chart-panel.btn-delete-label-tooltip"),text:S("capture-chart-panel.btn-delete-label"),icon:(0,J.jsx)(W.A,{})}),(0,J.jsx)(ce.bw,{variant:"outlined",color:"primary",size:"large",disabled:!l||a,onClick:()=>{v()},isShort:L,tooltip:S("capture-chart-panel.btn-discard-tooltip"),text:S("capture-chart-panel.btn-discard"),icon:(0,J.jsx)(Re.A,{})}),(0,J.jsx)(ce.bw,{variant:"contained",color:"primary",size:"large",disabled:!l||a,onClick:h,isShort:L,tooltip:S("capture-chart-panel.btn-save-tooltip"),text:S("capture-chart-panel.btn-save"),icon:(0,J.jsx)(Be.A,{})})]}):(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(q.A,{variant:"outlined",color:"primary",onClick:()=>{f()},children:S("capture-chart-panel.btn-create-cancel")})})})]})})};qe.defaultProps={onChangeEditedLabel:()=>{}};const Fe=qe;var Te=a(45330);const ze=e=>{let{isDisabledByAutoSession:t,isReadOnlyMode:a,selectCapture:l,selectCaptureMetadataParams:n,selectDefaultCaptureLabels:i,captureLabels:s,sensorList:o,labels:d,selectedLabelUUID:c,selectedSessionUUID:u,selectedSession:p,selectLabelValues:b,getCaptureLabelsRequestData:h,isLoadingSensorData:v,isLoadingLabel:x,isShowSessionSelector:f=!0,loadCapture:A,loadCaptureLabels:W,clearCaptureLabels:V,createCaptureLabels:B,createSession:R,createLabelValue:O,updateCaptureLabels:P,deleteCaptureLabels:q,setHasUnsavedChanges:F,setSelectedLabel:z,updateCapturesStatisticsSegments:G}=e;const H=Ve(),$=(0,S.useHistory)(),[Y]=(0,Me.NN)(),{onOpenSelectSessionDialog:Z}=(0,y.useContext)(Te.P),X=(0,S.useLocation)(),{projectUUID:K,captureUUID:Q}=(0,S.useParams)(),{t:ae}=(0,C.B)("data-manager"),[le,ne]=(0,y.useState)(!1),[ie,re]=(0,y.useState)(!1),[se,oe]=(0,y.useState)(""),[de,ue]=(0,y.useState)(0),[pe,me]=(0,y.useState)({}),[be,he]=(0,y.useState)({}),[ve,ge]=(0,y.useState)([]),[xe,fe]=(0,y.useState)([]),[Ae,ye]=(0,y.useState)({}),[je,Ce]=(0,y.useState)({}),[Se,Le]=(0,y.useState)([]),[we,Be]=(0,y.useState)(""),[Re,Oe]=(0,y.useState)(""),[Pe,qe]=(0,y.useState)(!1),[ze,Ge]=(0,y.useState)(!1),[He,$e]=(0,y.useState)(),[Ye,Ze]=(0,y.useState)(),Xe=(0,y.useMemo)((()=>m().isEmpty(ve)?[]:ve.filter((e=>!xe.includes(e.id))).map(((e,t)=>be[e.id]?{...e,sequence:t+1,...be[e.id]}:e))),[ve,be,xe]),Je=(0,y.useMemo)((()=>Xe.sort(((e,t)=>e.start-t.start)).map(((e,t)=>({...e,sequence:t+1})))),[Xe]),Ke=(0,y.useMemo)((()=>ze||v||x),[ze,v,x]),Qe=(0,y.useMemo)((()=>{const e=1e5;if(!m().isEmpty(Se)){const t=Se[0].length/e>1?Math.round(Se[0].length/e):1;return{data:Se.map((e=>m().filter(e,((e,a)=>a%t===0))))}}return{data:[[]],names:[]}}),[Se]),et=(0,y.useMemo)((()=>{const e=!m().isEmpty(be)||!m().isEmpty(xe);return F(e),e}),[be,xe]),tt=(0,y.useMemo)((()=>m().isArray(ve)?Je.findIndex((e=>e.id===Ae.id)):-1),[Ae,Je]),at=(0,y.useMemo)((()=>d.map((e=>({...e,isSelected:e.uuid===c})))),[d,c]),lt=(0,y.useMemo)((()=>d.find((e=>e.uuid===c))||{}),[d,c]),nt=(0,y.useMemo)((()=>(null===d||void 0===d?void 0:d.length)>1),[d]),it=(0,y.useMemo)((()=>b(c)),[c]),rt=(0,y.useCallback)((()=>it.map((e=>m().toLower(e.name)))),[it]),st=(e,t,a,l)=>!(-1!==Xe.findIndex((n=>n.id!==e&&n.color===t&&n.start===a&&n.end===l)))||(Be(ae("capture-screen.error-label-dublicates")),!1),ot=()=>{fe([]),ye({}),Ce({}),he({}),ge(i(u,c))},dt=()=>{$.push({pathname:(0,S.generatePath)(Ne.bw.MAIN.DATA_MANAGER.child.CAPTURES_SCREEN.path,{projectUUID:K})})};(0,Me.G4)((e=>{ne(e.innerWidth<1280)}));const ct=e=>{let{id:t,name:a,color:l,labelValueUUID:n,start:i,end:r}=e;Oe(n);let s=be[t];m().isEmpty(s)&&(s=ve.find((e=>e.id===t)));const o=m().isUndefined(i)?s.start:i,d=m().isUndefined(r)?s.end:r,c=st(t,l,o,d),u=c?o:s.start+10,p=c?d:s.end;m().isEmpty(Ae)||(null===Ae||void 0===Ae?void 0:Ae.id)!==t||ye({...Ae,color:l,labelValueUUID:n,start:u,end:p}),he((e=>{const i={...e};return i[t]={...s,name:a,color:l,labelValueUUID:n,...!m().isUndefined(u)&&{start:u},...!m().isUndefined(p)&&{end:p}},i}))},ut=e=>{ge((t=>{const a=[...t];return a.push(e),a})),he((t=>{const a={...t};return a[e.id]={...e},a})),Ce({}),ye(e)},pt=()=>{re(!1)},mt=()=>{qe(!1)};return(0,y.useEffect)((()=>{u||R(K)}),[]),(0,y.useEffect)((()=>{(async()=>{var e;const t=l(Q),[a,n]=await A(K,Q,null===t||void 0===t?void 0:t.name),i=(null===(e=a[0])||void 0===e?void 0:e.length)||(null===a||void 0===a?void 0:a.length)||1;var s;(Le(a),me({max_sequence:i-1,...t}),n)&&($e(n.toDataURI()),Ze((null===n||void 0===n||null===(s=n.fmt)||void 0===s?void 0:s.sampleRate)||16e3));const o=await W(K,Q);r.A.logInfo("","open_capture",{total_samples:(null===o||void 0===o?void 0:o.length)||0,extension:(0,g.dU)(null===t||void 0===t?void 0:t.name),project_uuid:K,capture_uuid:Q})})()}),[]),(0,y.useEffect)((()=>{var e;m().isEmpty(it)||Re&&it.find((e=>e.uuid===Re))||Oe(null===(e=it[0])||void 0===e?void 0:e.uuid)}),[it]),(0,y.useEffect)((()=>{const e=Y.get("label");e&&e!==c&&(z(e),mt()),ot()}),[X]),(0,y.useEffect)((()=>{m().isEmpty(Ae)&&ge(i(u,c))}),[s,c,u]),(0,y.useEffect)((()=>()=>V()),[]),(0,y.useEffect)((()=>()=>Le([])),[]),(0,J.jsxs)(U.A,{children:[(0,J.jsx)(U.A,{mb:2,children:(0,J.jsx)(te.A,{title:ae("capture-screen.panel-title",{captureName:pe.name}),onClickBack:le?null:dt,turncateLenght:35,leftColumns:4,rightColumns:8,actionsBtns:(0,J.jsxs)(J.Fragment,{children:[f?(0,J.jsx)(ce.bw,{variant:"outlined",color:"primary",disabled:!1,onClick:()=>{Z()},isShort:le,tooltip:"Change the session",text:ae("capture-screen.panel-btn-session"),icon:(0,J.jsx)(w.A,{})}):null,nt?(0,J.jsx)(ce.bw,{variant:"outlined",color:"primary",disabled:!1,onClick:()=>{qe(!0)},isShort:le,tooltip:"Change the label group",text:ae("capture-screen.panel-btn-label"),icon:(0,J.jsx)(L.A,{})}):null,(0,J.jsx)(ce.bw,{variant:"outlined",color:"primary",disabled:!1,onClick:()=>(()=>{const e=l(Q);A(K,Q,null===e||void 0===e?void 0:e.name,!0)})(),isShort:le,tooltip:ae("capture-screen.panel-btn-download"),text:ae("capture-screen.panel-btn-download"),icon:(0,J.jsx)(E.A,{})}),(0,J.jsx)(ce.bw,{variant:"outlined",color:"primary",disabled:!1,onClick:()=>dt(),isShort:le,tooltip:ae("capture-screen.panel-btn-change"),text:ae("capture-screen.panel-btn-change"),icon:(0,J.jsx)(D.A,{})})]})})}),(0,J.jsxs)(U.A,{mb:1,children:[(0,J.jsx)(I.A,{elevation:0,children:(0,J.jsx)(U.A,{className:H.chartInformationWrapper,children:(0,J.jsxs)(U.A,{className:H.chartInformation,children:[nt?(0,J.jsxs)(N.A,{variant:"subtitle1",children:[(0,J.jsx)("span",{className:H.chartInformationHeader,color:"primary",children:"".concat(ae("capture-screen.label-goup"),":")}),"".concat(null===lt||void 0===lt?void 0:lt.name)]}):null,(0,J.jsxs)(N.A,{variant:"subtitle1",children:[(0,J.jsx)("span",{className:H.chartInformationHeader,color:"primary",children:"".concat(ae("capture-screen.session"),":")}),null===p||void 0===p?void 0:p.name]})]})})}),(0,J.jsx)(U.A,{mt:1,className:H.chartInformationAlertWholeLine,children:t?(0,J.jsx)(j.A,{severity:"info",children:ae("capture-screen.alert-auto-session")}):null})]}),(0,J.jsx)(U.A,{mb:2,children:(0,J.jsxs)(I.A,{elevation:0,style:{position:"relative",padding:"1em",display:"block"},children:[(0,J.jsx)(Fe,{isDisabledByAutoSession:t,isReadOnlyMode:a,isHasChanges:et,lastLabelValueUUID:Re,editedLabel:Ae,editingLabelIndex:tt,labelsCount:null===Je||void 0===Je?void 0:Je.length,newLabel:je,labeValueOptions:it,onOpenCreateLabelDialog:()=>{re(!0)},onSetEditedLabel:e=>{const t=Je[e];(null===Ae||void 0===Ae?void 0:Ae.id)!==(null===t||void 0===t?void 0:t.id)&&ye(t)},onChangeEditedLabel:ct,onDeleteEditedLabel:e=>{ye({}),fe([...xe,e])},onSaveChanges:async()=>{Ge(!0);const[e,t,a]=h(Q,c,be,xe);try{m().isEmpty(e)||(await P(K,u,e),he({})),m().isEmpty(a)||(await q(K,u,a),fe([])),m().isEmpty(t)||(await B(K,u,t),Ce({})),ot();const l=await W(K,Q);G(Q,null===l||void 0===l?void 0:l.length)}catch(l){Be(l.message)}Ge(!1)},onDiscardChanges:ot,onChangeNewLabel:e=>{let{name:t,color:a,labelValueUUID:l}=e;Oe(l);const n={...je,name:t,color:a,labelValueUUID:l};t&&a&&l&&ut(n)},onCreateLabel:()=>{Ce({id:m().uniqueId(),isCreated:!0}),ye({})},onDiscardNewLabel:()=>{Ce({})},onSaveNewLabel:ut}),m().isEmpty(Qe.data)?null:(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(Ee,{classes:H,audioFile:He,audioFileSampleRate:Ye,data:Qe.data,seriesNameList:o,segmentData:Xe,newSegment:je,editingSegment:Ae,strokeWidth:4,onSementMove:(e,t,a)=>{let l=be[a];m().isEmpty(l)&&(l=ve.find((e=>e.id===a)));const n=st(a,l.color,e,t);l.start=n?e:e+10,l.end=t,ye(l),he((e=>{const t={...e};return t[a]={...l},t}))},onNewSegmentMove:(e,t)=>{Ce((a=>({...a,start:e,end:t})))},onSetEditedSegment:e=>{const t=ve.find((t=>t.id===e));(null===Ae||void 0===Ae?void 0:Ae.id)!==e&&ye(t)},isReadOnlyMode:t})}),(0,J.jsx)(k.A,{in:Ke,children:(0,J.jsx)(U.A,{className:H.loadingBox,height:700,children:(0,J.jsx)(ke._S,{isOpen:Ke})})})]})}),(0,J.jsxs)(U.A,{children:[(0,J.jsx)(I.A,{elevation:0,children:(0,J.jsx)(U.A,{mb:2,children:(0,J.jsxs)(_.A,{id:"captureDetailsLabelMetadataTabs",value:de,onChange:(e,t)=>{ue(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",children:[(0,J.jsx)(M.A,{label:"Segments"}),(0,J.jsx)(M.A,{label:"Metadata"})]})})}),(0,J.jsx)(Ue.A,{p:0,value:de,index:0,children:m().isEmpty(Xe)?null:(0,J.jsx)(ee,{selectedCapture:pe,labels:{data:Je,isFetching:Ke},editingSegment:Ae,labeValueOptions:it,onChangeEditedLabel:ct,onDeleteLabels:e=>{ye({}),fe([...xe,...e])},onRowSelection:(e,t)=>ye({...t}),isDisabledByAutoSession:t,isReadOnlyMode:a},null===Xe||void 0===Xe?void 0:Xe.length)}),(0,J.jsx)(Ue.A,{p:0,value:de,index:1,children:(0,J.jsx)(U.A,{className:H.captureMetadataWrapper,children:(0,J.jsx)(Ie.A,{parameters:n(Q)})})})]}),(0,J.jsx)(_e.O,{isOpen:Boolean(we),onClose:e=>Be(""),message:we,variant:"error",autoHideDuration:5e3}),(0,J.jsx)(De.A,{title:ae("dialog-select-label.title"),isOpen:Pe,data:at,columns:[{title:ae("dialog-select-label.header-name"),field:"name"},{title:ae("dialog-select-label.header-labels"),render:e=>e.label_values.map((e=>(0,J.jsx)(T.A,{name:(null===e||void 0===e?void 0:e.value)||"",color:(0,g.AE)(null===e||void 0===e?void 0:e.color)||""})))}],onClose:mt,onSelect:e=>{return t=e.uuid,Y.set("label",t),void $.replace({search:Y.toString()});var t}}),ie?(0,J.jsx)(We.$,{isOpen:ie,title:ae("capture-chart-panel.dialog-create-label-title"),getLabelNamesToCheck:rt,onClose:pt,onSubmit:async(e,t)=>{oe("");try{const a=await await O(K,c,{value:e,color:t});pt(),ct({id:Ae.id,name:e,color:t,labelValueUUID:a})}catch(a){oe(a.message)}},validationError:se,defaultLabelGroup:c}):null]})},Ge={loadCapture:n.Pr,loadCaptureLabels:(e,t)=>async a=>{let l=[];try{a({type:o.J});const{data:n}=await i.Ay.get("/project/".concat(e,"/capture/").concat(t,"/label-relationship/"));l=n,a({type:o.U,payload:n})}catch(n){r.A.logError("","".concat(s.A.getResponseErrorDetails(n)," \n--project:").concat(e),n,"loadCapturesLabel"),(0,i.M3)(n,"capture labels loading")}return l},clearCaptureLabels:()=>async e=>{e({type:o.U,payload:[]})},createCaptureLabels:(e,t,a)=>async l=>{try{const{data:n}=await i.Ay.post("/v2/project/".concat(e,"/segmenter/").concat(t,"/label-relationship/"),a);l({type:o.U,payload:n})}catch(n){r.A.logError("","".concat(s.A.getResponseErrorDetails(n)," \n--project:").concat(e),n,"loadCapturesLabel"),(0,i.M3)(n,"capture labels updating")}},createSession:c.jw,createLabelValue:u.QM,updateCaptureLabels:(e,t,a)=>async l=>{try{const{data:n}=await i.Ay.put("/v2/project/".concat(e,"/segmenter/").concat(t,"/label-relationship/"),a);l({type:o.U,payload:n})}catch(n){r.A.logError("","".concat(s.A.getResponseErrorDetails(n)," \n--project:").concat(e),n,"loadCapturesLabel"),(0,i.M3)(n,"capture labels updating")}},deleteCaptureLabels:(e,t,a)=>async t=>{try{const{data:l}=await i.Ay.post("/v2/project/".concat(e,"/label-relationship/delete/"),a);t({type:o.U,payload:l})}catch(l){r.A.logError("","".concat(s.A.getResponseErrorDetails(l)," \n--project:").concat(e),l,"loadCapturesLabel"),(0,i.M3)(l,"capture labels deleting")}},setHasUnsavedChanges:d.OL,setSelectedLabel:u.S6,updateCapturesStatisticsSegments:n.SV},He=(0,l.Ng)((e=>{var t,a,l,n,i;return{selectCapture:t=>(0,v.dm)(t)(e),selectCaptureMetadataParams:t=>(0,b.Bz)(t)(e),sensorData:(0,v.$S)(e),selectDefaultCaptureLabels:(t,a)=>(e=>(t,a)=>{var l;if(!m().isEmpty(null===(l=e.captureLabels)||void 0===l?void 0:l.data)){var n,i,r;const l=t||m().toString(null===(n=(0,x.Wn)(e))||void 0===n?void 0:n.id),s=a||(null===(i=(0,f.g5)(e))||void 0===i?void 0:i.uuid),o=null===(r=e.labels)||void 0===r?void 0:r.data.reduce(((e,t)=>(m().isEmpty(null===t||void 0===t?void 0:t.label_values)||t.label_values.forEach(((t,a)=>{m().isEmpty(t)||(e[t.uuid]={...t,labelValueIndex:a})})),e)),{});return e.captureLabels.data.filter((e=>m().toString(e.segmenter)===l&&e.label===s)).sort(((e,t)=>e.capture_sample_sequence_start-t.capture_sample_sequence_end)).map(((e,t)=>{var a;const l=o[e.label_value];return{start:e.capture_sample_sequence_start,end:e.capture_sample_sequence_end,color:(0,g.AE)(l.color)||(0,A.Vy)(l.labelValueIndex),name:(null===(a=o[e.label_value])||void 0===a?void 0:a.value)||"",labelValueUUID:e.label_value,sequence:m().add(t,1),id:(null===e||void 0===e?void 0:e.uuid)||m().uniqueId()}}))}return[]})(e)(t,a),captureLabels:(null===(t=e.captureLabels)||void 0===t?void 0:t.data)||[],sensorList:e.sources.data||[],selectedSessionUUID:(0,x.ju)(e),selectedLabelUUID:(0,f.V7)(e),labels:e.labels.data||[],selectLabelValues:t=>(0,f.VR)(t)(e)||[],isLoadingSensorData:(null===e||void 0===e||null===(a=e.captures)||void 0===a||null===(l=a.captureSensorData)||void 0===l?void 0:l.isFetching)||!1,isLoadingLabel:(null===e||void 0===e||null===(n=e.captures)||void 0===n||null===(i=n.captureLabels)||void 0===i?void 0:i.isFetching)||!1,getCaptureLabelsRequestData:(t,a,l,n)=>h(t,a,l,n)(e)}}),Ge)(ze)}}]);
//# sourceMappingURL=12.ee76bc72.chunk.js.map