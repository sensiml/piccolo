"use strict";(self.webpackChunksensiml_web=self.webpackChunksensiml_web||[]).push([[464],{58256:(e,t,a)=>{a.d(t,{A:()=>s});const s=a(75882).A},92464:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ie});var s=a(97508),i=a(7996),n=a(41104),r=a(340);const l=e=>{if(!e)return 0;let t=0,a=0;return Object.keys(e).map((s=>{Object.keys(e[s]).map((i=>{"GroundTruth_Total"!==i&&(t+=e[s][i]),(s===i||"UNK"===i&&"unknown"===s.toLowerCase())&&(a+=e[s][i])}))})),0!==t?(a/t*100).toFixed(2):null},o=(e,t,a)=>"".concat(e,"-").concat(t,"-").concat(a);var c=a(34455),u=a(65043),d=a(53536),m=a.n(d),p=a(96446),f=a(68903),h=a(63336),x=a(67254),g=a(40490),y=a(53193),b=a(79190),v=a(72221),S=a(32143),A=a(10611),j=a(1995),C=a(58256),_=a(90537),R=a(34109),w=a(26581),N=a(49167),k=a(24176),E=a(19280),T=a(54469),z=a(85865),O=a(77739),F=a(17392),I=a(11906),P=a(5259),M=a(52437),D=a(6011),H=a(34294),L=a(7478);const U=()=>(0,L.A)((()=>({container:{},contextMenu:{zIndex:101},mr1:{marginRight:"0.5rem"}})))();var V=a(67395),B=a(5180),G=a(50044),W=a(95622),q=a(86328),$=a(30922),K=a(2050),J=a(39336),X=a(70579);function Y(e){let{closeAction:t,menuActions:a,openMenu:s,anchor:i}=e;const n=U(),[r,l]=(0,u.useState)(s),[o,c]=(0,u.useState)(i);(0,u.useEffect)((()=>{l(s)}),[s]);const d=e=>{o.current&&o.current.contains(e.target)||(l(!1),t(e))},m=e=>{"Tab"===e.key&&(e.preventDefault(),l(!1))},p=u.useRef(r);u.useEffect((()=>{!0===p.current&&!1===r&&o&&o.current&&o.current.focus(),p.current=r}),[r]),u.useEffect((()=>{c(i)}),[i]);const f=e=>{a&&a.selectAllInTable(e),d(e)},x=e=>{a&&a.unSelectAllInTable(e),d(e)};return(0,X.jsx)(W.A,{open:r,anchorEl:()=>o||null,role:void 0,transition:!0,disablePortal:!0,className:n.contextMenu,children:e=>{let{TransitionProps:t,placement:a}=e;return(0,X.jsx)(q.A,{...t,style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:(0,X.jsx)(h.A,{children:(0,X.jsx)(G.x,{onClickAway:d,children:(0,X.jsxs)($.A,{autoFocusItem:r,id:"menu-list-grow",onKeyDown:m,children:[(0,X.jsxs)(S.A,{onClick:f,children:[(0,X.jsx)(K.A,{children:(0,X.jsx)(V.A,{fontSize:"small",color:"primary"})}),(0,X.jsx)(z.A,{variant:"inherit",children:"Select All"})]}),(0,X.jsx)(J.A,{}),(0,X.jsxs)(S.A,{onClick:x,children:[(0,X.jsx)(K.A,{children:(0,X.jsx)(B.A,{fontSize:"small",color:"primary"})}),(0,X.jsx)(z.A,{variant:"inherit",children:"Unselect All"})]})]})})})})}})}const Q={width:55,height:55,margin:{t:0,b:0,l:0,r:0},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)"},Z={domain:{x:[0,1],y:[0,1]},value:0,type:"indicator",mode:"gauge+number",gauge:{borderwidth:.2,axis:{visible:!1,range:[0,100]}}},ee="uuid",te="captureSelected",ae="captureHasBeenRun",se="accuracy",ie="pipelineId",ne="modelId",re={total_events:"Segments",file_size_mb:"Size(MB)"},le=e=>{let{capturesStatistics:t,reRender:a,headerText:s,metadata:i,onRowSelectionAction:r,onRowsSelectionAction:l,showResultsAction:o,recognizingSignal:c,onRefresh:d,getResultFromcache:p,isInTestModel:f,selectedPipeline:h,selectedModel:x,activeSession:g,handleClassifierRun:y,handleComputeSummary:b,handleStopClassierRun:v,classiferIsRunning:S}=e;const A=U(),[j,C]=(0,u.useState)([]),[L,V]=(0,u.useState)(!1),[B,G]=(0,u.useState)(null),[W,q]=(0,u.useState)([]),[$,K]=(0,u.useState)(!1),[J,le]=(0,u.useState)([]),[oe,ce]=(0,u.useState)(g),ue=e=>{e&&C(e.map((e=>e.uuid)))},de=e=>{if(W&&W.data){const t=W.data.find((t=>t[ee]===e));t&&(t[te]=1===t[te]?0:1)}},me=e=>(0,X.jsx)(z.A,{variant:"button",children:e.title.toUpperCase()}),pe=(e,t)=>xe(t[te],t[ee]),fe=(e,t)=>he(t[ae],t[ie],t[ne],t[ee]),he=(e,t,a,s)=>1===e?(0,X.jsx)(O.A,{title:"Click here to show results",children:(0,X.jsx)(I.A,{size:"small",id:"show_capture_results",variant:"contained",color:"primary",startIcon:(0,X.jsx)(N.A,{}),onClick:e=>{o(t,a,s)},children:"Results"})}):null,xe=(e,t)=>1===e?(0,X.jsx)(O.A,{title:t?"Capture Is Selected":"Captures Selected",children:(0,X.jsx)(F.A,{variant:"contained",color:"primary",size:"small",children:(0,X.jsx)(w.A,{color:"primary",captureuuid:t})})}):(0,X.jsx)(O.A,{title:t?"Click to Select Capture":"Captures Not Selected",children:(0,X.jsx)(F.A,{variant:"contained",color:"primary",size:"small",children:(0,X.jsx)(R.A,{color:"disabled",captureuuid:t})})}),ge=(e,t)=>{q((a=>{const s=a.data.map((e=>({...e,[te]:t&&j.includes(e.uuid)?1:0})));return l(e,s),{isFetching:!1,data:s}}))},ye={unSelectAllInTable:function(e){ge(e,!1)},selectAllInTable:function(e){ge(e,!0)}};(0,u.useEffect)((()=>{be()}),[a]);const be=()=>{if(f&&W&&W.data){const e=W;e.data.forEach((e=>{const t=p(e[ee]);e[ie]=h,e[ne]=x,e[ae]=t?1:0,e[se]=t?t.accuracy[oe]:null})),q(e)}},ve=(e,t)=>{if(!t[ae])return null;const a={...Z,value:t[se]||"NA"};let s="rgb(0,0,0)",i="Capture does'nt have Ground Truth. Accuracy could not be computed";return t[se]&&(s=parseInt(t[se],10)>=80?"rgb(75,152,26)":"rgb(230,70,70)",i="".concat(t[se]," %")),a.gauge={...a.gauge,bar:{color:s,thickness:1}},(0,X.jsx)(O.A,{title:i,children:(0,X.jsx)("div",{children:(0,X.jsx)(_.A,{data:[a],layout:Q,useResizeHandler:!0,config:{displayModeBar:!1,responsive:!0}})})})};(0,u.useEffect)((()=>{const e=J;ce(g);const a=function(t){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];0===e.filter((e=>e.field===t.field)).length&&(a?e.unshift(t):e.push(t))};let s=[];const r=[ae,se,te];if(t&&t.data&&t.data.length>0){s=t.data;["name","uuid","total_events","file_size_mb","created","capture_uuid","capture_configuration_uuid",...m().keys(s[0])].forEach((function(e){if(!["Id",ie,ne].includes(e)){if(!0===f&&e===ee)return void a({title:"Accuracy",field:se,sortable:!0,type:M.$.Numeric,filterable:!0,filterHasIcons:!0,renderLabel:me,render:ve});if(!r.includes(e)){const t={title:re[e]||e,field:e,primary:"name"===e,sortable:!0,type:n.A.isNumber(s[0][e])||"file_size_mb"===e?M.$.Numeric:M.$.Text,filterable:!0,renderLabel:me},r=((e,t)=>{let a=null;if(!e)return a;const s=e.find((e=>e.name===t));return s&&!0===s.is_dropdown&&s.label_values&&(a={},s.label_values.forEach((e=>a[e.value]=e.value))),a})(i,e);r&&(t.lookup=r),a(t)}!0===f&&"file_size_mb"===e&&a({title:"Results",field:ae,sortable:!0,type:M.$.Numeric,filterable:!0,filterHasIcons:!0,lookup:{0:"",1:(t=1,1===t?(0,X.jsx)(O.A,{title:"Cached Capture Classifications",children:(0,X.jsx)(F.A,{variant:"contained",color:"primary",size:"small",children:(0,X.jsx)(N.A,{color:"primary",size:"small"})})}):null)},renderLabel:me,render:fe})}var t}))}!0===f&&a({title:" ",field:te,sortable:!0,type:M.$.Numeric,filterable:!0,filterHasIcons:!0,lookup:{0:"Unselected",1:"Selected"},renderLabel:me,render:pe},!0),f&&m().isArray(s)&&s.forEach((e=>{const t=p(e[ee]);e[ie]=h,e[ne]=x,e[te]=0,e[ae]=t?1:0,e[se]=t?t.accuracy[g]:0})),q({data:s,isFetching:t.isFetching}),ue(s),le(e)}),[t,g,i]),(0,u.useEffect)((()=>{K(f)}),[f]),(0,u.useEffect)((()=>{be()}),[x,h]);const Se=s||"",Ae={rowsPerPage:10,showPagination:!0,noContentText:"No ".concat(s||"Capture Files"),excludePrimaryFromDetails:!0,onRowSelection:(e,t)=>{if(!0===$){if("show_capture_results"===e.target.id||void 0!==e.target.parentNode&&"show_capture_results"===e.target.parentNode.id)return;if(!0===c())return;de(t.uuid),r(e,t)}},rowsPerPageOptions:[5,10,25,50,100,"All"],applyFilters:!0,getCustomRowProps:f?(e,t,a)=>e[ae]?e[se]?e[se]>=80?a.tableRowGreen:a.tableRowRed:a.tableRowGrey:"":null,contextMenuAction:f?e=>{V(!0),G(e.currentTarget)}:null,captureTableData:ue,isDarkHeader:!0};return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(D.f,{title:Se,onRefresh:d,ActionComponent:(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(H.U,{variant:"outlined",color:"primary",className:A.mr1,disabled:S,onClick:()=>y(),tooltip:"Test the model against the File Data using Emulation",text:"Recognize",icon:(0,X.jsx)(T.A,{})}),(0,X.jsx)(H.U,{variant:"outlined",color:"primary",className:A.mr1,disabled:S,onClick:()=>b(),tooltip:"Summarize the Results across all selected Files",text:"Summarize",icon:(0,X.jsx)(k.A,{})}),(0,X.jsx)(H.U,{variant:"outlined",color:"primary",disabled:!1,onClick:()=>v,tooltip:"Stop The Currently Executing Test",text:"Stop",icon:(0,X.jsx)(E.A,{}),className:A.mr1})]})}),(0,X.jsx)(P.A,{tableId:"projectStatisticsTable",tableColumns:J,tableData:W,tableOptions:Ae}),(0,X.jsx)(Y,{closeAction:e=>{V(!1)},openMenu:L,menuActions:ye,anchor:B})]})},oe=(0,s.Ng)(((e,t)=>({capturesStatistics:e.captures.capturesStatistics||{},headerText:t.headerText,metadata:e.metadata.data,onRowSelectionAction:t.onRowSelectionAction})),null)(le);var ce=a(80923),ue=a(81131);const de=()=>(0,L.A)((e=>({root:{flexGrow:1},mainHeader:{paddingLeft:10},box:{minWidth:245,minHeight:400},grid:{},sessionWrapper:{padding:"".concat(e.spacing(2)),marginTop:e.spacing(2),marginBottom:e.spacing(2)},fileTypes:{marginTop:-20},actionButton:{marginTop:10},actionStopButton:{marginTop:10,marginLeft:30},progressbar:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},classificationChart:{width:"100%"},classifierResults:{paddingTop:10},classifierResultsTabGrid:{maxWidth:"100%"},classifierResultsTabPanel:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper}})))();var me=a(92314),pe=a(20991),fe=a(24056),he=a(29765),xe=a(60137),ge=a(62911),ye=a.n(ge);const be=["#1f77b4","#2ca02c","#9467bd","#8c564b","#d62728","#7f7f7f","#bcbd22","#ff7f0e","#17becf","#e377c2"],ve="classificationChart",Se=(e,t)=>{let{classificationData:a,classMap:s,activeSession:i,modelName:n,captureFileName:r}=e;const l="Unknown",o="Roboto, Helvetica, Arial, sans-serif",[c,d]=(0,u.useState)(null),[h,x]=(0,u.useState)({shapes:[]}),[g,y]=(0,u.useState)(null);(0,u.useImperativeHandle)(t,(()=>({handleHeatMapHover(e){try{const t=a.results[e.points[0].x],i=s.indexOf(t.ClassificationName),n=g[i].x.indexOf(t.SegmentStart),r={curveNumber:i,pointNumber:n,pointIndex:n};ye().Fx.hover(ve,[r])}catch(t){}}})));const b={autosize:!0,title:"<b>Classification Chart - ".concat(n," - ").concat(r,"</b>"),titlefont:{family:o,size:20},hoverdistance:5,xaxis:{tickformat:",d",showline:!0,zeroline:!1,title:"Time (Samples)",titlefont:{family:o,size:20},fixedrange:!0},yaxis:{title:"Classification",showline:!0,zeroline:!1,automargin:!0,titlefont:{family:o,size:20},fixedrange:!0,categoryorder:"array",categoryarray:[...s,l].reverse(),range:[0,s.length+1]},shapes:[],yaxis2:{fixedrange:!0,overlaying:"y",side:"right",showgrid:!1,visible:!1,range:[0,2]},yaxis3:{fixedrange:!0,overlaying:"y",side:"right",showgrid:!1,visible:!1,range:[0,1]}};(0,u.useEffect)((()=>{const e=(e,t)=>({x:[null],y:[e],mode:"markers",xaxis:"x",name:e,yaxis:"y2",hovertemplate:"Labeled : ".concat(e,"<extra></extra>"),showlegend:!1,marker:{opacity:[.005],color:t}}),t={},n=[],r={x:[],y:[],mode:"markers",marker:{symbol:"x",color:"#e64646",size:10},showlegend:!0,xaxis:"x",name:"Mismatch",yaxis:"y3",hoverinfo:"none"};if(a&&a.results){const o={},c={},u=a.ground_truth.filter((e=>e.Session===i));[...s,l].forEach(((a,s)=>{var i,n;t[a]||(t[a]=be[s]),o[a]=(i=a,n=t[a],{x:[null],y:[i],type:"scatter",hovertemplate:"Predicted : ".concat(i,"<extra></extra>"),name:i,mode:"lines",line:{color:n}}),c[a]=e(a,t[a])})),a.results.forEach((e=>{o[e.ClassificationName].x.push(e.SegmentStart,e.SegmentEnd,null),o[e.ClassificationName].y.push(e.ClassificationName,e.ClassificationName,e.ClassificationName),u.length>0&&!u.some((t=>m().inRange((e.SegmentStart+e.SegmentEnd)/2,t.SegmentStart,t.SegmentEnd)&&e.ClassificationName===t.Label_Value))&&(r.x.push((e.SegmentStart+e.SegmentEnd)/2),r.y.push(.97))})),u.forEach((a=>{if(!c[a.Label_Value]){const s=Object.keys(t).length+1;t[a.Label_Value]=be[s],c[a.Label_Value]=e(a.Label_Value,t[a.Label_Value])}var s,i,r;n.push((s=a.SegmentStart,i=a.SegmentEnd,r=t[a.Label_Value],{type:"rect",xref:"x",yref:"paper",x0:s,y0:0,x1:i,y1:.89,fillcolor:r,opacity:.2,line:{width:0}})),c[a.Label_Value].x.push(a.SegmentStart,a.SegmentEnd),c[a.Label_Value].y.push(.7,.7)}));const p=[...Object.values(o),...Object.values(c),r];y(Object.values(o)),x({shapes:n}),d(p)}}),[a,i]);const v=de();return(0,X.jsx)(p.A,{p:1,children:(0,X.jsx)(f.Ay,{container:!0,direction:"column",className:v.grid,spacing:0,children:(0,X.jsxs)(f.Ay,{item:!0,xs:12,children:[" ",c?(0,X.jsx)(_.A,{className:v.classificationChart,divId:ve,data:c,layout:{...b,...h},useResizeHandler:!0,config:{displayModeBar:!1,responsive:!0}}):(0,X.jsx)(z.A,{variant:"h4",children:"No Classification Data"})]})})})},Ae=(0,u.forwardRef)(Se),je=e=>{let{classificationData:t,featureSummary:a,onHover:s,modelName:i,captureFileName:n}=e;const[r,l]=(0,u.useState)(null),o="Roboto, Helvetica, Arial, sans-serif",c={autosize:!0,title:"<b>Feature Vector Heat Map - ".concat(i," - ").concat(n,"</b>"),xaxis:{title:"Segment ID",titlefont:{family:o,size:20}},yaxis:{title:"Feature",titlefont:{family:o,size:20},automargin:!0,showticklabels:!1}};(0,u.useEffect)((()=>{const e={type:"heatmap",colorscale:"YlOrRd",reversescale:!0,hovertemplate:"Segment ID: %{x} <br>Feature: %{y} <br>Value: %{z} <br><extra></extra>",y:[],z:[]};t&&(t.forEach((t=>{e.z.push(t.FeatureVector)})),e.z=m().zip.apply(m(),e.z),e.y=a.map((e=>e.Feature)),l([e]))}),[t]);const d=de();return(0,X.jsxs)(p.A,{p:1,children:[" ",r?(0,X.jsx)(_.A,{className:d.classificationChart,data:r,layout:c,useResizeHandler:!0,config:{displayModeBar:!1,responsive:!0},onHover:e=>{s(e)}}):(0,X.jsx)(z.A,{variant:"h4",children:"No Feature Vector Data"})]})},Ce=e=>{let{classifierResults:t,modelName:a,classMap:s,featureSummary:i,activeSession:n,showSummary:r,summaryConfusionMatrix:l}=e;const o=de(),c=(0,u.useRef)(),[d,p]=(0,u.useState)(0),[h,x]=(0,u.useState)(""),[g,y]=(0,u.useState)("");function b(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}return(0,u.useEffect)((()=>{p(0)}),[r]),(0,u.useEffect)((()=>{y(n)}),[n]),(0,u.useEffect)((()=>{x(a)}),[a]),(0,X.jsxs)("div",{className:o.classifierResultsTabPanel,children:[(0,X.jsx)(me.A,{position:"static",color:"default",children:(0,X.jsx)(pe.A,{value:d,onChange:(e,t)=>{p(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",children:r?(0,X.jsx)(fe.A,{label:"Summary",...b(0)}):t.map(((e,t)=>(0,X.jsx)(fe.A,{label:e.fileName,...b(t+(r?1:0))},e.captureUuid)))})}),r?(0,X.jsx)(he.A,{p:2,value:d,index:0,children:(0,X.jsx)(xe.A,{model:{isFetching:!1,data:l&&!m().isEmpty(l)?l:null},showTitle:!0})}):t.map(((e,t)=>(0,X.jsx)(he.A,{value:d,index:t+(r?1:0),children:(0,X.jsxs)(f.Ay,{container:!0,className:o.classifierResultsTabGrid,spacing:1,children:[(0,X.jsx)(f.Ay,{item:!0,xs:12,children:e.confusion_matrices[g]?(0,X.jsx)(xe.A,{model:{isFetching:!1,data:e.confusion_matrices[g]},modelName:a,fileName:"".concat(e.fileName),showTitle:!0,fea:!0}):(0,X.jsx)(z.A,{variant:"h6",children:"".concat(e.fileName," - Session ").concat(g," has no confusion matrix")})}),(0,X.jsx)(f.Ay,{item:!0,xs:12,children:(0,X.jsx)(Ae,{ref:c,classificationData:e,classMap:s,activeSession:g,modelName:h,captureFileName:e.fileName})}),(0,X.jsx)(f.Ay,{item:!0,xs:12,children:(0,X.jsx)(je,{classificationData:e.results,featureSummary:i,onHover:e=>((e,t)=>{t.current&&t.current.handleHeatMapHover(e)})(e,c),modelName:h,captureFileName:e.fileName})})]})},e.captureUuid)))]})},_e="Summary has been computed and displayed below.",Re='Accuracy Computation completed, click on the "Results" button to view the results',we="STOPPED",Ne="SUCCESS",ke="ERROR",Ee="Captures",Te="error",ze="success",Oe=e=>{let{selectedProject:t,isFetchingModelData:a,modelData:s,sessions:i,classifierCache:n,submitClassifier:r,stopClassifierRun:l,checkClassifierRunStatus:o,loadCapturesStatistics:c}=e,d=null;const _=(0,u.useRef)(),[R,w]=(0,u.useState)(!0),[N,k]=(0,u.useState)(Ee),[E,T]=(0,u.useState)(t),[z,O]=(0,u.useState)(s),[F,I]=(0,u.useState)(n),[P,M]=(0,u.useState)(!1),[D,H]=(0,u.useState)({}),[L,U]=(0,u.useState)(!1),[V,B]=(0,u.useState)(null),[G,W]=(0,u.useState)(!1),[q,$]=(0,u.useState)([]),[K,J]=(0,u.useState)(!1),[Y,Q]=(0,u.useState)(!0),[Z,ee]=(0,u.useState)("success"),[te,ae]=(0,u.useState)(""),[se,ie]=u.useState(0),[ne,re]=u.useState(""),[le,me]=u.useState(""),[pe,fe]=(0,u.useState)([]),he=()=>{null!==d&&clearInterval(d)},xe=()=>{ie((e=>{if(100===e)return 0;const t=20*Math.random();return Math.min(e+t,100)}))},ge=(e,t,a)=>"".concat(e,"-").concat(t,"-").concat(a),ye=e=>{if(Q(!1),ie(0),W(!1),U(!0),B([]),q&&0!==q.length){const t=q.filter((e=>!F[ge(null===s||void 0===s?void 0:s.sandbox_uuid,null===s||void 0===s?void 0:s.uuid,e.uuid)]));if(!t||0===t.length)return!0===e&&(Ae(),Me(ze,"")),je([],e),void Me(ze,e?_e:Re);let a=null;z&&z.knowledgepack_description&&z.knowledgepack_description.Parent&&(a=z.knowledgepack_description,delete a.Parent.source),r(E,null===s||void 0===s?void 0:s.sandbox_uuid,null===s||void 0===s?void 0:s.uuid,t,z&&z.query_summary?z.query_summary.label_column:null,a?JSON.stringify(a):null),xe(),d=setTimeout(Se,"5000")}else Me(Te,"A Capture or Data File is required to compute summary."),B([]),U(!1)},be=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_.current.offsetTop;window.scrollTo({left:0,top:e,behavior:"smooth"})},ve=(e,t,a)=>{if(M(!1),!a)return;const s=F[ge(e,t,a)];s?(B([s]),W(!0),Me(ze,"Test results for ".concat(s.fileName," are displayed below.")),be()):W(!1)},Se=()=>{o(E,null===s||void 0===s?void 0:s.sandbox_uuid,null===s||void 0===s?void 0:s.uuid,q,ne).then((e=>{if(e)if(xe(),e.status===Ne)Ae(),je([],P),Me(ze,P?_e:Re);else if(e.status===ke){let t="Classification Run Failed.";e.response&&e.response.message&&(t=e.response.message.includes("Status: Pipeline was terminated.")?"Classifier run was terminated.":e.response.message),Me(Te,t),he(),U(!1)}else U(!0),d=setTimeout(Se,"5000")}))},Ae=()=>{const e={},t=[];q.map((a=>{const i=ge(null===s||void 0===s?void 0:s.sandbox_uuid,null===s||void 0===s?void 0:s.uuid,a.uuid),n=F[i]&&ne?F[i].confusion_matrices[ne]:null;n&&(t.push(a.uuid),Object.keys(n).map((t=>{e[t]||(e[t]={}),Object.keys(n[t]).map((a=>{e[t][a]=(e[t][a]?e[t][a]:0)+n[t][a]}))})))})),H(e)},je=(e,t)=>{w((e=>!e)),ie(99),B(e),ie(100),he(),U(!1),W(t)};(0,u.useEffect)((()=>{I(n)}),[n]),(0,u.useEffect)((()=>{T(t),W(!1),B(null)}),[t]),(0,u.useEffect)((()=>{if(O(s),i&&me(i),s&&s.class_map){const t=Object.values(s.class_map);if(s.child_models)for(var e in s.child_models){let a=s.child_models[e].data.class_map;Object.keys(a).forEach((e=>{t.includes(a[e])||t.push(a[e])}))}fe(t)}s&&s.query_summary&&i&&re((i.find((e=>e.id===s.query_summary.segmenter.id))||{name:""}).name)}),[s,i]),(0,u.useEffect)((()=>{ve&&be(_.current.offsetTop)}),[G]);const Oe=e=>e.map((e=>{const t=e.uuid;return void 0===q.find((e=>e.uuid===t))?N===Ee?{uuid:t,name:e.name,type:"capture"}:{uuid:t,name:Ie(e.name),type:"featurefile"}:{}})),Fe=e=>{const t=e.filter((e=>1===e.captureSelected)),a=e.map((e=>0===e.captureSelected?e.uuid:""));let s=[...q.filter((e=>void 0!==e&&!a.includes(e.uuid))),...Oe(t)].filter((e=>void 0!==e));$(s)},Ie=e=>(e&&((e=e.trim()).endsWith(".csv")||(e="".concat(e,".csv"))),e),Pe=(e,t)=>{"clickaway"!==t&&J(!1)},Me=(e,t)=>{ee(e),ae(t),J(!0)},De=de();return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)(p.A,{className:De.box,children:[(0,X.jsx)(f.Ay,{item:!0,xs:12,children:(0,X.jsx)(ce.A,{modelData:s})}),(0,X.jsx)(h.A,{elevation:0,children:(0,X.jsxs)(f.Ay,{container:!0,className:De.sessionWrapper,spacing:2,children:[(0,X.jsx)(f.Ay,{item:!0,xs:12,md:6,children:(0,X.jsx)(x.A,{severity:"info",children:(0,X.jsx)(g.A,{children:"Evaluate your model by selecting one or more capture files for classification."})})}),(0,X.jsx)(f.Ay,{item:!0,xs:12,md:6,children:(0,X.jsx)(y.A,{fullWidth:!0,children:(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(b.A,{htmlFor:"session",children:"Session"}),(0,X.jsxs)(v.A,{label:"Sessions",name:"session",value:ne,onChange:e=>{re(e.target.value)},children:[(0,X.jsx)(S.A,{value:"",disabled:!0},""),le&&le.map((e=>(0,X.jsx)(S.A,{value:e.name,children:e.name},e.id)))]})]})})})]})}),(0,X.jsx)(f.Ay,{item:!0,xs:!0,children:(0,X.jsx)(f.Ay,{container:!0,className:De.grid,spacing:0,children:(0,X.jsxs)(f.Ay,{item:!0,xs:12,children:[(0,X.jsx)(f.Ay,{container:!0,className:De.testModelControlGrid,spacing:0,children:m().isEmpty(s)?null:(0,X.jsxs)(f.Ay,{item:!0,xs:12,children:[se?(0,X.jsx)(A.A,{className:De.progressbar,variant:"determinate",value:se}):null,"Captures"===N?(0,X.jsx)(oe,{headerText:"Captures",reRender:R,onRowSelectionAction:(e,t)=>{Fe([t])},onRowsSelectionAction:(e,t)=>{Fe(t)},showResultsAction:ve,recognizingSignal:()=>L,getResultFromcache:e=>F[ge(null===s||void 0===s?void 0:s.sandbox_uuid,null===s||void 0===s?void 0:s.uuid,e)],selectedPipeline:null===s||void 0===s?void 0:s.sandbox_uuid,selectedModel:null===s||void 0===s?void 0:s.uuid,activeSession:ne,isInTestModel:!0,onRefresh:()=>{c(t)},handleClassifierRun:()=>{M(!1),ye(!1)},handleComputeSummary:()=>{M(!0),ye(!0)},handleStopClassierRun:()=>{Q(!0),l(E,null===s||void 0===s?void 0:s.sandbox_uuid,null===s||void 0===s?void 0:s.uuid).then((e=>{e.status===we?he():e.status===ke&&(Me(Te,e.response),he(),U(!1))}))},classiferIsRunning:L}):(0,X.jsx)("div",{})]})}),(0,X.jsx)(f.Ay,{item:!0,xs:!0,children:(0,X.jsxs)(f.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignContent:"flex-start",children:[(0,X.jsx)(f.Ay,{item:!0,xs:12,children:(0,X.jsx)(j.A,{anchorOrigin:{vertical:"top",horizontal:"right"},open:K,autoHideDuration:6e3,onClose:Pe,children:(0,X.jsx)(C.A,{onClose:Pe,variant:Z,message:te})})}),(0,X.jsx)(f.Ay,{ref:_,item:!0,xs:12,className:De.classifierResults,children:G?(0,X.jsx)(Ce,{classifierResults:V,modelName:z?z.name:"",classMap:pe,featureSummary:z?z.feature_summary:[],activeSession:ne,showSummary:P,summaryConfusionMatrix:D}):null})]})})]})})})]}),(0,X.jsx)(ue.HE,{isOpen:a})]})};const Fe={submitClassifier:(e,t,a,s,l,o)=>async c=>{try{if(c({type:r.Pk,status:"SUBMITTING",response:null}),!n.A.isNullOrEmpty(e)&&!n.A.isNullOrEmpty(t)&&!n.A.isNullOrEmpty(a))try{const n=s.map((e=>{if("capture"===e.type)return e.name})),r={stop_step:!1,platform:"emulator",compare_labels:l||!1,segmenter:!0,capture:n,kb_description:o};await i.Ay.post("project/".concat(e,"/sandbox/").concat(t,"/knowledgepack/").concat(a,"/recognize_signal/"),r)}catch(u){c({type:r._I,status:"ERROR",response:u.message})}}catch(d){c({type:r._I,uuid:"Project:".concat(e,",Pipeline:").concat(t,",Model:").concat(a),status:"ERROR",response:d.message})}},stopClassifierRun:(e,t,a)=>async s=>{s({type:r.HX,uuid:a,status:"STOPPING",response:null});let l={};if(!n.A.isNullOrEmpty(e)&&!n.A.isNullOrEmpty(t)&&!n.A.isNullOrEmpty(a))try{await i.Ay.delete("project/".concat(e,"/sandbox/").concat(t,"/knowledgepack/").concat(a,"/recognize_signal/")),l={type:r.AR,uuid:a,status:"STOPPED",response:null}}catch(o){l={type:r._I,uuid:a,status:"ERROR",response:o.message}}return s(l),l},checkClassifierRunStatus:(e,t,a,s,n)=>async n=>{const{data:c}=await i.Ay.get("project/".concat(e,"/sandbox/").concat(t,"/knowledgepack/").concat(a,"/recognize_signal/"));let u={};if(c&&!c.status){const e=((e,t,a,s,i)=>{const n={};return Object.values(a).map((a=>{n[a.name]={cacheKey:o(e,t,a.uuid),accuracy:{},captureUuid:a.uuid,fileName:a.name,results:[],ground_truth:[],confusion_matrices:{},sessions:[]}})),i.confusion_matrix&&Object.keys(i.confusion_matrix).map((e=>{Object.keys(i.confusion_matrix[e]).map((t=>{n[t]&&(n[t].confusion_matrices[e]=i.confusion_matrix[e][t],n[t].accuracy[e]=l(i.confusion_matrix[e][t]),n[t].sessions.push(e))}))})),i.results&&i.results.map((e=>{n[e.Capture]&&n[e.Capture].results.push(e)})),i.ground_truth&&i.ground_truth.map((e=>{n[e.Capture]&&n[e.Capture].ground_truth.push(e)})),n})(t,a,s,0,c),i=e?e[Object.keys(e)[Object.keys(e).length-1]]:{uuid:"00000000-0000-0000-0000-000000000000",results:[]};n({type:r.pg,classifierData:e}),u={type:r.Pk,uuid:e.uuid,status:"SUCCESS",response:i}}else u=c&&"FAILURE"===c.status||"REVOKED"===c.status?{type:r._I,status:"ERROR",response:c}:{type:r.Pk,status:c.status};return n(u),u},loadCapturesStatistics:c.dA},Ie=(0,s.Ng)((function(e){var t,a;return{selectedProjectName:e.projects.selectedProject.name,selectedProject:e.projects.selectedProject.uuid,isFetchingModelData:(null===(t=e.models)||void 0===t||null===(a=t.modelData)||void 0===a?void 0:a.isFetching)||!1,modelData:e.models.modelData.data,modelList:e.models.modelList.data,sessions:e.sessions.data,captureConfigurations:e.captureConfigurations.data,classifierCache:e.classifiers.classifierCache}}),Fe)(Oe)}}]);
//# sourceMappingURL=464.9c9e49a1.chunk.js.map