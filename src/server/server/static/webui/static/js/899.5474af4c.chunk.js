/*
Copyright 2017-2024 SensiML Corporation

This file is part of SensiML™ Piccolo AI™.

SensiML Piccolo AI is free software: you can redistribute it and/or
modify it under the terms of the GNU Affero General Public License
as published by the Free Software Foundation, either version 3 of
the License, or (at your option) any later version.

SensiML Piccolo AI is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public
License along with SensiML Piccolo AI. If not, see <https://www.gnu.org/licenses/>.
*/

"use strict";(self.webpackChunksensiml_web=self.webpackChunksensiml_web||[]).push([[899],{78960:(e,t,n)=>{n.d(t,{A:()=>a});const a=n(99640).A},74544:(e,t,n)=>{n.d(t,{A:()=>d});var a=n(65043),i=n(77739),o=n(35530),r=n(69986);const l=(0,n(7478).A)((e=>({typography:{fontSize:e.spacing(2),lineHeight:1.5},tooltip:{backgroundColor:e.palette.common.white,color:"rgba(0, 0, 0, 0.87)",border:"1px solid #dadde9",maxWidth:"none",boxShadow:e.shadows[5],margin:e.spacing(1)}})));var s=n(70579);const d=function(e){let{className:t,toolTip:n}=e;const d=l(),[c,p]=a.useState(null),u=Boolean(c)?"simple-popover":void 0;return(0,s.jsx)(r.A,{children:(0,s.jsx)(i.A,{placement:"right",classes:{tooltip:d.tooltip},title:(0,s.jsxs)(s.Fragment,{children:[" ",(0,s.jsx)("span",{className:d.typography,children:(0,s.jsx)("pre",{style:{fontFamily:"inherit"},children:(()=>{const e=[];let t=0;for(;t<(null===n||void 0===n?void 0:n.length);){if((t+1)%65===0)for(;t<(null===n||void 0===n?void 0:n.length);){if(" "===n[t]){e.push("\n"),t++;break}e.push(n[t]),t++}e.push(n[t]),t++}return e.join("")})()})})]}),children:(0,s.jsx)(o.A,{fontSize:"small",className:t,"aria-describedby":u,onClick:e=>{p(e.currentTarget)}})})})}},14274:(e,t,n)=>{n.d(t,{A:()=>l});n(65043);var a=n(72437),i=n(32143),o=n(34815),r=n(70579);const l=e=>{let{archorEl:t,isOpen:n,onClose:l,onDownloadPipeline:s}=e;const{DOWNLOAD_TYPES:d}=o.cd;return(0,r.jsxs)(a.A,{id:"menu-appbar",anchorEl:t,open:n,onClose:()=>l(),MenuListProps:{"aria-labelledby":"pipeline-export-menu"},children:[(0,r.jsx)(i.A,{onClick:e=>s(d.JSON),children:"Export as JSON "}),(0,r.jsx)(i.A,{onClick:e=>s(d.PYTHON),children:"Export as Python"}),(0,r.jsx)(i.A,{onClick:e=>s(d.IPYNB),children:"Export as IPYNB"})]})}},57182:(e,t,n)=>{n.d(t,{A:()=>f});var a=n(65043),i=n(31952),o=n(11906),r=n(67254),l=n(40490),s=n(96446),d=n(7426),c=n(33206),p=n(81131),u=n(12490),m=n(7478);const x=()=>(0,m.A)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e.common,refreshBtn:{marginLeft:e.spacing(1)},actionPanel:{display:"flex",gap:e.spacing(1),marginTop:e.spacing(2)},actionButtons:{padding:"1px 0.5rem",marginLeft:e.spacing(1)},dismissButton:{color:e.palette.warning.main,borderColor:e.palette.warning.main}}}))();var h=n(70579);const f=e=>{let{title:t,isNewQuery:n,selectedQuery:m,queryCacheStatusData:f,loadQuery:g,onBuildCache:v,onDismiss:A,isButtonsPanel:b}=e;const{t:y}=(0,d.B)("queries"),j=x(),[S,C]=(0,a.useState)(""),[w,I]=(0,a.useState)(""),[N,_]=(0,a.useState)(!1),[k,E]=(0,a.useState)(!1),T=()=>{n?(C("info"),I(y("create-form.message-info")),_(!1)):f.status&&f.build_status===u.O.CACHED?(C("success"),I(f.message),_(!1)):f.status||f.build_status!==u.O.CACHED?f.build_status===u.O.BUILDING?(C("info"),I(f.message),E(!0),_(!0)):f.build_status===u.O.NOT_BUILT?(C("info"),I(f.message),_(!0)):f.build_status===u.O.FAILED&&(C("error"),I(f.message),_(!0)):(C("warning"),I(f.message),_(!0))},B=(0,a.useCallback)((()=>N),[N,f]);(0,c.$$)((async()=>{await void g(m)}),k?5e3:null),(0,a.useEffect)((()=>{T()}),[f,n,m]),(0,a.useEffect)((()=>{T()}),[]),(0,a.useEffect)((()=>{f.build_status!==u.O.BUILDING&&E(!1)}),[f]);const D=()=>{k||(v(m),E(!0))},F=()=>{k||A(m)},P=()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(o.A,{id:"build_cache_btn","data-testid":"build_cache_btn",disabled:k,color:"primary",className:j.actionButtons,size:"small",onClick:D,variant:"outlined",children:y("cache.button-cache-rebuild")}),A?(0,h.jsx)(o.A,{id:"dismiss_btn","data-testid":"dismiss_btn",disabled:k||f.build_status===u.O.FAILED,className:"".concat(j.actionButtons," ").concat(j.dismissButton),color:"accent",size:"small",onClick:F,variant:"outlined",children:y("cache.button-cache-dismiss")}):null]});return w?(0,h.jsxs)(r.A,{variant:"outlined",severity:S,icon:k?(0,h.jsx)(i.A,{color:"primary",className:j.spinnedIcon}):null,children:[t?(0,h.jsx)(l.A,{children:t}):(0,h.jsx)(h.Fragment,{}),(0,h.jsx)("span",{children:w}),B()?b?(0,h.jsx)(s.A,{mt:1,ml:-1,children:P()}):P():null]}):(0,h.jsx)(p.HE,{isOpen:!1})}},93531:(e,t,n)=>{n.d(t,{SE:()=>i,jQ:()=>o});const a={autosize:!0,autocolorscale:!0,displayModeBar:!0,displaylogo:!1,responsive:!0,modeBarButtonsToRemove:["pan2d","select2d","lasso2d","autoScale2d","toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]},i={...a},o={...a,responsive:!1}},55365:(e,t,n)=>{n.d(t,{al:()=>d,bO:()=>c});var a=n(65043),i=n(90537),o=n(76174),r=n(93531),l=n(70579);var s=n(26240);const d=e=>{let{data:t,title:n,height:d,width:c,$xaxis:p,$yaxis:u,boxmode:m}=e;const x=(0,s.A)(),[h,f]=(0,a.useState)(0),[g,v]=(0,a.useState)("1");return(0,a.useEffect)((()=>{f(h+1)}),[t]),(0,l.jsx)("div",{style:{width:"100%",position:"relative"},children:(0,l.jsx)(i.A,{data:t,revision:h,style:{width:"100%",height:"100%",opacity:g},layout:{type:"box",boxmode:m||"group",...o.kX,...d&&{height:d},...c&&{width:c},plot_bgcolor:x.plotBG,xaxis:{...o.kX.xaxis,...p},yaxis:{...o.kX.yaxis,...u},title:n},config:r.SE})})},c=e=>{let{data:t,title:n,height:s,width:d,onClick:c,$xaxis:p,$yaxis:u,$xaxis2:m,$yaxis2:x,layout:h}=e;const[f,g]=(0,a.useState)(0);return(0,a.useEffect)((()=>{g(f+1)}),[t,h,p,u]),(0,l.jsx)(i.A,{data:t,config:r.jQ,useResizeHandler:!0,style:{width:"100%",height:"100%"},onClick:e=>{g(f+1),c(e)},onHover:()=>{const e=document.getElementsByClassName("nsewdrag")[0];null!==e&&void 0!==e&&e.style&&(e.style.cursor="pointer")},layout:{...o.n,...s&&{height:s},...d&&{width:d},xaxis:{...o.n.xaxis,...p},yaxis:{...o.n.yaxis,...u},xaxis2:{...o.n.xaxis2,...m},yaxis2:{...o.n.yaxis2,...x},title:{text:n,font:{size:16,weight:"bold",fontFamily:["Open Sans","verdana","arial","sans-serif"]},xref:"paper"},...h},revision:f},"key-".concat(f))}},76174:(e,t,n)=>{n.d(t,{kX:()=>i,n:()=>o,x2:()=>r});const a={autosize:!0,margin:{l:70,r:50,b:70,t:50,pad:10},legend:{borderwidth:0,orientation:"h"},xaxis:{autorange:!0,rangemode:"tozero",showline:!1,color:"#455a64",zerolinecolor:"#eee",zerolinewidth:3,standoff:20},yaxis:{autosize:!0,rangemode:"tozero",autorange:!0,showline:!1,color:"#455a64",zerolinecolor:"#eee",zerolinewidth:3}},i={...a,margin:{l:80,r:80,b:100,t:70,pad:10},colorway:["#26c0c7","#5151d3","#e68619","#ffd215","#E65F8E","#A86BD1","#3AA5D1","#3BB58F","#3A63AD"],yaxis:{autosize:!0,anchor:"free",overlaying:"y",side:"right",position:1},legend:{...a.legend},legend2:{...a.legend}},o={...a,hovermode:"closest",mode:"markers",type:"scatter",x:[],y:[],autosize:!0,bargap:.3,barmode:"stack",xaxis:{...a.xaxis,domain:[0,.84],autorange:!1,showgrid:!0,title:{standoff:20},range:[0,255]},yaxis:{...a.xaxis,domain:[0,.84],autorange:!1,showgrid:!0,title:{standoff:20},range:[0,255]},legend:{x:1,xanchor:"right",yanchor:"top",y:1},xaxis2:{...a.xaxis,domain:[.85,1],autosize:!1,showgrid:!0,zeroline:!0},yaxis2:{...a.xaxis,domain:[.85,1],autosize:!1,showgrid:!0,zeroline:!0}},r={...a,margin:{l:50,r:150,b:200,t:50,pad:10},hovermode:"closest",mode:"markers",type:"scatter",autosize:!0,bargap:0,barmode:"stack",yaxis:{autosize:!0,anchor:"free",overlaying:"y",side:"right",position:1}}},64551:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(7478);const i=e=>(0,a.A)((t=>{var n,a;return{...t.common,toptopPanelWrapperFixed:{zIndex:t.zIndex.drawer-1,position:"fixed",width:"calc(100% - 2rem ".concat(e?"- 200px":"- 56px",")"),top:"4rem","@media (max-width: 900px)":{width:"calc(100% - 2rem ".concat(e?"- 200px":"",")")},"@media (max-width: 800px)":{width:"100%",top:"3.5rem",height:"3rem",left:0}},topPanelTopOverlap:{background:t.backgroundApp,height:"1rem",zIndex:1001},topPanelWrapper:{minWidth:t.responsive.minWidthContainer,"@media (max-width: 800px)":{margin:"auto",width:"calc(100% - 2rem)"}},topPanelBottomOverlap:{background:t.backgroundApp,width:"calc(100%)",height:"0.5rem"},createDialogTitle:{marginBottom:t.spacing(2),textAlign:"center"},createCardDescList:{paddingInlineStart:t.spacing(2),margin:0},createCardDescListItem:{marginTop:t.spacing(1),lineHeight:"1.2"},queryAlert:{width:"100%"},builderContainer:{padding:t.spacing(2)},builderFormCheckBoxWrapper:{display:"flex",justifyContent:"flex-start",alignItems:"center",columnGap:t.spacing(2)},builderFormWrapper:{padding:"0 ".concat(t.spacing(4)),display:"flex",flexDirection:"column",justifyContent:"space-around"},builderDescription:{display:"flex",alignItems:"center"},stepperWrapper:{display:"flex",alignItems:"center",padding:"1rem 2rem"},stepperBackButton:{border:"1px solid ".concat(t.palette.primary.main),position:"absolute"},stepperRoot:{width:"80%",padding:0,margin:"auto"},stepperLabel:{cursor:"pointer"},selectHeader:{fontWeight:600,fontSize:t.spacing(3),marginBottom:t.spacing(3),marginTop:t.spacing(3)},selectCard:{},selectCardGridWrapper:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px,1fr))",gap:t.spacing(2)},selectCardInfoIcon:{color:t.colorInfoLinks},headerPipeline:{color:t.colorBrandText},pipelineSettingsWrapper:{display:"flex",alignItems:"flex",justifyContent:"flex-end",width:"100%"},pipelineIcon:{display:"flex",alignItems:"center",justifyContent:"flex-start",width:"100%"},header:{marginTop:t.spacing(2),fontSize:t.spacing(4),justifyContent:"center",fontWeight:500,textAlign:"center",color:t.colorBrandText,display:"flex",alignItems:"center"},infoTitle:{marginBottom:t.spacing(4),marginTop:t.spacing(2),fontSize:t.spacing(4),fontWeight:500,textAlign:"center"},cardWrapper:{marginTop:t.spacing(2)},additionalSettingWrapper:{padding:t.spacing(2)},builderWrapper:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",margin:"auto"},cardTextWrap:{cursor:"default",display:"grid",gap:t.spacing(.5),fontWeight:400,marginLeft:t.spacing(2),"& span:first-child":{fontWeight:600,flex:"initial"},"& span:nth-child(2)":{flex:"auto",textAlign:"left"}},cardParamsWrapper:{"& span:nth-child(2)":{marginLeft:"auto"}},cardParamsWrap:{display:"flex-inline",lineHeight:"1.1","& span":{color:t.colorInfoText},"& span:first-child":{color:t.colorInfoText,fontWeight:400,marginRight:".5rem"}},stepWrapper:{display:"grid",justifyContent:"center",gridRow:"auto",gridTemplateColumns:"1fr",width:"100%",maxWidth:"550px",margin:"auto"},pipelineBuilderWrapper:{width:"100%",display:"flex",flexDirection:"column",maxWidth:"630px",margin:"auto"},cardStep:{marginBottom:"3rem"},cardStepDisabledToEdit:{opacity:"0.8",zIndex:"100",transition:t.transitions.create(["width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},IconWrapper:{height:t.spacing(5),display:"flex",justifyContent:"center",alignItems:"center"},cardInfoIcon:{cursor:"pointer",marginLeft:t.spacing(.5),display:"flex",alignItems:"center"},NewCardWrapper:{height:t.spacing(18),display:"flex",justifyContent:"center",alignItems:"center",width:"100%",maxWidth:"550px",margin:"auto"},fullWidthIcon:{position:"absolute",zIndex:0},drawerHeader:{marginBottom:t.spacing(2),marginTop:t.spacing(2),fontSize:t.spacing(3),fontWeight:600,color:null===(n=t.palette.notSelected)||void 0===n?void 0:n.main},drawerHeaderAlert:{display:"flex",alignItems:"center"},drawerHeaderAlertIcon:{marginRight:t.spacing(1)},drawerInfoText:{marginTop:t.spacing(2),marginBottom:t.spacing(2),fontSize:t.spacing(2),display:"flex",alignItems:"center",justifyContent:"space-between",color:t.colorInfoText},drawerInfoPreDescription:{margin:"-1rem",color:null===(a=t.palette.notSelected)||void 0===a?void 0:a.main},formDrawerRoot:{zIndex:t.zIndex.drawer+3},formDrawerSizing:{width:"55vw",boxSizing:"border-box","@media (min-width: 1650px)":{width:"50vw"},"@media (max-width: 900px)":{width:"95vw"}},formStepDrawerContext:{padding:t.spacing(4),paddingTop:t.spacing(8),paddingRight:t.spacing(8),paddingBottom:t.spacing(10)},drawerFormButtonWrapper:{zIndex:t.zIndex.drawer+3,boxSizing:"border-box",position:"fixed",right:0,bottom:0,display:"flex",marginTop:t.spacing(2),justifyContent:"flex-end",padding:t.spacing(2),background:t.backgroundElements,borderTop:"1px solid ".concat(t.palette.primary.main),width:"55vw","@media (min-width: 1650px)":{width:"50vw"},"@media (max-width: 900px)":{width:"95vw"}},drawerFormButton:{minWidth:t.spacing(15),textTransform:"uppercase","&:first-child":{marginRight:"1rem"}},infoDrawer:{padding:t.spacing(4),paddingTop:t.spacing(8)},drawerContent:{whiteSpace:"pre-wrap"},infoDrawerContext:{padding:t.spacing(4),paddingTop:t.spacing(8)},descriptionContainer:{margin:"".concat(t.spacing(2)," 0")},descriptionParamsWrapper:{display:"flex",flexDirection:"row"},descriptionParamsWrap:{justifyContent:"flex-start",alignItems:"center",display:"flex",flex:2,marginTop:t.spacing(1),marginBottom:t.spacing(1),"&:first-child":{fontWeight:600,flex:1,color:t.colorBrandText}},paramChipItem:{margin:t.spacing(.5)},formControl:{marginTop:t.spacing(2),marginBottom:t.spacing(2),position:"relative"},helpIcon:{cursor:"pointer",color:t.colorInfoLinks,position:"absolute",right:"-".concat(t.spacing(4)),top:"30%"},actionButton:{width:"100%",textTransform:"uppercase",fontSize:"1rem",padding:"0.75rem",transition:"all 0.1s linear"},scrollButton:{padding:0,transition:"all 0.1s linear"},customName:{fontWeight:"500"},dangerColor:{color:t.palette.error.light},chartMetricsWrapper:{marginTop:t.spacing(2),padding:"".concat(t.spacing(2)),height:t.spacing(55)},fixedOptimizeButtonWrapper:{bottom:0,zIndex:"999",width:"35rem",display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",paddingBottom:"0.5rem",paddingTop:"0.5rem",transition:"all 0.2s linear","@media (max-width: 1600px)":{width:"30rem"},"@media (max-width: 1366px)":{width:"27rem"}},dialogTable:{width:"100%"},dialogTableRow:{"& h6":{display:"table-cell"}},groupBox:{borderLeft:"5px solid rgb(4 118 190 / 66%)",borderRight:"5px solid rgb(4 118 190 / 66%)",borderBottom:"5px solid rgb(4 118 190 / 66%)",margin:"auto",maxWidth:"580px",padding:"1rem",borderRadius:"5px",paddingBottom:"0",position:"relative",marginTop:"1rem","&::before":{content:"''",width:"30%",height:"5px",left:"0",top:"0",position:"absolute",zIndex:"9",background:"rgb(4 118 190 / 66%)"},"&::after":{content:"''",width:"30%",height:"5px",right:"0",top:"0",position:"absolute",zIndex:"9",background:"rgb(4 118 190 / 66%)"}},groupHeader:{display:"flex",justifyContent:"center",marginBottom:"1rem",fontSize:"1.25rem",color:"#0277be",fontWeight:600,position:"relative",marginTop:"-1.75rem"}}}))()},53899:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_n});var a=n(97508),i=n(7996),o=n(67500),r=n(41104),l=n(61689),s=n(30182);const d=()=>async e=>{const t=e=>null!==e&&void 0!==e&&e.length?e.filter((e=>e.Subtype)).map((e=>e.Subtype)):[];try{const{data:n}=await i.Ay.get("automl/pipeline-hierarchy-rules/");e({type:s.B,payload:n.map((e=>(e=>{return{name:e.Name,customName:null,nextSteps:e["Next Step"],mandatory:e.Mandatory,type:(n=e.TransformFilter,null!==n&&void 0!==n&&n.length?n[0].Type:""),subtype:t(e.TransformFilter),transformFilter:e.TransformFilter||[],transformList:e.TransformList||[],excludeTransform:e.Exclude||[],limit:e.Limit||null,set:e.Set,id:(0,l.LP)()};var n})(e)))})}catch(n){o.A.logError("","".concat(r.A.getResponseErrorDetails(n)),n,"loadPipelinesHierarchyRules")}};var c=n(35026),p=n(28704),u=n(27802),m=n(41917),x=n(4574);const h=e=>x.Yp[e]||{};var f=n(97127),g=n(12826),v=n(50719),A=n(53536),b=n.n(A),y=n(65043),j=n(88986),S=n(91688),C=n(7426),w=n(96446),I=n(68903),N=n(56258),_=n(63336),k=n(20991),E=n(24056),T=n(1995),B=n(67254),D=n(73695),F=n(69120),P=n(19280),L=n(97840),R=n(40430),W=n(1577),z=n(14274),O=n(75882),M=n(37919),H=n(7478),U=n(70579);const Y=e=>{let{...t}=e;const n=(0,H.A)((e=>({...e.common,root:{background:e.backgroundConsole,padding:e.spacing(1),paddingBottom:0,minHeight:e.spacing(2)},indicator:{display:"none",borderBottom:"none",backgroundColor:"transparent"}})))();return(0,U.jsx)(k.A,{classes:{root:n.root,indicator:n.indicator},TabIndicatorProps:{children:(0,U.jsx)("span",{className:n.indicator})},...t})},q=(0,y.forwardRef)(((e,t)=>{const n=(0,H.A)((e=>({...e.common,root:{textTransform:"none",color:"white",minWidth:e.spacing(20),minHeight:e.spacing(2),fontWeight:e.typography.fontWeightLight,borderTopRightRadius:"5px",borderTopLeftRadius:"5px",position:"relative",display:"inline-flex",alignItems:"center",flexDirection:"row",justifyContent:"flex-start","&:hover":{opacity:1},"&:selected":{background:"#2d2d2d",fontWeight:e.typography.fontWeightRegular},"&:focus":{color:""}},selected:{background:"#2d2d2d"}})))();return(0,U.jsx)(E.A,{disableRipple:!0,classes:{root:n.root,selected:n.selected},...e,ref:t})}));var Q=n(34535);const G=(0,Q.Ay)(w.A)((e=>{let{theme:t}=e;return{background:"#2d2d2d",padding:t.spacing(1),resize:"vertical",position:"relative"}})),V=e=>(0,U.jsx)(G,{...e}),$=e=>{let{viewTabs:t,children:n,onChangeTab:a}=e;const[i,o]=(0,y.useState)(0);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Y,{value:i,onChange:(e,t)=>{o(t),a(t)},scrollButtons:"auto","aria-label":"scrollable auto tabs example",children:(null===t||void 0===t?void 0:t.length)&&t.map(((e,t)=>(0,U.jsx)(q,{label:e,icon:(0,U.jsx)(M.A,{style:{marginRight:"0.5rem",marginBottom:0},fontSize:"small"})},"console_tab_".concat(t))))}),(0,U.jsx)(V,{children:n})]})};var J=n(35721),K=n(71322),X=n(2050),Z=n(34815);const ee=()=>(0,H.A)((e=>({...e.common,consoleInfoFlex:{flex:3,display:"flex",alignItems:"center",justifyContent:"flex-start",color:e.colorInfoText},consoleActionFlex:{display:"flex",alignItems:"center",justifyContent:"flex-end",flex:1},consoleBody:{boxShadow:"none",border:"none",whiteSpace:"pre",overflow:"visible",lineHeight:1,fontFamily:"Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New, monospace"},consoleIcon:{minWidth:e.spacing(1),marginRight:e.spacing(1)},statusMessages:{color:e.colorConsoleBody,height:"30rem",overflowY:"auto",position:"relative","&::-webkit-scrollbar":{width:e.spacing(.5),cursor:"pointer"},"&::-webkit-scrollbar-track":{boxShadow:"none",webkitBoxShadow:"none",backgroundColor:e.colorConsoleScrollTrackBg},"&::-webkit-scrollbar-thumb":{backgroundColor:e.colorConsoleScrollBg}},statusMessage:{padding:0,marginBottom:e.spacing(2)},notNessesaryText:{color:e.colorConsoleInfoText},preConsoleNoMargin:{margin:0,lineHeight:1},preConsole:{fontSize:"0.85rem",margin:0,lineHeight:1,whiteSpace:"pre-wrap"}})))();var te=n(53253),ne=n(72584),ae=n(37948),ie=n(31487),oe=n(26240);const re=e=>{const t=(0,oe.A)();switch(e){case Z.f.DEBUG:return(0,U.jsx)(ie.A,{style:{color:t.colorConsoleBody},fontSize:"small"});case Z.f.INFO:return(0,U.jsx)(ne.A,{style:{color:t.colorConsoleInfoIcon},fontSize:"small"});case Z.f.SUCCESS:return(0,U.jsx)(te.A,{style:{color:t.colorConsoleSuccessIcon},fontSize:"small"});case Z.f.WARNING:return(0,U.jsx)(ae.A,{style:{color:t.colorConsoleWarningIcon},fontSize:"small"});case Z.f.ERROR:return(0,U.jsx)(ae.A,{style:{color:t.colorConsoleErrorIcon},fontSize:"small"});default:return(0,U.jsx)(U.Fragment,{})}},le=e=>{let{logs:t}=e;const n=ee(),a=(0,y.useRef)(null);return(0,y.useEffect)((()=>{const e=a.current.scrollHeight-a.current.clientHeight;a.current.scrollTo(0,e)}),[t]),(0,U.jsx)(J.A,{className:n.statusMessages,component:"nav","aria-label":"secondary mailbox folder",ref:a,children:null!==t&&void 0!==t&&t.length?t.map(((e,t)=>(0,U.jsxs)(K.Ay,{className:n.statusMessage,children:[(0,U.jsx)(X.A,{className:n.consoleIcon,children:re(e.status)}),(0,U.jsx)("pre",{className:"".concat(n.preConsole," ").concat(e.status<=Z.f.INFO&&n.notNessesaryText),children:e.message})]},"log_".concat(t)))):(0,U.jsx)(U.Fragment,{})})};n(23571);var se=n(81637);const de=e=>{let{status:t}=e;const n=(0,oe.A)();switch(t){case Z.$Q.RUNNING:return(0,U.jsx)(se.A,{style:{color:n.colorConsoleInfoIcon},size:"1rem"});case Z.$Q.KILLING:return(0,U.jsx)(se.A,{style:{color:n.colorConsoleWarningIcon},size:"1rem"});case Z.$Q.KILLING_ABORTED:return(0,U.jsx)(ae.A,{style:{color:n.colorConsoleWarningIcon},fontSize:"small"});case Z.$Q.KILLED:return(0,U.jsx)(te.A,{style:{color:n.colorConsoleWarningIcon},fontSize:"small"});case Z.$Q.FAILED:return(0,U.jsx)(ae.A,{style:{color:n.colorConsoleErrorIcon},fontSize:"small"});case Z.$Q.COMPLETED:return(0,U.jsx)(te.A,{style:{color:n.colorConsoleSuccessIcon},fontSize:"small"});default:return(0,U.jsx)(U.Fragment,{})}},ce=(0,Q.Ay)(w.A)((e=>{let{theme:t}=e;return{display:"flex",padding:t.spacing(1),background:"#2d2d2d",justifyContent:"flex-end",borderBottom:"1px solid #585858"}})),pe=e=>{let{consoleInfoChild:t,consoleActionChild:n}=e;const a=ee();return(0,U.jsxs)(ce,{children:[(0,U.jsx)(w.A,{className:a.consoleInfoFlex,children:t}),(0,U.jsx)(w.A,{className:a.consoleActionFlex,children:n})]})},ue=e=>{let{status:t,className:n,children:a}=e;const i=(0,oe.A)();return(0,U.jsx)("span",{className:n,style:{color:(()=>{switch(t){case Z.$Q.RUNNING:return i.colorConsoleInfoIcon;case Z.$Q.KILLING:case Z.$Q.KILLING_ABORTED:case Z.$Q.KILLED:return i.colorConsoleWarningIcon;case Z.$Q.FAILED:return i.colorConsoleErrorIcon;case Z.$Q.COMPLETED:default:return i.colorConsoleSuccessIcon}})()},children:a})};var me=n(6011),xe=n(34294),he=n(33206),fe=n(97111),ge=n(92653),ve=n(77739),Ae=n(85865),be=n(88446),ye=n(11906),je=n(88911),Se=n(74605),Ce=n(51962),we=n(85190),Ie=n(35875),Ne=n(21338),_e=n(19778),ke=n(65631),Ee=n(47030),Te=n(98424),Be=n(95004),De=n(78960),Fe=n(4172),Pe=n(55365);const Le=e=>{let{isOpen:t,onClose:n,data:a,labelColors:i={}}=e;const[o,r]=(0,y.useState)(),l=["distributionSegments","distributionFeatureVectors","distributionSamples"],s={distributionSegments:"Distribution by Segments",distributionSamples:"Distribution by Samples",distributionFeatureVectors:"Distribution by Feature Vectors"},d=(0,y.useMemo)((()=>l.reduce(((e,t)=>{const n=(i=t,b().values(a).reduce(((e,t)=>(b().entries(t[i]).forEach((t=>{let[n,a]=t;e[n]?e[n]+=a:e[n]=a})),e)),{}));var i;return b().isEmpty(n)||e.push({key:t,title:s[t],data:n}),e}),[])),[a]);return(0,he.G4)((e=>{e.innerWidth>Z.xp.WIDTH_FOR_TABLET_TEXT?r(800):r(.8*e.innerWidth)})),(0,U.jsx)(De.A,{maxWidth:"lg",isOpen:t,onClose:n,children:(0,U.jsx)(w.A,{mt:4,children:d.map((e=>(0,U.jsx)(w.A,{children:(0,U.jsx)(Pe.al,{id:e.key,title:e.title,width:o,height:400,data:[{y:b().values(e.data),x:b().keys(e.data),marker:{color:b().keys(e.data).map((e=>i[e])),opacity:.8},type:"bar"}]},e.key)})))})})};var Re=n(55578),We=n.n(Re),ze=n(12008),Oe=n(22070),Me=n(17022),He=n(53364),Ue=n(46085);const Ye=()=>(0,H.A)((e=>({cardStepWrapper:{padding:"0.25rem 0.75rem",boxSizing:"border-box",display:"inline-flex",zIndex:1,minHeight:"5.5rem",transition:e.transitions.create(["width","visibility","show"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:"100%"},cardDisable:{opacity:"0.6",pointerEvents:"none",cursor:"no-drop",zIndex:"100",width:"90%",margin:"auto",transition:e.transitions.create(["width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},customStepWrapper:{boxSizing:"border-box",display:"flex",justifyContent:"center",zIndex:1,transition:e.transitions.create(["width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},arrDisable:{opacity:"0.6",pointerEvents:"none",cursor:"no-drop",zIndex:"100"},IconWrap:{display:"flex",alignItems:"center",justifyContent:"center"},ActionWrap:{display:"flex",justifyContent:"flex-end",alignItems:"center"},ActionIcon:{cursor:"pointer",marginTop:e.spacing(.5)},cardStepRegular:{borderPosition:""},cardStepRegularNew:{borderPosition:"",border:"1px dashed ".concat(e.colorNewItems)},cardStepIcon:{fontSize:"2rem"},cardStepActionIcon:{fontSize:"1.5rem",borderRadius:"100%"},TextWrap:{width:"100%",alignItems:"center",display:"flex",padding:"0.75rem 0"},"@media (min-width: 1600px)":{cardStepIcon:{fontSize:"2rem"},cardStepActionIcon:{fontSize:"1.75rem"}},...e.common})))(),qe=e=>{let{className:t,dataTest:n,disable:a,icon:i,style:o,children:r,helpInfo:l,helpEdit:s,helpDelete:d,isFlashingEdit:c,onEdit:p,onDelete:u,onDownloadCache:m,onOpenCacheChart:x}=e;const{t:h}=(0,C.B)("common"),f=Ye(),g=(0,oe.A)();return(0,U.jsx)(ze.A,{in:!0,children:(0,U.jsxs)(_.A,{elevation:0,"data-test":n,className:"".concat(f.cardStepWrapper," ").concat(f.cardStepRegular," ").concat(a&&f.cardDisable," ").concat(t),style:o,children:[(0,U.jsx)(w.A,{className:f.IconWrap,children:i}),(0,U.jsx)(w.A,{className:f.TextWrap,children:r||null}),(0,U.jsxs)(w.A,{className:f.ActionWrap,children:[u?(0,U.jsx)(ve.A,{title:d||h("flow-builder.card-step-delete-info"),placement:"top",children:(0,U.jsx)(be.A,{className:f.ActionIcon,onClick:u,"data-test":"delete-link",children:(0,U.jsx)(Oe.A,{className:f.cardStepActionIcon,style:{color:g.colorDeleteIcons}})})}):null,x?(0,U.jsx)(ve.A,{title:s||h("flow-builder.card-step-open-cache"),placement:"top",children:(0,U.jsx)(be.A,{className:f.ActionIcon,onClick:x,"data-test":"edit-link",children:(0,U.jsx)(Ue.A,{className:"".concat(f.cardStepActionIcon," ").concat(c?f.flashingAction:""),style:{color:g.colorEditIcons}})})}):null,m?(0,U.jsx)(ve.A,{title:l||h("flow-builder.card-step-export-cache-info"),placement:"top",children:(0,U.jsx)(be.A,{className:f.ActionIcon,onClick:m,"data-test":"info-link",children:(0,U.jsx)(He.A,{className:f.cardStepActionIcon,style:{color:g.colorEditIcons}})})}):null,p?(0,U.jsx)(ve.A,{title:s||h("flow-builder.card-step-edit-info"),placement:"top",children:(0,U.jsx)(be.A,{className:f.ActionIcon,onClick:p,"data-test":"edit-link",children:(0,U.jsx)(Me.A,{className:"".concat(f.cardStepActionIcon," ").concat(c?f.flashingAction:""),style:{color:g.colorEditIcons}})})}):null]})]})})};var Qe=n(73170);const Ge=e=>{let{className:t,icon:n,children:a,helpInfo:i,helpEdit:o,helpDelete:r}=e;const{t:l}=(0,C.B)("common"),s=Ye(),d=(0,oe.A)();return(0,U.jsxs)(_.A,{elevation:0,className:"".concat(s.cardStepWrapper," ").concat(s.cardStepRegularNew," ").concat(t||""),style:{borderColor:d.IconWrap},children:[(0,U.jsx)(w.A,{className:s.IconWrap,children:n||(0,U.jsx)(Qe.A,{color:"primary"})}),(0,U.jsx)(w.A,{className:s.TextWrap,children:a||null}),(0,U.jsxs)(w.A,{className:s.ActionWrap,children:[(0,U.jsx)(ve.A,{title:i||l("flow-builder.card-step-help-info"),placement:"top",children:(0,U.jsx)(Ee.A,{style:{color:d.colorNewItems}})}),(0,U.jsx)(ve.A,{title:o||l("flow-builder.card-step-edit-info"),placement:"top",children:(0,U.jsx)(Me.A,{style:{color:d.colorNewItems}})}),(0,U.jsx)(ve.A,{title:r||l("flow-builder.card-step-delete-info"),placement:"top",children:(0,U.jsx)(Oe.A,{style:{color:d.colorNewItems}})})]})]})};const Ve=n.p+"static/media/flow_arrow_add.bb7e0bbfd718be19fcbc69321e833ab8.svg";const $e=n.p+"static/media/flow_no_arrow_add.680b0a33ed4b240efb9bd622d72f6953.svg",Je=e=>{let{onClick:t,info:n,disable:a,dataTest:i,isRemoveArrow:o}=e;const{t:r}=(0,C.B)("common"),l=Ye();return(0,U.jsx)(ve.A,{title:n||r("flow-builder.arrow-add-info"),placement:"right",children:(0,U.jsx)(be.A,{onClick:t,className:"".concat(l.ActionIcon," ").concat(a&&l.arrDisable),"data-test":i,children:(0,U.jsx)("img",{src:o?$e:Ve,alt:""})})})};const Ke=n.p+"static/media/flow_arrow_down.6bf6a43a105cf81e490bba2072ab8793.svg";const Xe=n.p+"static/media/flow_no_arrow_down.019ba1158073e919d084376168741adc.svg",Ze=e=>{let{disable:t,dataTest:n,isRemoveArrow:a}=e;const i=Ye();return(0,U.jsx)("a",{"data-test":n,children:(0,U.jsx)("img",{src:a?Xe:Ke,alt:"",className:"".concat(t&&i.arrDisable)})})};const et=n.p+"static/media/flow_arrow_full_width.c38fd5596103eeedf83aa3a690a15f50.svg",tt=e=>{let{className:t}=e;return(0,U.jsx)("img",{className:t,src:et,alt:""})};var nt=n(94109),at=n(53193),it=n(79190),ot=n(72221),rt=n(32143),lt=n(81673),st=n(22505),dt=n(64551);const ct=e=>{let{isOpen:t,onClose:n,onChangeStep:a,onCreate:i,getPipelineStepDescription:o,allSteps:r,availableSteps:l=[]}=e;const s=(0,dt.A)(),d=(0,oe.A)(),{t:c}=(0,C.B)("models"),[p,u]=(0,y.useState)(""),[m,x]=(0,y.useState)(""),[h,f]=(0,y.useState)(""),[g,v]=(0,y.useState)(""),[A,b]=(0,y.useState)(!1);(0,y.useEffect)((()=>{l&&u({})}),[l]),(0,y.useEffect)((()=>{p&&(b(!1),a(p))}),[p]);return(0,U.jsx)(nt.Ay,{BackdropProps:{style:{backgroundColor:d.backgroundBackDoor}},classes:{paperAnchorRight:s.formDrawerSizing},open:t,onClose:n,anchor:"right",variant:"temporary",children:(0,U.jsxs)(w.A,{"data-test":"drawer-create-step-form",className:s.formStepDrawerContext,children:[(0,U.jsx)(Ae.A,{variant:"h2",className:s.drawerHeader,children:c("model-builder.drawer-new-step-header")}),(0,U.jsx)(Ae.A,{paragraph:!0,className:s.drawerInfoText,children:c("model-builder.drawer-new-step-sub-header")}),l?(0,U.jsxs)(at.A,{required:!0,fullWidth:!0,className:s.formControl,error:A,children:[(0,U.jsx)(it.A,{htmlFor:"select_pipeline",children:c("model-builder.drawer-new-step-label-select")}),(0,U.jsx)(ot.A,{name:"select_pipeline",onChange:e=>{const{descpription:t,docLink:n}=o(e.target.value);var a;x(e.target.value),u({...(a=e.target.value,r.find((e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.trim())===a})))}),f(t),v(n)},value:m,"data-testid":"select-tranform",children:l.map(((e,t)=>(0,U.jsx)(rt.A,{"data-test":"select-tranform-option",value:e,children:e},"select_".concat(t))))}),A?(0,U.jsx)(lt.A,{children:c("model-builder.drawer-new-error-error-requaried")}):null]}):null,(0,U.jsxs)(w.A,{className:s.drawerInfoText,children:[(0,U.jsx)(Ae.A,{paragraph:!0,className:s.drawerContent,children:h}),g?(0,U.jsx)(Ae.A,{paragraph:!0,className:s.drawerContent,children:(0,U.jsx)(be.A,{href:g,title:g,target:"_blank",children:c("model-builder.drawer-step-info-doc-link")})}):null]}),(0,U.jsxs)(w.A,{className:s.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(s.drawerFormButton," ").concat(s.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:n,"data-testid":"new-step-drawer-close",children:c("model-builder.drawer-new-step-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:()=>{m?i():b(!0)},className:s.drawerFormButton,size:"large",startIcon:(0,U.jsx)(st.A,{}),variant:"contained",color:"primary","data-testid":"new-step-drawer-create",children:c("model-builder.drawer-new-step-btn-add")})]})]})})};var pt=n(4598);const ut=e=>{let{name:t,type:n,children:a,isOpen:i,onClose:o,alertMessage:r,onChangeEditMode:l,isJsonEditMode:s,jsonEditModeLabel:d,alertSeverity:c="info"}=e;const p=(0,dt.A)(),u=(0,oe.A)();return(0,U.jsx)(nt.Ay,{BackdropProps:{style:{backgroundColor:u.backgroundBackDoor}},classes:{root:p.formDrawerRoot,paperAnchorRight:p.formDrawerSizing},open:i,onClose:o,anchor:"right",variant:"temporary",children:(0,U.jsxs)(w.A,{className:p.formStepDrawerContext,children:[(0,U.jsx)(Ae.A,{variant:"h2",className:p.drawerHeader,children:t}),(0,U.jsxs)(w.A,{className:p.drawerInfoText,children:[(0,U.jsx)(w.A,{children:n}),(0,U.jsx)(Se.A,{control:(0,U.jsx)(pt.A,{checked:s,onChange:()=>{l()},color:"primary",name:"checkedB",inputProps:{"aria-label":"primary checkbox"}}),label:d})]}),r?(0,U.jsx)(B.A,{severity:c,children:r}):null,(0,U.jsx)(w.A,{"data-test":"drawer-edit-step-form",className:p.drawerContent,children:a})]})})},mt=e=>{let{isOpen:t,header:n,message:a,onClose:i,parameters:o=[]}=e;const{t:r}=(0,C.B)("models"),l=(0,dt.A)(),s=(0,oe.A)();return(0,U.jsx)(nt.Ay,{BackdropProps:{style:{backgroundColor:s.backgroundBackDoor}},classes:{paperAnchorRight:l.formDrawerSizing,root:l.formDrawerRoot},style:{zIndex:3e3},open:t,onClose:i,anchor:"right",variant:"temporary",children:(0,U.jsxs)(w.A,{className:l.formStepDrawerContext,children:[(0,U.jsxs)(Ae.A,{variant:"h2",className:"".concat(l.drawerHeader," ").concat(l.drawerHeaderAlert),children:[(0,U.jsx)(Ee.A,{classes:{root:l.drawerHeaderAlertIcon},color:"primary"}),n]}),(0,U.jsx)(Ae.A,{paragraph:!0,children:a}),o.map(((e,t)=>(0,U.jsx)(Ae.A,{paragraph:!0,color:"primary",children:e},t))),(0,U.jsx)(w.A,{className:l.drawerContent,children:(0,U.jsx)(w.A,{className:l.drawerFormButtonWrapper,children:(0,U.jsx)(ye.A,{className:"".concat(l.drawerFormButton," ").concat(l.mr2),size:"large",variant:"contained",color:"primary",onClick:i,"data-testid":"new-step-drawer-close",children:r("model-builder.alert-review-btn")})})})]})})};var xt=n(43845),ht=n(39336);const ft=e=>{let{descriptionParameters:t}=e;const n=(0,dt.A)(),a=(0,y.useCallback)((e=>b().isArray(e)?(0,U.jsx)(w.A,{children:e.map(((e,t)=>(0,U.jsx)(xt.A,{className:n.paramChipItem,label:e},"param_".concat(t))))}):b().isObject(e)?(0,y.isValidElement)(e)?e:"":e),[t]),i=(0,y.useCallback)((e=>b().isObject(e)?"":b().startCase(e)),[t]);return(0,U.jsx)(U.Fragment,{children:b().isEmpty(t)?null:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(ht.A,{}),(0,U.jsx)(w.A,{className:n.descriptionContainer,children:b().entries(t).map(((e,t)=>{let[o,r]=e;return(0,U.jsxs)(w.A,{className:n.descriptionParamsWrapper,children:[(0,U.jsx)(w.A,{className:n.descriptionParamsWrap,children:i(o)}),(0,U.jsx)(w.A,{className:n.descriptionParamsWrap,children:a(r)})]},"desc_param_".concat(t))}))}),(0,U.jsx)(ht.A,{})]})})},gt=e=>{let{name:t,type:n,content:a,descriptionParameters:i,dataParams:o,transformName:r,transformDescription:l,docLink:s,isOpen:d,onClose:c}=e;const{t:p}=(0,C.B)("models"),u=(0,dt.A)(),m=(0,oe.A)();return(0,U.jsx)(nt.Ay,{BackdropProps:{style:{backgroundColor:m.backgroundBackDoor}},classes:{paperAnchorRight:u.formDrawerSizing,root:u.formDrawerRoot},open:d,onClose:c,anchor:"right",variant:"temporary",children:(0,U.jsxs)(w.A,{className:u.infoDrawerContext,children:[(0,U.jsx)(Ae.A,{variant:"h2",className:u.drawerHeader,children:t}),(0,U.jsx)(Ae.A,{paragraph:!0,className:u.drawerInfoText,children:n}),i?(0,U.jsx)(ft,{descriptionParameters:i}):null,(0,U.jsx)(Ae.A,{paragraph:!0,className:u.drawerContent,children:a}),s?(0,U.jsx)(Ae.A,{paragraph:!0,className:u.drawerContent,children:(0,U.jsx)(be.A,{href:s,title:s,target:"_blank",children:p("model-builder.drawer-step-info-doc-link")})}):null,(0,U.jsx)(ft,{descriptionParameters:o}),(0,U.jsx)(Ae.A,{variant:"h4",className:u.drawerHeader,children:r}),(0,U.jsx)(Ae.A,{children:(0,U.jsx)("pre",{className:u.drawerInfoPreDescription,style:{fontFamily:"inherit"},children:l})})]})})};var vt=n(65970);const At=e=>{let{inputData:t,options:n,onSubmit:a,onClose:i,onChangeData:o,getQueriesDescriptionParameters:r}=e;const{t:l}=(0,C.B)("models"),s=(0,dt.A)(),[d,c]=(0,y.useState)(""),[p,u]=(0,y.useState)({}),[m,x]=(0,y.useState)({}),[h,f]=(0,y.useState)(!1),[g,v]=(0,y.useState)(!1),[A,j]=(0,y.useState)({}),S=(0,y.useCallback)((()=>r(t)),[t]),I=(0,y.useCallback)((()=>{const e=S();if(!b().isEmpty(e)){return e.find((e=>e.name===A.name))||{}}return{}}),[A]),N=e=>e.default;(0,y.useEffect)((()=>{const e=I();if(!b().isEmpty(e)&&b().isEmpty(p)&&u({...e,name:A.name}),!b().isEmpty(p)&&!b().isEmpty(e)){const t=b().isEqual(b().sortBy(null===e||void 0===e?void 0:e.columns),b().sortBy(null===p||void 0===p?void 0:p.columns)),a=b().isEqual(b().sortBy(null===e||void 0===e?void 0:e.metadata_columns),b().sortBy(null===p||void 0===p?void 0:p.metadata_columns));v(e.session===p.session),t&&a?(c(""),f(!1)):(null!==n&&void 0!==n&&n.is_should_be_reviewed||c(l("model-builder.drawer-edit-step-warning-query-disable",{name:p.name,params:"".concat(t?"":"Columns").concat(a?"":" Metadata Columns")})),f(!0))}x(e)}),[A]);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(ft,{descriptionParameters:m}),d?(0,U.jsx)(w.A,{mt:2,children:(0,U.jsx)(B.A,{severity:"warning",children:d})}):null,(null===t||void 0===t?void 0:t.length)&&t.filter((e=>!e.isFormHidden)).map(((e,n)=>(0,U.jsx)(at.A,{required:!0,fullWidth:!0,className:s.formControl,children:(0,U.jsx)(vt.A,{...e,id:"top_level_".concat(Te.Ay.filterToSnakeCase(t.type)),labelId:"top_level_label_".concat(Te.Ay.filterToSnakeCase(t.type)),formType:e.type,value:A[e.name]||N(e),defaultValue:N(e),onChange:(t,n)=>((e,t,n)=>{o(t!==n,"name"===e?{transform:t,[e]:t}:{[e]:t}),j((n=>({...n,[e]:t})))})(t,n,N(e)),name:e.name,label:e.label,options:e.options})},"".concat(e.name,"-").concat(n)))),(0,U.jsxs)(w.A,{className:s.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(s.drawerFormButton," ").concat(s.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:i,"data-testid":"edit-step-form-close",children:l("model-builder.drawer-edit-step-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:()=>{const e={};null!==t&&void 0!==t&&t.length&&t.filter((e=>e.isFormHidden)).forEach((t=>{e[t.name]=t.default}));const n=(null===t||void 0===t?void 0:t.customName)||A.name;a({customName:n,data:{...A,...e},options:{descriptionParameters:m,isChangedColumns:h,isChangedSession:g}})},className:s.drawerFormButton,size:"large",variant:"contained",color:"primary","data-testid":"edit-step-form-submit",disabled:Boolean(d),children:l("model-builder.drawer-edit-step-btn-add")})]})]})};var bt=n(30279),yt=n(74544);const jt=e=>{let{inputData:t,onClose:n,onSubmit:a,onShowInfo:i,onChangeData:o,isFormOptionsDisabled:r,editFormKeyId:l}=e;const{t:s}=(0,C.B)("models"),d=(0,dt.A)(),c=(0,oe.A)(),[p,u]=(0,y.useState)(""),[m,x]=(0,y.useState)({}),[h,f]=(0,y.useState)({}),[g,v]=(0,y.useState)({}),[A,b]=(0,y.useState)({}),[j,S]=(0,y.useState)(!1);(0,y.useEffect)((()=>{r&&null!==t&&void 0!==t&&t.default&&x(null===t||void 0===t?void 0:t.default)}),[r]),(0,y.useEffect)((()=>{h&&b({})}),[h]);const I=(e,t)=>{var n;return null!==t&&void 0!==t&&t.length?null===(n=t.find((t=>t.name===e)))||void 0===n?void 0:n.description:""},N=e=>e.default,_=function(){var e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return null===t||void 0===t||null===(e=t.fieldset)||void 0===e?void 0:e.filter((e=>e.parent===n&&!e.isFormHidden))},k=(0,y.useCallback)(((e,t,n)=>{o(t!==n||j,{[e]:t},!1,e),f((n=>({...n,[e]:t}))),S(!0)}),[j]);return(0,U.jsx)(U.Fragment,{children:(0,U.jsxs)(w.A,{children:[(0,U.jsxs)(at.A,{fullWidth:!0,className:d.formControl,error:Boolean(g[t.name]),children:[(0,U.jsx)(vt.A,{...t,id:"top_level_".concat(Te.Ay.filterToSnakeCase(t.type)),labelId:"top_level_label_".concat(Te.Ay.filterToSnakeCase(t.type)),formType:t.type,value:p,defaultValue:t.default,onChange:(e,n)=>((e,t,n)=>{const a=_(t).reduce(((e,t)=>(e[t.name]=N(t),e)),{});o(t!==n,{transform:t,...a},!0),f({}),v({}),u(t)})(0,n,t.default),name:t.name,label:t.label,options:t.options}),I(g[t.name],t.options)?(0,U.jsx)(lt.A,{children:g[t.name]}):null,p?(0,U.jsx)(w.A,{className:d.helpIcon,children:(0,U.jsx)(ve.A,{title:s("Info"),placement:"top",children:(0,U.jsx)(be.A,{onClick:()=>{return e=p,void(null!==(n=t.options)&&void 0!==n&&n.length&&i(e,I(e,n)));var e,n},children:(0,U.jsx)(Ee.A,{style:{color:c.colorInfoLinks}})})})}):null]}),m!==p&&_(p).map(((e,t)=>{return(0,U.jsx)(bt.A,{in:(n=e.isUseName,void 0===n||Boolean(h[n])),children:(0,U.jsxs)(at.A,{fullWidth:!0,className:d.formControl,error:Boolean(A[e.name]),children:[(0,U.jsx)(vt.A,{id:"2nd_el_".concat(Te.Ay.filterToSnakeCase(e.parent),"_").concat(Te.Ay.filterToSnakeCase(e.name)),labelId:"2nd_el_lbl_".concat(Te.Ay.filterToSnakeCase(e.parent),"_").concat(Te.Ay.filterToSnakeCase(e.name)),...e,defaultValue:N(e),onChange:(t,n)=>k(t,n,N(e)),name:e.name,formType:e.type,label:e.label,options:e.options}),A[e.name]?(0,U.jsx)(lt.A,{children:A[e.name]}):null,e.description?(0,U.jsx)(w.A,{className:d.helpIcon,children:(0,U.jsx)(yt.A,{toolTip:e.description})}):null]})},"".concat(p,"-").concat(e.name,"-").concat(l,"-").concat(t));var n})),m!==p?(0,U.jsxs)(w.A,{className:d.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(d.drawerFormButton," ").concat(d.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:n,"data-testid":"edit-step-form-close",children:s("model-builder.drawer-edit-step-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:()=>{if((()=>{var e;let n=!0;return void 0===p&&(v((e=>({...e,transform:s("model-builder.drawer-edit-step-err-req")}))),n=!1),null!==t&&void 0!==t&&null!==(e=t.fieldset)&&void 0!==e&&e.length&&_(p).forEach((e=>{void 0===h[e.name]&&(b((t=>({...t,[e.name]:s("model-builder.drawer-edit-step-err-req")}))),n=!1)})),n})()){var e;const n={};let i="";const o=null===(e=t.fieldset)||void 0===e?void 0:e.filter((e=>e.parent===p&&e.isFormHidden));i=(null===t||void 0===t?void 0:t.customName)||p,null!==o&&void 0!==o&&o.length&&o.forEach((e=>{n[e.name]=e.default})),a({data:{transform:p,...h,...n},customName:i})}},className:d.drawerFormButton,size:"large",variant:"contained",color:"primary","data-testid":"edit-step-form-submit",children:s("model-builder.drawer-edit-step-btn-add")})]}):null]})})};var St=n(79650),Ct=n(71806),wt=n(84882),It=n(28076),Nt=n(10039),_t=n(73460),kt=n(17392),Et=n(92348);const Tt=()=>(0,H.A)((e=>{var t;return{...e.common,formSubtypeWrapper:{display:"grid",gridTemplateColumns:"50% 50%"},addButtonWrapper:{display:"flex",marginTop:e.spacing(2),marginBottom:e.spacing(2),gap:e.spacing(1)},drawerFormButtonWrapper:{zIndex:e.zIndex.drawer+3,boxSizing:"border-box",position:"fixed",right:0,bottom:0,display:"flex",marginTop:e.spacing(2),justifyContent:"flex-end",padding:e.spacing(2),background:e.backgroundElements,borderTop:"1px solid ".concat(e.palette.primary.main),width:"55vw","@media (min-width: 1650px)":{width:"50vw"},"@media (max-width: 900px)":{width:"95vw"}},drawerFormButton:{minWidth:e.spacing(15),textTransform:"uppercase",marginRight:"1rem"},formCreateWrapper:{display:"flex",flexDirection:"column"},formCreateFormControl:{marginBottom:e.spacing(1),marginTop:e.spacing(1)},subtypesWrapper:{display:"flex",flexDirection:"column"},subtypesWrap:{},wrapperCheckHeader:{display:"flex",alignItems:"center",justifyContent:"flex-start"},featureFormSubtypeHeaderClicked:{cursor:"pointer","&:hover":{color:e.palette.primary.main,fontWeight:600}},wrapperCheckFeatureHeader:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"".concat(e.spacing(1)," 0")},featureFormSubtypeHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:e.spacing(1)},featureFormSubtypeHeaderTitle:{fontSize:e.spacing(2.25),fontWeight:600,color:null===(t=e.palette.notSelected)||void 0===t?void 0:t.main},columnsRow:{display:"flex",alignItems:"center",justifyContent:"flex-end",flexFlow:"wrap",gap:"0.25rem",padding:"0.5rem"},borderedFormWrapper:{border:"1px solid #0277be73",borderRadius:"5px"},collapseFormWrapper:{width:"100%",borderBottom:"1px solid transparent"},formWrapper:{padding:"0 1rem"},formDefaultWrapper:{marginBottom:e.spacing(2)},formControl:{marginBottom:e.spacing(2),position:"relative"},collapseFormSummary:{display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},collapseFormSummaryIconsWrapper:{display:"flex",justifyContent:"flex-end"},formFeatureCreateSubtype:{fontSize:e.spacing(2),color:e.palette.primary.main}}}))(),Bt=e=>{let{transforms:t,onClose:n,onSubmit:a,isUniqueTransforms:i}=e;const{t:o}=(0,C.B)("models"),r=Tt(),[l,s]=(0,y.useState)({}),[d,c]=(0,y.useState)([]);return(0,y.useEffect)((()=>{c(t.map((e=>({...e,localId:b().uniqueId()}))))}),[]),(0,U.jsxs)(w.A,{children:[(0,U.jsx)(St.A,{children:(0,U.jsxs)(Ct.A,{className:r.table,"aria-label":"simple table",children:[(0,U.jsx)(wt.A,{children:(0,U.jsxs)(It.A,{children:[(0,U.jsx)(Nt.A,{children:"Name"}),(0,U.jsx)(Nt.A,{align:"right",children:"Subtype"}),(0,U.jsx)(Nt.A,{align:"right",children:"Dublicate"})]})}),(0,U.jsx)(_t.A,{children:d.map(((e,t)=>{var n;return(0,U.jsxs)(It.A,{children:[(0,U.jsx)(Nt.A,{component:"th",scope:"row",children:(0,U.jsx)(Se.A,{className:r.formCreateFormControl,control:(0,U.jsx)(Ce.A,{onChange:t=>{return n=e.id,a=e.localId,i=t.target.checked,void s((e=>({...e,[a]:{checked:i,id:n}})));var n,a,i},name:e.id,color:"primary",checked:(null===(n=l[e.localId])||void 0===n?void 0:n.checked)||!1}),label:e.name})}),(0,U.jsx)(Nt.A,{align:"right",children:(0,U.jsx)(Ae.A,{paragraph:!0,className:r.formFeatureCreateSubtype,children:e.subtype})}),i?null:(0,U.jsx)(Nt.A,{align:"right",children:(0,U.jsx)(kt.A,{onClick:()=>(e=>{const t={...e,localId:b().uniqueId()};c((e=>b().orderBy(e.concat(t),"name"))),s((n=>({...n,[e.localId]:{checked:!0,name:e.name,id:e.id},[t.localId]:{checked:!0,name:t.name,id:e.id}})))})(e),children:(0,U.jsx)(Et.A,{color:"primary"})})})]},"".concat(e.id,"-").concat(e.name,"-").concat(t))}))})]})}),(0,U.jsxs)(w.A,{className:r.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(r.drawerFormButton," ").concat(r.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:n,children:o("model-builder.drawer-new-step-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:()=>{a(b().values(l).filter((e=>null===e||void 0===e?void 0:e.checked)).map((e=>{let{id:t,localId:n}=e;return{id:t,localId:n}})))},className:r.drawerFormButton,size:"large",startIcon:(0,U.jsx)(st.A,{}),variant:"contained",color:"primary",children:o("model-builder.drawer-new-step-btn-add")})]})]})};var Dt=n(18963),Ft=n(39674);const Pt=e=>{let{expanded:t,name:n,isShowInfo:a,onChange:i,onEdit:o,onInfo:r,onDelete:l,onUp:s,onDown:d,children:c}=e;const{t:p}=(0,C.B)("models"),u=Tt(),m=(0,oe.A)(),[x,h]=(0,y.useState)(!1);return(0,U.jsxs)(w.A,{onChange:i,className:u.collapseFormWrapper,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[(0,U.jsxs)(w.A,{mb:2,className:u.collapseFormSummary,children:[(0,U.jsx)(w.A,{children:(0,U.jsx)(Ae.A,{variant:"subtitle1",className:"".concat(x||t?u.collapseFormHeaderHovered:null),children:n})}),(0,U.jsx)(w.A,{className:u.collapseFormSummaryIconsWrapper,children:(0,U.jsxs)(w.A,{children:[s?(0,U.jsx)(ve.A,{title:"move up",placement:"top",children:(0,U.jsx)(be.A,{className:u.actionIcon,onClick:s,children:(0,U.jsx)(Ft.A,{color:"primary"})})}):null,d?(0,U.jsx)(ve.A,{title:"move down",placement:"top",children:(0,U.jsx)(be.A,{className:u.actionIcon,onClick:d,children:(0,U.jsx)(Dt.A,{color:"primary"})})}):null,r&&a?(0,U.jsx)(ve.A,{title:p("tooltip-info"),placement:"top",children:(0,U.jsx)(be.A,{className:u.actionIcon,onClick:r,children:(0,U.jsx)(Ee.A,{style:{color:m.colorInfoLinks}})})}):null,o?(0,U.jsx)(ve.A,{title:p("tooltip-edit"),placement:"top",children:(0,U.jsx)(be.A,{className:u.actionIcon,onClick:o,children:(0,U.jsx)(Me.A,{style:{color:m.colorEditIcons}})})}):null,l?(0,U.jsx)(ve.A,{title:p("tooltip-delete"),placement:"top",children:(0,U.jsx)(be.A,{className:u.actionIcon,onClick:l,children:(0,U.jsx)(Oe.A,{style:{color:m.colorDeleteIcons}})})}):null]})})]}),(0,U.jsx)(w.A,{children:(0,U.jsx)(bt.A,{timeout:300,in:Boolean(t),children:c||null})})]})};Pt.defaultProps={expanded:!0};const Lt=Pt,Rt=e=>{let{inputData:t,onClose:n,onSubmit:a,onShowInfo:i,onChangeData:o,isUniqueTransforms:r=!1}=e;const{t:l}=(0,C.B)("models"),s=Tt(),[d,c]=(0,y.useState)(!1),[p,u]=(0,y.useState)(!1),[m,x]=(0,y.useState)({}),[h,f]=(0,y.useState)([]),g=(0,y.useMemo)((()=>b().isEmpty(null===t||void 0===t?void 0:t.featureList)?{}:t.featureList.reduce(((e,t)=>(e[t.id]=t,e)),{})),[t]),v=(0,y.useMemo)((()=>r?t.featureList.filter((e=>!h.map((e=>{let{id:t}=e;return t})).includes(e.id))):t.featureList),[t,h,r]),A=(0,y.useMemo)((()=>b().isEmpty(g)?[]:h.map((e=>({...g[e.id],localId:e.localId})))),[g,h]),j=(e,t)=>{const{name:n}=e;return m&&m[t]&&m[t][n]?m[t][n]:e.default},S=()=>{const e=[];return A.forEach((t=>{e.push({name:t.name,params:t.inputContract.reduce(((e,n)=>(e[n.name]=j(n,t.localId),e)),{})})})),e};(0,y.useEffect)((()=>{const{defaultFeatureList:e}=t||[];if(!b().isEmpty(e)){u(!1),f(e);const t=e.reduce(((e,t)=>(b().isEmpty(null===t||void 0===t?void 0:t.params)||(e[t.localId]={...t.params}),e)),{});x(t)}}),[t]),(0,y.useEffect)((()=>{o(d,S())}),[m]);const I=e=>{u(e)};return(0,U.jsxs)(w.A,{children:[!p&&null!==v&&void 0!==v&&v.length?(0,U.jsx)(w.A,{className:s.addButtonWrapper,children:(0,U.jsx)(ye.A,{startIcon:(0,U.jsx)(st.A,{}),color:"primary",onClick:e=>I(!0),children:l("model-builder.form-transform-set")})}):null,p?(0,U.jsx)(Bt,{transforms:v,onClose:e=>I(!1),onSubmit:e=>{f((t=>b().concat(t,e))),u(!1)},onShowInfo:i,isUniqueTransforms:r}):null,p?null:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(w.A,{className:s.subtypesWrapper,children:A.map(((e,t)=>(0,U.jsx)(w.A,{mb:1,p:2,className:s.borderedFormWrapper,children:(0,U.jsx)(Lt,{name:e.name,subtype:e.subtype,expanded:!0,isShowInfo:Boolean(e.description),onInfo:t=>{return n=e.name,void((a=e.description)&&i(n,a));var n,a},onDelete:()=>{return t=e.localId,void f((e=>e.filter((e=>e.localId!==t))));var t},children:(0,U.jsx)(w.A,{className:s.formWrapper,children:e.inputContract.filter((e=>!e.isFormHidden)).map((t=>(0,U.jsx)(at.A,{fullWidth:!0,className:s.formControl,children:(0,U.jsx)(vt.A,{id:"input_cntr_".concat(t.id),labelId:"input_cntr_lbl".concat(Te.Ay.filterToSnakeCase(t.parent),"_").concat(Te.Ay.filterToSnakeCase(t.name)),defaultValue:j(t,e.localId),name:t.name,formType:t.type,label:t.label,options:t.options,onChange:(t,n)=>((e,t,n)=>{let a=!1;const i={...m};i[e]&&i[e][t]?i[e][t]!==n&&(i[e][t]=n,a=!0):i[e]?(i[e][t]=n,a=!0):(i[e]={[t]:n},a=!0),a&&(c(!0),x(i))})(e.localId,t,n),...t})},"input_cntr_fc_".concat(t.name).concat(e.id))))})},"feature_transform_form_".concat(t))},"".concat(e.name,"-").concat(t))))}),(0,U.jsxs)(w.A,{className:s.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(s.drawerFormButton," ").concat(s.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:n,"data-testid":"edit-step-form-close",children:l("model-builder.drawer-edit-step-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:()=>{const e=S();a({data:e,customName:b().join(e.map((e=>e.name)),", ")})},className:s.drawerFormButton,size:"large",variant:"contained",color:"primary","data-testid":"edit-step-form-submit",children:l("model-builder.drawer-edit-step-btn-add")})]})]})]})};var Wt=n(78185),zt=n(61236),Ot=n(71339),Mt=n(14675),Ht=n(38474),Ut=n(89479),Yt=n(5766);const qt=e=>{let{featureList:t,getInputContractParameters:n,onShowInfo:a,onSelectFeature:i,onDeleteFeature:o,onChangeFeatureParams:r,isShowColumns:l=!1}=e;const s=Tt(),{t:d}=(0,C.B)("common"),[c,p]=(0,y.useState)([]),u=e=>c.includes(e.name)||c.includes(e.localId),m=e=>{c.includes(e)?p((t=>t.filter((t=>t!==e)))):p((t=>[...t,e]))},x=(0,y.useCallback)((e=>n(e.inputContract.find((e=>"columns"===e.name)),e.localId)||[]),[t]);return(0,U.jsx)(U.Fragment,{children:(null===t||void 0===t?void 0:t.length)&&t.map(((e,t)=>(0,U.jsxs)(w.A,{ml:8,mb:1,pl:2,pr:2,className:s.borderedFormWrapper,children:[(0,U.jsxs)(w.A,{className:s.collapseFormSummary,children:[(0,U.jsxs)(w.A,{className:s.wrapperCheckFeatureHeader,children:[i?(0,U.jsx)(Ce.A,{checked:e.isSelected,onChange:()=>i(e.name)}):null,(0,U.jsxs)(Ae.A,{variant:"subtitle1",className:"".concat(s.featureFormSubtypeHeaderClicked),onClick:()=>m(e.localId||e.name),children:[e.name," "]})]}),(0,U.jsxs)(w.A,{className:s.collapseFormSummaryIconsWrapper,children:[u(e)?null:(0,U.jsx)(w.A,{className:s.columnsRow,children:x(e).map(((t,n)=>n<7?(0,U.jsx)(xt.A,{label:t,size:"small"},"".concat(e.localId,"-").concat(t)):7===n?"...":null))}),(0,U.jsxs)(je.A,{direction:"row",alignItems:"flex-start",children:[(0,U.jsx)(ve.A,{title:u(e)?d("tooltip-close"):d("tooltip-open"),placement:"top",children:(0,U.jsx)(kt.A,{size:"small",onClick:()=>m(e.localId||e.name),children:(0,U.jsx)(Me.A,{classes:{root:s.editIcon}})})}),(0,U.jsx)(ve.A,{title:d("tooltip-info"),placement:"top",children:(0,U.jsx)(kt.A,{size:"small",onClick:()=>{return t=e.name,void((n=e.description)&&a(t,n));var t,n},children:(0,U.jsx)(Ee.A,{classes:{root:s.infoIcon}})})}),o?(0,U.jsx)(ve.A,{title:d("tooltip-delete"),placement:"top",children:(0,U.jsx)(kt.A,{size:"small",onClick:()=>{return t=e.localId,n=e.subtype,void o(t,n);var t,n},children:(0,U.jsx)(Oe.A,{classes:{root:s.deleteIcon}})})}):null]})]})]}),u(e)?(0,U.jsx)(w.A,{className:"".concat(s.formWrapper),mt:2,children:e.inputContract.map((t=>(0,U.jsx)(at.A,{fullWidth:!0,className:s.formControl,children:(0,U.jsx)(vt.A,{id:"cntr_".concat(null===t||void 0===t?void 0:t.localId),labelId:"cntr_lbl_".concat(null===t||void 0===t?void 0:t.localId),name:t.name,label:t.label,defaultValue:n(t,e.localId),formType:t.type,range:t.range,options:t.options,onChange:(a,i)=>{((e,t,n,a,i)=>{r(a||e,t,n,i)})(t.parent,a,i,e.localId,n(t,e.localId))}})},"input_cntr_fc_".concat(null===t||void 0===t?void 0:t.name,"_").concat(null===t||void 0===t?void 0:t.localId))))}):(l&&e.inputContract.find((e=>"columns"===e.name)),null)]},"".concat(e.localId,"-").concat(t))))})};qt.defaultProps={featureList:[]};const Qt=qt,Gt=e=>{var t;let{inputData:n,onShowInfo:a,onClose:i,onAdd:o,queryColumns:r=[]}=e;const{t:l}=(0,C.B)("models"),s=Tt(),[d,c]=(0,y.useState)([]),[p,u]=(0,y.useState)({}),[m,x]=(0,y.useState)([]),[h,f]=(0,y.useState)([]),[g,v]=(0,y.useState)([]),A=e=>n.featureList.filter((t=>t.subtype===e)).map((e=>({...e,isSelected:h.includes(e.name)}))),j=(0,y.useCallback)((e=>p&&p[e.parent]?p[e.parent][e.name]:"columns"===e.name?g:e.default),[g,p]),S=e=>{d.includes(e)?c((t=>b().filter(t,(t=>t!==e)))):c((t=>[...t,e]))},I=e=>{h.includes(e)?f(h.filter((t=>t!==e))):f([...h,e])},N=(e,t,n)=>{u((a=>{const i={...a};if(i[e]&&i[e][t])i[e][t]=n;else if(i[e]){const a={...i[e]};i[e]={...a,[t]:n}}else i[e]={[t]:n};return i}))};return(0,y.useEffect)((()=>{v(r)}),[]),(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(w.A,{className:s.subtypesWrapper,children:[(0,U.jsx)(w.A,{className:s.subtypesWrap,mb:2,children:(0,U.jsx)(Yt.A,{name:"queryColumns",id:"queryColumnsId",label:"Default Columns",options:r.map((e=>({name:e,value:e}))),defaultValue:r,onChange:(e,t)=>{v(t),u((e=>{b().keys(e).forEach((e=>{N(e,"columns",t)}))}))}})}),null!==n&&void 0!==n&&null!==(t=n.subtypes)&&void 0!==t&&t.length?n.subtypes.map(((e,t)=>(0,U.jsxs)(w.A,{className:s.subtypesWrap,children:[(0,U.jsxs)(w.A,{className:s.featureFormSubtypeHeader,children:[(0,U.jsxs)(w.A,{className:s.wrapperCheckHeader,children:[(0,U.jsx)(Ce.A,{checked:b().includes(m,e),onChange:()=>(async e=>{const t=n.featureList.filter((t=>t.subtype===e)).map((e=>e.name));m.includes(e)?(x(m.filter((t=>t!==e))),f((e=>e.filter((e=>!t.includes(e)))))):(x([...m,e]),f((e=>[...e,...t])))})(e)}),(0,U.jsx)(Ae.A,{variant:"subtitle1",onClick:()=>S(e),className:"".concat(s.featureFormSubtypeHeaderTitle," ").concat(s.featureFormSubtypeHeaderClicked),children:e})]}),(0,U.jsx)(w.A,{children:(0,U.jsx)(ve.A,{title:d.includes(e)?l("tooltip-close"):l("tooltip-open"),placement:"top",children:(0,U.jsx)(kt.A,{onClick:()=>S(e),type:"outline",children:d.includes(e)?(0,U.jsx)(Ut.A,{color:"primary"}):(0,U.jsx)(Ht.A,{color:"primary"})})})})]}),d.includes(e)?(0,U.jsx)(Qt,{onShowInfo:a,subtype:e,featureList:A(e),getInputContractParameters:j,onSelectFeature:I,onChangeFeatureParams:N}):null]},"feature_".concat(t)))):(0,U.jsx)(U.Fragment,{})]}),(0,U.jsxs)(w.A,{className:s.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(s.drawerFormButton," ").concat(s.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:i,children:l("model-builder.drawer-edit-step-fg-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:()=>{const e=[],t=[];n.featureList.forEach((n=>{h.includes(n.name)&&(null!==n&&void 0!==n&&n.subtype&&!t.includes(n.subtype)&&t.push(n.subtype),e.push({...n,isSelected:!0,params:n.inputContract.reduce(((e,t)=>(e[t.name]=j(t),e)),{})}))})),o(e,t)},"data-testid":"edit-step-form-submit",className:s.drawerFormButton,startIcon:(0,U.jsx)(st.A,{}),size:"large",variant:"contained",color:"primary",children:l("model-builder.drawer-edit-step-fg-btn-add")})]})]})};Gt.defaultProps={inputData:{featureList:[],subtypes:[]}};const Vt=Gt;var $t=n(42848);const Jt=e=>{let{groupedFeatures:t,selectedFeatures:n,expandedSuptypes:a,subtypes:i,onSetDefaultData:o,onDeleteFeature:r,onDeleteSubtype:l,onExpandSubtype:s,onShowInfo:d,onClose:c,onSave:p,onChangeParam:u}=e;const{t:m}=(0,C.B)("models"),x=Tt(),h=(e,t)=>b().find(n,(e=>e.localId===t)).params[e.name],f=e=>{s(e)};return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(w.A,{className:x.subtypesWrapper,children:i.map(((e,n)=>(0,U.jsxs)(w.A,{className:x.subtypesWrap,children:[(0,U.jsxs)(w.A,{className:x.featureFormSubtypeHeader,children:[(0,U.jsxs)(w.A,{className:x.wrapperCheckHeader,children:[(0,U.jsx)(ve.A,{title:a.includes(e)?m("tooltip-close"):m("tooltip-open"),placement:"top",children:(0,U.jsx)(kt.A,{onClick:()=>f(e),children:a.includes(e)?(0,U.jsx)(Ht.A,{color:"primary"}):(0,U.jsx)(Ut.A,{color:"primary"})})}),(0,U.jsx)(Ae.A,{variant:"subtitle1",onClick:()=>f(e),className:"".concat(x.featureFormSubtypeHeaderTitle," ").concat(x.featureFormSubtypeHeaderClicked),children:e})]}),(0,U.jsx)(w.A,{children:(0,U.jsx)(ve.A,{title:m("tooltip-delete"),placement:"top",children:(0,U.jsx)(kt.A,{size:"small",onClick:()=>l(e),children:(0,U.jsx)(Oe.A,{classes:{root:x.deleteIcon}})})})})]}),a.includes(e)?(0,U.jsx)(Qt,{onShowInfo:d,subtype:e,featureList:t[e]||[],getInputContractParameters:h,onChangeFeatureParams:u,onDeleteFeature:r,isShowColumns:!0}):null]},"feature_".concat(n))))}),(0,U.jsxs)(w.A,{className:x.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(x.drawerFormButton," ").concat(x.mr2),size:"large",startIcon:(0,U.jsx)($t.A,{}),color:"primary",onClick:o,variant:"outlined",children:m("model-builder.drawer-edit-step-fg-btn-discard")}),(0,U.jsx)(ye.A,{className:"".concat(x.drawerFormButton," ").concat(x.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:c,children:m("model-builder.drawer-edit-step-fg-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:p,"data-testid":"edit-step-form-submit",className:x.drawerFormButton,size:"large",variant:"contained",color:"primary",children:m("model-builder.drawer-edit-step-btn-add")})]})]})};Jt.defaultProps={selectedFeatures:[],subtypes:[]};const Kt=Jt,Xt=e=>{let{inputData:t,onClose:n,onSubmit:a,onShowInfo:i,onChangeData:o,options:r={}}=e;const l=Tt(),{t:s}=(0,C.B)("models"),[d,c]=(0,y.useState)(!1),[p,u]=(0,y.useState)(!0),[m,h]=(0,y.useState)(!1),[f,g]=(0,y.useState)(!1),[v,A]=(0,y.useState)([]),[j,S]=(0,y.useState)([]),[I,N]=(0,y.useState)([]),_=(0,y.useMemo)((()=>j.reduce(((e,t)=>(e[t.subtype]||(e[t.subtype]=[]),e[t.subtype].push(t),e)),{})),[j]),k=e=>{h(e)},E=()=>{S(null===t||void 0===t?void 0:t.defaultFeatureList),A(null===t||void 0===t?void 0:t.addedSubtypes)},T=()=>{N(t.subtypes)};return(0,y.useEffect)((()=>{setTimeout((()=>u(!1)),100),E(),b().isEmpty(null===t||void 0===t?void 0:t.defaultFeatureList)&&h(!0)}),[]),(0,y.useEffect)((()=>{if(!b().isEmpty(j)){T();const e=j.map((e=>({name:e.name,params:e.params,isSelected:e.isSelected})));o(f,e)}}),[j]),(0,he.G4)((e=>{c(e.innerWidth<1650)})),(0,U.jsxs)(w.A,{children:[(0,U.jsxs)(w.A,{className:l.addButtonWrapper,children:[m?null:(0,U.jsx)(xe.bw,{icon:(0,U.jsx)(st.A,{}),isShort:d,tooltip:s("model-builder.drawer-edit-step-fg-btn-open-adding-tooltip"),text:s("model-builder.drawer-edit-step-fg-btn-open-adding"),color:"primary",variant:"outlined",onClick:()=>k(!0)}),m?null:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(xe.bw,{icon:(0,U.jsx)(Ot.A,{}),isShort:d,tooltip:s("model-builder.drawer-edit-step-fg-btn-expand-subtypes-tooltip"),text:s("model-builder.drawer-edit-step-fg-btn-expand-subtypes"),color:"primary",variant:"outlined",onClick:T}),(0,U.jsx)(xe.bw,{icon:(0,U.jsx)(Mt.A,{}),isShort:d,tooltip:s("model-builder.drawer-edit-step-fg-btn-collapse-subtypes-tooltip"),text:s("model-builder.drawer-edit-step-fg-btn-collapse-subtypes"),color:"primary",variant:"outlined",onClick:()=>{N([])}})]})]}),m?(0,U.jsx)(Vt,{inputData:t,queryColumns:r.queryColumns,onShowInfo:i,onAdd:(e,t)=>{const n=(0,zt.A)(e),a=b().concat(j,n);g(!0),S(b().sortBy(a,["name"])),A(b().union(v,t)),k(!1)},onClose:()=>k(!1)}):p?[1,2,3,4].map((e=>(0,U.jsxs)(w.A,{children:[(0,U.jsx)(Wt.A,{width:"50%",height:"2rem"}),(0,U.jsx)(w.A,{ml:"4rem",children:(0,U.jsx)(Wt.A,{height:"5rem"})}),(0,U.jsx)(w.A,{ml:"4rem",children:(0,U.jsx)(Wt.A,{height:"5rem"})}),(0,U.jsx)(w.A,{ml:"4rem",children:(0,U.jsx)(Wt.A,{height:"5rem"})})]},"skeleton-".concat(e)))):(0,U.jsx)(Kt,{groupedFeatures:_,selectedFeatures:j,expandedSuptypes:I,subtypes:v,onExpandSubtype:e=>{I.includes(e)?N((t=>b().filter(t,(t=>t!==e)))):N((t=>[...t,e]))},onShowInfo:i,onSave:()=>{const e=j.map((e=>({name:e.name,params:e.params,isSelected:e.isSelected})));a({data:e,customName:x._Y.FEATURE_GENERATOR})},onClose:n,onChangeParam:(e,t,n,a)=>{g(n!==a),S((a=>a.map((a=>{if(a.localId===e){const e=a.params||{};return{...a,params:{...e,[t]:n}}}return a}))))},onDeleteFeature:(e,t)=>{var n;1===(null===(n=j.filter((e=>e.subtype===t)))||void 0===n?void 0:n.length)&&A(v.filter((e=>e!==t))),S(j.filter((t=>t.localId!==e)))},onDeleteSubtype:e=>{A(v.filter((t=>t!==e))),S(j.filter((t=>t.subtype!==e)))},onSetDefaultData:E})]})},Zt=e=>{let{inputData:t,type:n,onSubmit:a,onClose:i,onChangeData:o,name:r}=e;const{t:l}=(0,C.B)("models"),s=(0,dt.A)(),d=Tt(),[c,p]=(0,y.useState)({}),[u,m]=(0,y.useState)({}),h=(e,n)=>{var a,i;const o=t.find((t=>t.name===e));if(null!==o&&void 0!==o&&null!==(a=o.fieldset)&&void 0!==a&&a.length&&null!==(i=c[e])&&void 0!==i&&i.length){return null===o||void 0===o?void 0:o.fieldset.filter((t=>(c[e].includes(t.name)||c[e]===t.name)&&Boolean(t.isFormHidden)===n))}return[]},f=(0,y.useCallback)((()=>c[x.z9]||!1),[t,c]),g=(0,y.useCallback)(((e,t)=>t?Boolean(c[t])&&!f():!f()||e===x.z9),[c]);return(0,U.jsxs)(w.A,{children:[Object.values(x.iD).map(((e,n)=>(0,U.jsx)(w.A,{mb:2,children:(null===t||void 0===t?void 0:t.length)&&t.filter((t=>t.group===e)).map(((t,n)=>(0,U.jsxs)(bt.A,{in:g(t.name,t.isShowIfParamName),children:[(0,U.jsx)(Ae.A,{variant:"subtitle1",className:d.featureFormSubtypeHeaderTitle,children:e}),(0,U.jsxs)(w.A,{children:[(0,U.jsxs)(at.A,{required:!0,fullWidth:!0,className:s.formControl,children:[(0,U.jsx)(vt.A,{id:"top_level_".concat(Te.Ay.filterToSnakeCase(t.type)),labelId:"top_level_label_".concat(Te.Ay.filterToSnakeCase(t.type)),...t,formType:t.type,value:c[t.name],defaultValue:t.default,onChange:(e,n)=>{((e,t,n,a)=>{o(t!==a),p((a=>{const i={...a};return i[e]=t,n&&void 0!==i[n]&&(i[n]||t||(i[n]=!t)),i}))})(e,n,t.opposite_value,t.default)},name:t.name,label:t.label,options:t.options},"top_level_".concat(Te.Ay.filterToSnakeCase(t.type))),t.description?(0,U.jsx)(w.A,{className:s.helpIcon,children:(0,U.jsx)(yt.A,{toolTip:t.description})}):null]}),h(t.name,!1).map((e=>(0,U.jsx)(at.A,{required:!0,fullWidth:!0,className:s.formControl,children:(0,U.jsx)(vt.A,{id:"second_level_".concat(Te.Ay.filterToSnakeCase(e.name)),labelId:"second_level_label".concat(Te.Ay.filterToSnakeCase(e.name)),...e,defaultValue:e.default,onChange:(t,n)=>{((e,t,n,a)=>{o(t!==a),m((a=>{const i={...a};return a[n]?i[n][e]=t:i[n]={[e]:t},i}))})(t,n,e.parent,e.default)},name:e.name,formType:e.type,label:e.label,options:e.options},"second_level_".concat(Te.Ay.filterToSnakeCase(e.name)))},"2nd_fc_".concat(Te.Ay.filterToSnakeCase(e.parent),"_").concat(Te.Ay.filterToSnakeCase(e.name)))))]})]},"".concat(t.name,"-").concat(n))))},"group_automl_form_".concat(n)))),(0,U.jsxs)(w.A,{className:s.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(s.drawerFormButton," ").concat(s.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:i,"data-testid":"edit-step-form-close",children:l("model-builder.drawer-edit-step-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:()=>{const e=Object.entries(c).reduce(((e,t)=>{let[n,a]=t;const i=h(n,!0),o={...u,...i.reduce(((e,t)=>(e[t.parent]||(e[t.parent]={}),e[t.parent][t.name]=t.default,e)),{})};return e[n]={},o[n]?Array.isArray(a)&&null!==a&&void 0!==a&&a.length?a.forEach((t=>{e[n][t]=o[n][t]})):e[n][a]=o[n][a]:e[n]=a,e}),{});a({data:e,customName:r,type:n})},className:s.drawerFormButton,size:"large",variant:"contained",color:"primary","data-testid":"edit-step-form-submit",children:l("model-builder.drawer-edit-step-btn-add")})]})]})},en=e=>{const{type:t,name:n}=e;if(!t&&n)return(0,U.jsx)(jt,{...e});switch(t){case x._Y.QUERY:return(0,U.jsx)(At,{...e});case x._Y.TRANSFORM:case x._Y.SEGMENTER:case x._Y.SAMPLER:return(0,U.jsx)(jt,{...e});case x._Y.FEATURE_GENERATOR:return(0,U.jsx)(Xt,{...e});case x._Y.FEATURE_SELECTOR:return(0,U.jsx)(Rt,{isUniqueTransforms:!0,...e});case x._Y.AUGMENTATION:return(0,U.jsx)(Rt,{...e});case x._Y.TRAINING_ALGORITHM:case x._Y.CLASSIFIER:case x._Y.VALIDATION:return(0,U.jsx)(jt,{...e});case x._Y.AUTOML_PARAMS:return(0,U.jsx)(Zt,{...e});default:return(0,U.jsx)("div",{children:"Form is not supported"})}};var tn=n(77158),nn=n(39578);const an=e=>{let{name:t,data:n,transforms:a,onClose:i,onChangeData:o,onSubmit:r}=e;const l=(0,tn.dJ)(),s=(0,y.useRef)(null),d=(0,dt.A)(),[c,p]=(0,y.useState)({}),[u,m]=(0,y.useState)(""),{t:x}=(0,C.B)("models"),h=(0,y.useCallback)(((e,t,n)=>{const a=b().entries(e).reduce(((e,t)=>{let[n,a]=t;return["transform","input_data","isSelected"].includes(n)||(e[n]=a),e}),{});return"\n".concat(JSON.stringify(a,null,2)).concat(n?",":"","\n /* \n Documentation: \n").concat(JSON.stringify(t,null,2),"  \n*/")}),[n]),f=(0,y.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=b().find(a,(t=>t.name===e))||{};let i={};return b().isArray(n.input_contract)&&(i=n.input_contract.filter((e=>t.includes(null===e||void 0===e?void 0:e.name))).reduce(((e,t)=>(["input_data"].includes(null===t||void 0===t?void 0:t.name)||e.push({...t}),e)),[])),i}),[n]),g=e=>{const t=(e=>{try{return JSON.parse(e.replace(/\/\*[\s\S]*?\*\/|\/\/.*/g,"").trim())}catch(t){return}})(e);t&&(o(!0,t),p(t))};(0,y.useEffect)((()=>{m("")}),[]),(0,y.useEffect)((()=>{l&&l.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!1,schemaValidation:"error",comments:"ignore"})}),[l]);const v=(0,y.useMemo)((()=>b().isArray(n)?"[".concat(n.filter((e=>"transform"!==e)).map(((e,t)=>h(e,f(e.name,b().keys(null===e||void 0===e?void 0:e.params)),t<n.length-1))).join("\n"),"]"):h(n,f(null===n||void 0===n?void 0:n.transform,b().keys(n)))),[n]);return(0,U.jsxs)(U.Fragment,{children:[u?(0,U.jsx)(ze.A,{in:Boolean(u),className:d.mb2,children:(0,U.jsx)(B.A,{variant:"outlined",severity:"error",children:u})}):(0,U.jsx)(w.A,{display:"flex",justifyContent:"flex-end",children:(0,U.jsx)(kt.A,{onClick:()=>{s.current.getAction("actions.find").run("")},size:"large",children:(0,U.jsx)(nn.A,{})})}),(0,U.jsx)(tn.Ay,{height:"70vh",defaultLanguage:"json",defaultValue:v,options:{minimap:{enabled:!1},scrollbar:{vertical:"hidden",horizontal:"hidden",verticalHasArrows:!1,verticalSliderSize:0}},onValidate:e=>{b().isEmpty(e)?m(""):m("".concat(b().map(e,(e=>"".concat(e.message," at line ").concat(e.endLineNumber))).join("")))},onChange:e=>g(e),onMount:e=>{s.current=e}}),(0,U.jsxs)(w.A,{className:d.drawerFormButtonWrapper,children:[(0,U.jsx)(ye.A,{className:"".concat(d.drawerFormButton," ").concat(d.mr2),size:"large",startIcon:(0,U.jsx)(Ie.A,{}),variant:"outlined",color:"primary",onClick:i,"data-testid":"edit-step-form-close",children:x("model-builder.drawer-edit-step-btn-cancel")}),(0,U.jsx)(ye.A,{onClick:()=>{let e=n;b().isArray(c)?e=c:b().isEmpty(c)||(e={...n,...c}),r({data:e,customName:n.transform||t})},className:d.drawerFormButton,size:"large",variant:"contained",color:"primary","data-testid":"edit-step-form-submit",children:x("model-builder.drawer-edit-step-btn-add")})]})]})},on=e=>{let{isShow:t,amount:n=5,isRemoveArrow:a=!0}=e;const i=(0,dt.A)();return(0,U.jsx)(U.Fragment,{children:t?(0,U.jsx)(U.Fragment,{children:[...Array(n)].map(((e,t)=>(0,U.jsxs)(w.A,{children:[(0,U.jsx)(w.A,{children:(0,U.jsx)(Wt.A,{variant:"rectangular",height:"5rem",style:{margin:"auto"}})}),t<n?(0,U.jsx)(w.A,{className:i.IconWrapper,children:(0,U.jsx)(Ze,{disable:!0,isRemoveArrow:a})}):null]},"skeleton_".concat(t))))}):null})},rn="rgba(130, 130, 129,0.7)",ln="rgba(35,113,185,1)",sn="rgba(0,160,198,1.0)",dn=e=>{let{current:t,total:n,...a}=e;const{t:i}=(0,C.B)("models");return(0,U.jsxs)(w.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsx)(se.A,{variant:"determinate",...a}),(0,U.jsx)(w.A,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,U.jsx)(ve.A,{title:i("pipeline-builder.executing-automl-step"),children:(0,U.jsx)(Ae.A,{variant:"caption",component:"div",color:"text.secondary",style:{fontSize:"0.75rem"},children:"".concat(t,"/").concat(n)})})})]})};let cn=!1;const pn=e=>{var t,n,a;let{alertBuilder:o,pipelineSettings:r,selectedSteps:l,allSteps:s,transforms:d,isOptimizationRunning:c,isAutoML:p,pipelineStatus:u,pipelineUUID:m,pipelineData:h,projectUUID:f,getPipelineStepDataClass:g,getPipelineStepDescription:v,labelColors:A,onCloseAlertBuilder:j,onCreateNewStep:S,onDeleteStep:I,onEditStep:N,onEditPipelineSettings:_}=e;const{t:k}=(0,C.B)("models"),E=(0,dt.A)(),{showMessageSnackbar:T}=(0,he.O4)(),B=(0,y.useRef)(),D=(0,oe.A)(),[F,P]=(0,y.useState)({index:-1}),[L,R]=(0,y.useState)({index:-1}),[W,z]=(0,y.useState)({}),[O,M]=(0,y.useState)({index:-1}),[H,Y]=(0,y.useState)({}),[q,Q]=(0,y.useState)({}),[G,V]=(0,y.useState)({}),[$,J]=(0,y.useState)({}),[K,X]=(0,y.useState)({}),[Z,ee]=(0,y.useState)([]),[te,ne]=(0,y.useState)({}),[ae,ie]=(0,y.useState)([]),[re,le]=(0,y.useState)(!1),[de,ce]=(0,y.useState)({}),[pe,ue]=(0,y.useState)(!1),[me,xe]=(0,y.useState)(!1),[fe,ge]=(0,y.useState)(!1),[Pe,Re]=(0,y.useState)(!1),[ze,Oe]=(0,y.useState)(!1),[Me,He]=(0,y.useState)(b().uniqueId()),Ue=(0,y.useCallback)((e=>{switch(e){case x._Y.AUTOML_PARAMS:return rn;case x._Y.QUERY:case x._Y.CLASSIFIER:case x._Y.TRAINING_ALGORITHM:case x._Y.VALIDATION:return sn;case x._Y.MODEL_SETTINGS:return ln;default:return sn}}),[l]);(0,y.useEffect)((()=>{B.current=new AbortController}),[]);const Ye=(0,y.useCallback)((e=>{const t=Ue(e),n={borderColor:t};switch(e){case x._Y.CLASSIFIER:case x._Y.TRAINING_ALGORITHM:case x._Y.VALIDATION:n.borderBottom="4px solid ".concat(t);break;case x._Y.MODEL_SETTINGS:break;default:n.borderBottom="4px solid ".concat(t)}return n}),[l]),Qe=(0,y.useCallback)((e=>{var t,n,a;return(null===e||void 0===e?void 0:e.type)!==x._Y.AUTOML_PARAMS&&(!(null===e||void 0===e||null===(t=e.options)||void 0===t||!t.isSession||(null===e||void 0===e?void 0:e.type)===x._Y.INPUT_DATA)||(!(null===e||void 0===e||null===(n=e.options)||void 0===n||!n.isOptimizedByAutoML||(null===e||void 0===e?void 0:e.type)===x._Y.AUTOML_PARAMS)||([x._Y.CLASSIFIER,x._Y.TRAINING_ALGORITHM].includes(null===e||void 0===e?void 0:e.name)?!(null!==(a=r.data)&&void 0!==a&&a.disable_automl):c)))}),[l,c]),Ve=(e,t)=>{var n;let a=[];if(null===l||void 0===l||!l.length)return[];if(null!==t&&void 0!==t&&null!==(n=t.nextSteps)&&void 0!==n&&n.includes(x.bH)){var i,o,r;let t=e,n=null===(i=l[t])||void 0===i?void 0:i.nextSteps;for(;null!==(d=n)&&void 0!==d&&d.includes(x.bH)&&--t>0;){var d,c;n=null===(c=l[t])||void 0===c?void 0:c.nextSteps}null!==(o=l[t])&&void 0!==o&&null!==(r=o.nextSteps)&&void 0!==r&&r.includes(x.bH)||(a=n)}else null!==t&&void 0!==t&&t.nextSteps&&(a=[...null===t||void 0===t?void 0:t.nextSteps]);if(!a)return[];return a.filter((e=>{const t=null===l||void 0===l?void 0:l.filter((t=>t.name===e)),n=null===s||void 0===s?void 0:s.find((t=>t.name===e));if(null!==n&&void 0!==n&&n.mandatory&&n.type!==x._Y.SEGMENTER)return!1;if(null!==t&&void 0!==t&&t.length){var a;if(null===(null===(a=t[0])||void 0===a?void 0:a.limit))return!0;if(t[0].limit<=t.length)return!1}return!0})).filter((e=>s.find((t=>t.name===e))))},$e=(0,y.useMemo)((()=>{if(!b().isEmpty(L)){const{type:e,subtype:t,transformList:n,excludeTransform:a,id:i}=L,o=g({type:e,subtype:t,id:i,isAutoML:p,selectedSteps:[L]});return{inputData:o.getInputsData({transformList:n,excludeTransform:a}),queryColumns:o.queryColumns}}return{}}),[L]),Ke=(0,y.useMemo)((()=>b().isEmpty(null===L||void 0===L?void 0:L.options)?null===L||void 0===L?void 0:L.options:{...null===L||void 0===L?void 0:L.options,queryColumns:$e.queryColumns}),[L,$e]),Xe=e=>{const{descriptionParameters:t=[]}=(null===e||void 0===e?void 0:e.find((e=>{var t;return null===(t=e.descriptionParameters)||void 0===t?void 0:t.length})))||{};return t};(0,y.useEffect)((()=>{if(null!==l&&void 0!==l&&l.length){const e=l.find((e=>{var t;return null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.is_should_be_reviewed}));e&&R(e);const t=l.reduce(((e,t)=>{let{type:n,subtype:a,id:i}=t;return e[i]=g({type:n,subtype:a,id:i,isAutoML:p,selectedSteps:l}).getCardParams(),e}),{});X(t)}}),[l]);const et=e=>e&&"None"!==e[0]&&e[0],nt=(e,t)=>{var n;return!(e=>{var t,n;return!!l[e+1]&&(null===(t=l[e+1])||void 0===t||null===(n=t.options)||void 0===n?void 0:n.isSessionPreprocess)})(e)&&Boolean(null===(n=Ve(e,t))||void 0===n?void 0:n.length)&&!c},at=e=>{var t;let n=!0;if(e>0&&(null===(t=l[e])||void 0===t?void 0:t.type)!==x._Y.AUTOML_PARAMS){let t;for(t=0;t<e;++t){var a;null!==(a=l[t])&&void 0!==a&&a.data||(n=!1)}}return n},it=e=>{var t;return!e.mandatory&&!(null!==e&&void 0!==e&&null!==(t=e.options)&&void 0!==t&&t.isSession)&&!c},ot=(e,t)=>{const n={...t};n.nextSteps=Ve(e,t),M({...n,index:e})},rt=e=>{var t;const{descpription:n,docLink:a}=v(e.name),{type:i,subtype:o,transformList:r,excludeTransform:s,id:c}=e,u=b().find(d,(t=>{var n;return t.name===(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.transform)}))||{},{QUERY:m,FEATURE_GENERATOR:h,FEATURE_SELECTOR:f}=x._Y;let A=[];[m,h,f].includes(e.type)||(A=e.data);let y={};[m].includes(e.type)&&(y=(()=>{const t=g({type:i,subtype:o,id:c,isAutoML:p,selectedSteps:l}).getInputsData({transformList:r,excludeTransform:s});return Xe(t).find((t=>t.name===e.customName))||{}})()),P({isOpen:!0,...e,options:{descriptionParameters:y},descpription:n,transformName:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.transform,transformDescription:u.description,dataParams:A,docLink:a})},lt=()=>{fe?Re(!0):(Oe(!1),R({}))},st=(e,t,n,a)=>{if(!fe&&e&&ge(e),e)if(b().isArray(t))z(t);else if(n)z({...t});else{const e=L.data||{};if(b().includes(a,"is_use_")&&!1===t[a]){const t=b().replace(a,"is_use_","");e[t]=void 0}z((n=>({...e,...n,...t})))}},pt=e=>{let{data:t,customName:n,options:a,type:i}=e;i===x._Y.AUTOML_PARAMS?_({...L,data:t,customName:n,options:a}):N({...L,data:t,customName:n,options:a}),ge(!1),Oe(!1),R({})},xt=()=>{re||(ue(!1),le(!1),ie([]),ee([]),ne({}))},ht=e=>e-1,ft=(0,y.useCallback)(((e,t)=>{if("tvo"===(null===u||void 0===u?void 0:u.step_name)&&(null===u||void 0===u?void 0:u.step_name)===t.type&&"FAILURE"===u.status)return(0,U.jsx)(ve.A,{title:k("pipeline-builder.step-failed"),children:(0,U.jsx)(Ie.A,{style:{color:"red"}})});if(e.index===ht(null===u||void 0===u?void 0:u.step_index)&&"FAILURE"===u.status)return(0,U.jsx)(ve.A,{title:k("pipeline-builder.step-failed"),children:(0,U.jsx)(Ie.A,{style:{color:"red"}})});if(c){if((null===u||void 0===u?void 0:u.step_name)===x.me.TVO.type&&(null===u||void 0===u?void 0:u.step_name)===t.type)return(0,U.jsx)(ve.A,{title:k("pipeline-builder.executing-step"),children:(0,U.jsx)(se.A,{size:"1.5rem",color:"primary"})});if((null===u||void 0===u?void 0:u.step_name)!==x.me.TVO.type&&e.index===ht(null===u||void 0===u?void 0:u.step_index))return(0,U.jsx)(ve.A,{title:k("pipeline-builder.executing-step"),children:(0,U.jsx)(se.A,{size:"1.5rem",color:"primary"})});if(e.index<ht(null===u||void 0===u?void 0:u.step_index))return"RCL"!==(null===u||void 0===u?void 0:u.iteration)&&!b().isUndefined(null===u||void 0===u?void 0:u.iteration_start_index)&&(null===e||void 0===e?void 0:e.index)>=ht(null===u||void 0===u?void 0:u.iteration_start_index)?(0,U.jsx)(dn,{size:"2rem",color:"primary",variant:"determinate",value:100*b().divide(u.iteration,null===u||void 0===u?void 0:u.total_iterations),current:u.iteration,total:u.total_iterations}):b().isUndefined(null===u||void 0===u?void 0:u.iteration_start_index)||e.index<ht(null===u||void 0===u?void 0:u.iteration_start_index)?(0,U.jsx)(ve.A,{title:k("pipeline-builder.cached-step"),children:(0,U.jsx)(_e.A,{style:{color:"rgb(112, 206, 128)"}})}):(0,U.jsx)(ve.A,{title:k("pipeline-builder.automl-completed-step"),children:(0,U.jsx)(Ne.A,{style:{color:"rgb(112, 206, 128)"}})})}else{var n,a;if(null!==e&&void 0!==e&&null!==(n=e.options)&&void 0!==n&&n.isCached&&(null===e||void 0===e||null===(a=e.options)||void 0===a?void 0:a.type)!==x.me.TVO.type)return(0,U.jsx)(ve.A,{title:k("pipeline-builder.cached-step"),children:(0,U.jsx)(_e.A,{style:{color:"rgb(112, 206, 128)"}})});if("SUCCESS"===(null===u||void 0===u?void 0:u.status))return(0,U.jsx)(ve.A,{title:k("pipeline-builder.automl-completed-step"),children:(0,U.jsx)(Ne.A,{style:{color:"rgb(112, 206, 128)"}})})}return(0,U.jsx)(ve.A,{title:k("pipeline-builder.non-run-step"),children:(0,U.jsx)(we.A,{style:{color:"silver"}})})}),[l,L,u,c]),vt=()=>(0,U.jsx)(ve.A,{title:k("flow-builder.card-step-help-info"),placement:"top",children:(0,U.jsx)(be.A,{className:"".concat(E.cardInfoIcon),onClick:e=>rt(r),"data-test":"info-link",children:(0,U.jsx)(Ee.A,{style:{color:D.colorEditIcons},fontSize:"xsmall"})})});return(0,U.jsxs)(w.A,{"data-test":"ppl-step-builder",className:E.pipelineBuilderWrapper,children:[(0,U.jsx)(qe,{dataTest:"ppl-card-step",className:Qe(r)?E.cardStepDisabledToEdit:"",disable:!at(r),style:{margin:"auto",marginBottom:"1rem",borderBottom:"4px solid ".concat(rn)},onInfo:e=>rt(r),onEdit:e=>R(r),children:(0,U.jsx)(w.A,{className:E.cardTextWrap,children:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("span",{children:"Pipeline Settings"}),(0,U.jsx)(w.A,{className:E.cardParamsWrapper,children:(At=r.id,K[At]||[]).map(((e,t)=>(0,U.jsx)(ve.A,{title:null===e||void 0===e?void 0:e.tooltip,children:(0,U.jsxs)(w.A,{className:"".concat(E.cardParamsWrap),children:[(0,U.jsx)("span",{children:e.label}),(0,U.jsx)("span",{children:e.value})]})},"".concat(e.name,"_").concat(t))))})]})})}),b().entries(x.me).map((e=>{let[t,n]=e;const a=l.filter((e=>{var t;return n.type===(null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.type)}));return(0,U.jsxs)(w.A,{children:[(0,U.jsxs)(w.A,{className:E.groupBox,children:[(0,U.jsx)("div",{className:E.groupHeader,children:n.name}),b().isEmpty(a)?(0,U.jsx)(on,{isShow:!(null!==l&&void 0!==l&&l.length),amount:2}):a.map((e=>{var t,a,i,o,l;return(0,U.jsxs)(w.A,{className:E.stepWrapper,"data-test":"ppl-step-wapper","data-cy":e.name,children:[(0,U.jsx)(qe,{dataTest:"ppl-card-step",className:Qe(e)?E.cardStepDisabledToEdit:"",icon:ft(e,n),disable:!at(e.index),isFlashingEdit:at(e.index)&&!(null!==e&&void 0!==e&&e.data),style:Ye(e.type),onInfo:t=>rt(e),onEdit:Qe(e)?void 0:t=>{return n=e.index,a=e,R({}),void R({...a,index:n});var n,a},onDelete:it(e)?t=>{return n=e.index,a=e,void Q({...a,index:n});var n,a}:void 0,onDownloadCache:null!==e&&void 0!==e&&null!==(t=e.options)&&void 0!==t&&t.isCached?t=>((e,t)=>{var n,a;ue(!0),ee(b().keys(null===t||void 0===t||null===(n=t.options)||void 0===n?void 0:n.cacheData)),ne(null===t||void 0===t||null===(a=t.options)||void 0===a?void 0:a.cacheData)})(0,e):null,onOpenCacheChart:null!==e&&void 0!==e&&null!==(a=e.options)&&void 0!==a&&null!==(i=a.cacheData)&&void 0!==i&&i.isHasDistributionData?t=>((e,t)=>{var n;xe(!0),ce(null===t||void 0===t||null===(n=t.options)||void 0===n?void 0:n.cacheData)})(0,e):null,children:(0,U.jsx)(w.A,{className:E.cardTextWrap,children:e.customName===e.name||null!==e&&void 0!==e&&null!==(o=e.options)&&void 0!==o&&o.isOptimizedByAutoML?(0,U.jsx)(U.Fragment,{children:(0,U.jsxs)(w.A,{display:"flex",alignItems:"center",children:[" ",(0,U.jsx)("span",{children:k("model-builder.card-type-prefix",{FunctionSubType:e.name})}),(0,U.jsx)(vt,{})]})}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(w.A,{display:"flex",alignItems:"center",children:[(0,U.jsx)("span",{children:e.name}),(0,U.jsx)(vt,{})]}),![x._Y.CLASSIFIER,x._Y.TRAINING_ALGORITHM].includes(e.name)||null!==r&&void 0!==r&&null!==(l=r.data)&&void 0!==l&&l.disable_automl?(0,U.jsx)("span",{children:(0,Te.Hr)(e.customName,50)}):null,!at(e.index)||null!==e&&void 0!==e&&e.data?(0,U.jsx)("span",{}):(0,U.jsx)("span",{className:E.dangerColor,children:" *"})]})})}),(null===O||void 0===O?void 0:O.index)===e.index?(0,U.jsxs)(w.A,{className:E.NewCardWrapper,children:[(0,U.jsx)(tt,{className:E.fullWidthIcon}),(0,U.jsx)(Ge,{className:Ye(H.type),borderColor:Ue(H.type),children:(0,U.jsxs)(w.A,{className:E.cardTextWrap,children:[(0,U.jsx)("span",{children:H.name}),(0,U.jsx)("span",{children:(0,Te.Hr)(H.customName,50)})]})})]}):et(e.nextSteps)&&"tvo"!==n.type&&!nt(e.index,e)?(0,U.jsx)(w.A,{className:E.IconWrapper,children:(0,U.jsx)(Ze,{dataTest:"ppl-step-next",disable:!at(e.index)||!at(e.index+1),isRemoveArrow:!0,onClick:t=>ot(e.index,e)})}):et(e.nextSteps)&&"tvo"!==n.type?(0,U.jsx)(w.A,{className:E.IconWrapper,children:(0,U.jsx)(Je,{dataTest:"ppl-step-add",disable:!at(e.index)||!at(e.index+1),onClick:t=>ot(e.index,e),isRemoveArrow:!0})}):(0,U.jsx)(w.A,{mb:2})]},"step_".concat(n.type,"_").concat(e.name).concat(e.index))}))]}),"tvo"!==n.type?(0,U.jsx)(w.A,{className:E.IconWrapper,children:(0,U.jsx)(w.A,{style:{marginTop:"-1rem"},children:(0,U.jsx)(Ze,{dataTest:"ppl-step-add"})})}):null]},"group_".concat(n.type))})),O.nextSteps?(0,U.jsx)(ct,{isOpen:Boolean(O.nextSteps),availableSteps:O.nextSteps||[],allSteps:s||[],getPipelineStepDescription:v,onCreate:()=>{const e=S(O.index+1,H);M({index:-1}),R({index:O.index+1,...H,id:e})},onChangeStep:e=>{Y(e)},onClose:()=>(M({index:-1}),void Y({})),onShowInformation:e=>{const{descpription:t,docLink:n}=v(e);V({title:e,descpription:t,docLink:n})}}):null,(0,U.jsx)(gt,{isOpen:Boolean(null===F||void 0===F?void 0:F.isOpen),onClose:()=>{P({})},content:null===F||void 0===F?void 0:F.descpription,docLink:null===F||void 0===F?void 0:F.docLink,name:null===F||void 0===F?void 0:F.name,descriptionParameters:null===F||void 0===F||null===(t=F.options)||void 0===t?void 0:t.descriptionParameters,dataParams:(null===F||void 0===F?void 0:F.dataParams)||{},transformDescription:null===F||void 0===F?void 0:F.transformDescription,transformName:null===F||void 0===F?void 0:F.transformName,type:null===F||void 0===F?void 0:F.type}),(0,U.jsx)(ut,{isOpen:Boolean(L.name),onClose:()=>lt(),name:L.name,type:L.type,onChangeEditMode:()=>{He(b().uniqueId()),Oe(!ze),fe&&R((e=>({...e,data:W})))},isJsonEditMode:ze,jsonEditModeLabel:k("model-builder.drawer-edit-step-json-mode"),alertMessage:null===L||void 0===L||null===(n=L.options)||void 0===n?void 0:n.message,alertSeverity:null===L||void 0===L||null===(a=L.options)||void 0===a?void 0:a.messageType,children:ze?(0,U.jsx)(an,{name:L.name,type:L.type,data:L.data,transforms:d,onChangeData:st,onClose:()=>lt(),onSubmit:pt}):(0,U.jsx)(en,{type:L.type,name:L.name,options:Ke,isAutoML:p,transforms:d,isFormOptionsDisabled:(()=>{var e,t;return(null===L||void 0===L||null===(e=L.options)||void 0===e?void 0:e.isSessionPreprocess)||(null===L||void 0===L||null===(t=L.options)||void 0===t?void 0:t.isSessionSegmenter)})(),inputData:$e.inputData,onSubmit:pt,onShowInfo:(e,t)=>{J({title:e,descpription:t})},onClose:()=>lt(),onChangeData:st,getQueriesDescriptionParameters:Xe,editFormKeyId:Me})}),(0,U.jsx)(mt,{isOpen:Boolean(o.message),message:o.message,parameters:o.parameters,header:o.title,onClose:()=>j()}),(0,U.jsx)(Be.Z,{isOpen:Boolean(q.type),title:k("model-builder.dialog-confirm-delete-title",{name:q.customName}),text:k("model-builder.dialog-confirm-delete-text",{name:q.customName}),onCancel:()=>{Q({})},onConfirm:()=>{I(q),Q({})},cancelText:k("dialog-confirm-delete.cancel"),confirmText:k("dialog-confirm-delete.delete")}),b().isEmpty(L)?null:(0,U.jsx)(Be.Z,{isOpen:Boolean(Pe),title:k("model-builder.dialog-confirm-skip-unsaved-title",{name:L.customName}),text:k(L.customName===x.uo?"model-builder.dialog-confirm-skip-unsaved-text":"model-builder.dialog-confirm-save-unsaved-text",{name:L.customName}),backText:k("model-builder.dialog-confirm-skip-unsaved-btn-back"),cancelText:k("model-builder.dialog-confirm-skip-unsaved-btn-cancel"),confirmText:k("model-builder.dialog-confirm-skip-unsaved-btn-confirm"),onBack:()=>{Oe(!1),Re(!1)},onCancel:()=>{ge(!1),Oe(!1),Re(!1),z({}),R({})},onConfirm:L.customName!==x.uo&&(()=>{ge(!1),pt({data:W,customName:(null===W||void 0===W?void 0:W.transform)||(null===L||void 0===L?void 0:L.customName)}),Oe(!1),Re(!1),z({}),R({})}),isCancelSecondary:!0}),(0,U.jsxs)(De.A,{isOpen:Boolean($.descpription),onClose:()=>{J({})},children:[(0,U.jsx)(Ae.A,{variant:"h2",className:E.infoTitle,children:$.title}),(0,U.jsx)(Ae.A,{children:(0,U.jsx)("pre",{style:{fontFamily:"inherit"},children:$.descpription})})]}),(0,U.jsxs)(De.A,{isOpen:Boolean(G.title),onClose:()=>{V({})},children:[(0,U.jsx)(Ae.A,{variant:"h2",className:E.infoTitle,children:G.title}),(0,U.jsx)(Ae.A,{paragraph:!0,children:G.descpription}),(0,U.jsx)(Ae.A,{paragraph:!0,children:(0,U.jsx)(be.A,{href:G.docLink,target:"_blank",children:k("model-builder.drawer-step-info-doc-link")})})]}),me?(0,U.jsx)(Le,{onClose:(e,t)=>{xe(!1),ce([])},isOpen:me,labelColors:A,data:de}):null,(0,U.jsx)(Fe.A,{isOpen:pe,isCloseDisabled:re,onClose:xt,maxWidth:"sm",actionsComponent:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(ye.A,{onClick:()=>{re&&(cn=!1,B.current.abort(),le(!1),ie([])),ue(!1),ee([]),ne({})},color:"primary",variant:"outlined",fullWidth:!0,children:k("model-builder.download-cache-btn-cancel")}),(0,U.jsx)(ye.A,{fullWidth:!0,variant:"contained",disableElevation:!0,onClick:async()=>{cn=!0,le(!0);for(const t of Z){const{indexStep:n,indexPage:a,stepName:o}=te[t];if(!cn)break;try{const{data:e}=await i.Ay.get("/project/".concat(f,"/sandbox/").concat(m,"/data/"),{signal:B.current.signal,params:{pipeline_step:n,page_index:a}});ie((e=>[...e,"".concat(n,"_").concat(a)])),null!==e&&void 0!==e&&e.results&&cn&&We()(JSON.stringify(e.results),"".concat(null===h||void 0===h?void 0:h.name,".").concat(o,".cache.").concat(a,".json"))}catch(e){const t=(0,i._R)(e,"ds");T("error",t.message)}}xt()},disabled:b().isEmpty(Z)||re,children:k("model-builder.download-cache-btn")})]}),children:(0,U.jsx)(je.A,{justifyContent:"center",width:"100%",children:b().entries(te).map((e=>{let[t,{stepName:n,indexStep:a,indexPage:i}]=e;return(0,U.jsx)(w.A,{mt:2,children:re&&Z.includes(t)?(0,U.jsxs)(je.A,{pt:1,pb:1,spacing:1,direction:"row",children:[ae.includes("".concat(a,"_").concat(i))?(0,U.jsx)(ke.A,{size:"1.5rem",color:"success"}):(0,U.jsx)(se.A,{size:"1.5rem"}),(0,U.jsx)(Ae.A,{children:"".concat(null===h||void 0===h?void 0:h.name,".").concat(n,".cache.").concat(i,".json")})]}):(0,U.jsx)(Se.A,{control:(0,U.jsx)(Ce.A,{checked:Z.includes(t),onClick:e=>{return n=t,void(Z.includes(n)?ee((e=>e.filter((e=>e!==n)))):ee((e=>[...e,n])));var n},disabled:re}),label:"".concat(null===h||void 0===h?void 0:h.name,".").concat(n,".cache.").concat(i,".json")})},"cache_download_menu_".concat(t))}))})})]});var At},un=e=>{const{selectedSteps:t,pipelineData:n}=e,a=(0,y.useMemo)((()=>t.find((e=>(null===e||void 0===e?void 0:e.type)===x._Y.AUTOML_PARAMS))),[t]),i=(0,y.useCallback)((()=>{var e;return null!==a&&void 0!==a&&null!==(e=a.data)&&void 0!==e&&e.disable_automl?[]:x.e9.reduce(((e,t)=>(null!==a&&void 0!==a&&a.data[t.paramName]&&e.push(t.stepType),e)),[x._Y.AUTOML_PARAMS])}),[t]),o=(0,y.useMemo)((()=>{const e=(e,t)=>t?x.me.TVO.type:e?x.me.FEATURE_EXTRACOR.type:x.me.PEPROCESSING.type;if(!b().isEmpty(t)&&!b().isEmpty(n)){let a=!1,o=!1,r=!1;return t.filter((e=>{var t;return!(null!==e&&void 0!==e&&null!==(t=e.options)&&void 0!==t&&t.isSessionSegmenter)})).map(((t,l)=>{var s;const d=null!==n&&void 0!==n&&n.pipeline?null===n||void 0===n?void 0:n.pipeline[l]:{},c=null===n||void 0===n||null===(s=n.cache)||void 0===s?void 0:s.pipeline[l];let p=!1;return((e,t)=>!(!e||!t)&&(null===t||void 0===t?void 0:t.name)===e.name&&(b().isEmpty(null===e||void 0===e?void 0:e.set)?b().isEqual(null===e||void 0===e?void 0:e.inputs,null===t||void 0===t?void 0:t.inputs):b().isEqual(null===e||void 0===e?void 0:e.set,null===t||void 0===t?void 0:t.set)))(d,c)?p=!0:a=!0,t.type===x._Y.FEATURE_GENERATOR&&(o=!0),t.type===x._Y.CLASSIFIER&&(r=!0),{...t,index:l,options:{isCached:p&&!a,cacheData:p&&!a?(()=>{const e={},a=null===d||void 0===d?void 0:d.outputs[0];if(a){var i,o,r;const s=b().isArray(null===n||void 0===n||null===(i=n.cache)||void 0===i?void 0:i.data[a])?null===n||void 0===n||null===(o=n.cache)||void 0===o?void 0:o.data[a]:[null===n||void 0===n||null===(r=n.cache)||void 0===r?void 0:r.data[a]];let d=!1;s.forEach(((n,a)=>{b().isEmpty(n.distribution_segments)&&b().isEmpty(n.distribution_feature_vectors)&&b().isEmpty(n.distribution_samples)||(d=!0),e[n.filename]={indexStep:l,indexPage:a,stepName:t.name,distributionSegments:n.distribution_segments,distributionFeatureVectors:n.distribution_feature_vectors,distributionSamples:n.distribution_samples}})),e.isHasDistributionData=d}return e})():{},type:e(o,r),...t.options,isOptimizedByAutoML:(u=t.type,i().includes(u))}};var u}))}return[]}),[t,n]);return(0,U.jsx)(U.Fragment,{children:(0,U.jsx)(pn,{...e,isAutoML:!1,selectedSteps:o})})};var mn=n(62582),xn=n(90705),hn=n(5259);const fn=e=>{let{autosenseMetrics:t,projectUUID:n,pipelineUUID:a}=e;const i=(0,S.useHistory)(),{t:o}=(0,C.B)("models"),[r,l]=(0,y.useState)({data:t,loading:!1}),s=e=>{const t={...n&&{projectUUID:n},...a&&{pipelineUUID:a},...e&&{modelUUID:e}};return(0,S.generatePath)(fe.bw.MAIN.MODEL_EXPLORE.path,t)};(0,y.useEffect)((()=>{l({data:t,loading:!1})}),[t]);const d=e=>e?isNaN(e)?e.toUpperCase():Number(e).toFixed(0):"",c=[{field:"name",title:o("model-builder.table-autosense-model-name"),primary:!0},{field:"accuracy",title:o("model-builder.table-autosense-model-accuracy"),render:d},{field:"classifiers_sram",title:o("model-builder.table-autosense-model-classifiers_sram"),render:d},{field:"features",title:o("model-builder.table-autosense-model-features"),render:d},{field:"sensitivity",title:o("model-builder.table-autosense-model-sensitivity"),render:d},{field:"f1_score",title:o("model-builder.table-autosense-model-f1_score"),render:d},{field:"knowledgepack",title:"",render:(e,t)=>(0,U.jsx)(ve.A,{title:"Explore Model..",children:(0,U.jsx)(mn.N_,{to:s(t.knowledgepack),children:(0,U.jsx)(kt.A,{variant:"contained",color:"primary",size:"small",children:(0,U.jsx)(xn.A,{})})})})}],p={rowsPerPage:5,showPagination:!1,noContentText:o("model-builder.table-autosense-model-no-data"),tableProps:{size:"medium"},onRowDoubleClick:(e,t)=>{i.push(s(t.knowledgepack))}};return(0,U.jsx)(hn.A,{tableId:"autoSenseMetricsTable",tableColumns:c,tableData:r,tableOptions:p})};var gn=n(52437);const vn=e=>{let{iterationMetrics:t}=e;const{t:n}=(0,C.B)("models"),[a,i]=(0,y.useState)({data:null===t||void 0===t?void 0:t.data,loading:!1});(0,y.useEffect)((()=>{i({data:null===t||void 0===t?void 0:t.data,loading:!1})}),[t]);const o=e=>e?isNaN(e)?e.toUpperCase():Number(e).toFixed(2):"",r=e=>Number(e),l=e=>{if(!e)return"";if(null!==e&&void 0!==e&&e.name){const t=JSON.stringify(e.inputs,null,2);return(0,U.jsx)(ve.A,{title:(0,U.jsx)(Ae.A,{variant:"body2",component:"pre",children:t}),children:(0,U.jsx)(w.A,{children:e.name})})}return isNaN(e)?e.toUpperCase():Number(e).toFixed(0)},s=[{field:"f1_score",title:n("model-builder.table-iterations-f1-score"),primary:!0,sortable:!0,type:gn.$.Numeric,render:o},{field:"classifiers",title:n("model-builder.table-iterations-classifer"),render:l,type:gn.$.Text},{field:"optimizers",title:n("model-builder.table-iterations-optimizer"),render:l,type:gn.$.Text},{field:"features",title:n("model-builder.table-iterations-features"),sortable:!0,render:r,type:gn.$.Numeric},{field:"sram",title:n("model-builder.table-iterations-sram"),sortable:!0,render:r,type:gn.$.Numeric},{field:"accuracy",title:n("model-builder.table-iterations-accuracy"),sortable:!0,render:o,type:gn.$.Numeric},{field:"sensitivity",title:n("model-builder.table-iterations-sensitivity"),sortable:!0,render:o,type:gn.$.Numeric},{field:"original_iteration",title:n("model-builder.table-iterations-iteration"),sortable:!0,render:r,type:gn.$.Numeric}],d={rowsPerPage:25,showPagination:!0,rowsPerPageOptions:[10,25,50,100,"All"],noContentText:"No Data",applyFilters:!0,tableProps:{size:"medium"},onRowDoubleClick:()=>{}};return(0,U.jsx)(hn.A,{tableId:"autoSenseIterationsTable",tableColumns:s,tableData:a,tableOptions:d})};var An=n(86328),bn=n(57182);const yn=e=>{let{isShowQueryCacheAlert:t,selectedQuery:n,queryCacheStatusData:a,loadQuery:i,onBuildCache:o,onDismiss:r,isButtonsPanel:l}=e;const s=(0,dt.A)();return(0,U.jsx)(An.A,{in:t,className:s.queryAlert,children:(0,U.jsx)(w.A,{children:t?(0,U.jsx)(w.A,{mt:1,children:(0,U.jsx)(bn.A,{title:"Input Query",selectedQuery:n,queryCacheStatusData:a,loadQuery:i,onBuildCache:o,onDismiss:r,isButtonsPanel:l})}):null})})},jn=["window_size","min_segment_length"],Sn=0,Cn=1,wn=2,In=e=>{let{alertBuilder:t,pipelineValidationError:n,isAdvancedBuilding:a,defaultOptions:i,pipelineHierarchyRules:o,transforms:r,selectedPipeline:s,pipelineData:d,selectedProjectObj:c,autoMLParams:p,navBarIsOpen:u,getQueryData:m,getPipelineStepDataClass:h,getPipelineStepDescription:f,queryList:g,queryCacheStatusData:v,clearAlertBuilder:A,clearPipelineValidationError:M,loadPipelinesHierarchyRules:H,iterationMetrics:Y,optimizationLogs:q,pipelineRunningStatus:Q,pipelineStatus:G,pipelineResultData:V,labelColors:J,setIsAdvancedBuilding:K,clearOptimizationLogs:X,clearPipelineResults:ee,clearPipelineStatus:te,setPipelineStep:ne,setPipelineDefaultSteps:ae,updatePipelineStepsWithQuery:ie,launchModelOptimization:oe,checkOptimizationStatus:re,loadPipelineBuilderData:se,loadDataAfterTraining:ce,stopModelOptimization:ve,loadPipelineResults:Ae,loadQueryCacheStatus:be,buildQueryCache:ye,clearQueryCacheStatus:je,loadQueryStatistic:Se,loadQuerySegmentStatistic:Ce,loadPipeline:we,clearPipeline:Ie,downloadPipelineStepCache:Ne,setSelectedPipeline:_e,exportPipeline:ke}=e;const{t:Ee}=(0,C.B)("models"),{t:Te}=(0,C.B)("queries"),Be=(0,y.useRef)(),De=(0,y.useRef)(),Fe=(0,dt.A)(u),Pe=(0,S.useHistory)(),[Le,Re]=(0,y.useState)(!1),{projectUUID:We,pipelineUUID:ze}=(0,S.useParams)(),[Oe,Me]=(0,y.useState)([]),[He,Ue]=(0,y.useState)([]),[Ye,qe]=(0,y.useState)({}),[Qe,Ge]=(0,y.useState)([]),[Ve,$e]=(0,y.useState)(!1),[Je,Ke]=(0,y.useState)(Sn),[Xe,Ze]=(0,y.useState)(!1),[et,tt]=(0,y.useState)({}),[nt,at]=(0,y.useState)(""),[it,ot]=(0,y.useState)({}),[rt,lt]=(0,y.useState)({}),[st,ct]=(0,y.useState)(-1),[pt,ut]=(0,y.useState)(null),mt=Boolean(pt),[xt,ht]=(0,y.useState)(!1),[ft,gt]=(0,y.useState)(""),[vt,At]=(0,y.useState)("success"),bt=()=>!b().isUndefined(v.status)&&!v.status&&!Qe.includes(null===Ye||void 0===Ye?void 0:Ye.uuid),yt=()=>{$e(!0)};(0,he.G4)((e=>{Re(e.innerWidth<Z.xp.WIDTH_FOR_SHORT_TEXT)}));const jt=(0,y.useMemo)((()=>{var e;if(n)return K(!0),{message:n,type:"error"};if(null!==et&&void 0!==et&&et.message)return K(!0),et;if(Xe)return K(!0),{message:Ee("model-builder.warning-if-not-filled"),type:"error"};if(null!==it&&void 0!==it&&it.segments&&b().isEmpty(b().keys(null===it||void 0===it?void 0:it.segments)))return{message:(0,U.jsxs)(U.Fragment,{children:[Te("validation.no-segments",{queryName:null===it||void 0===it?void 0:it.name}),(0,U.jsx)(w.A,{mt:1,children:Te("help.unknow")})]}),type:"warning"};if(null!==it&&void 0!==it&&it.segments&&(null===(e=b().keys(null===it||void 0===it?void 0:it.segments))||void 0===e?void 0:e.length)<2)return{message:(0,U.jsxs)(U.Fragment,{children:[Te("validation.not-enough-segments",{queryName:null===it||void 0===it?void 0:it.name,segments:b().keys(null===it||void 0===it?void 0:it.segments).join(", ")}),(0,U.jsx)(w.A,{mt:1,children:Te("help.unknow")})]}),type:"warning"};if(-1!==st&&!b().isEmpty(rt)&&!b().isEmpty(rt["Segment Length"])){var t,a;let e="";if(b().isEmpty(rt["Segment Length"].filter((e=>e>=st)))?e=Te("validation.too-large-window-size",{windowSize:st}):.2*(null===(t=rt["Segment Length"])||void 0===t?void 0:t.length)>(null===(a=rt["Segment Length"].filter((e=>e>=st)))||void 0===a?void 0:a.length)&&(e=Te("validation.possible-too-large-window-size",{windowSize:st})),e)return{message:e,type:"warning"}}return{}}),[n,et,Xe,it,rt,st]),St=(0,y.useMemo)((()=>!(null!==p&&void 0!==p&&p.disable_automl)),[p]);(0,he.$$)((async()=>{await(async()=>{await re(c.uuid,s)||($e(!1),ce(c.uuid,s))})()}),Ve?5e3:null),(0,y.useEffect)((()=>()=>A()),[]),(0,y.useEffect)((()=>()=>Ie()),[]),(0,y.useEffect)((()=>()=>M()),[]),(0,y.useEffect)((()=>()=>je()),[]),(0,y.useEffect)((()=>()=>te()),[]),(0,y.useEffect)((()=>($e(!1),X(),void ee())),[]),(0,y.useEffect)((()=>((async()=>{await we(We,ze),b().isEmpty(o)&&await H(),(async()=>{const[e,t]=await ae(i);Ue(t),null!==e&&void 0!==e&&e.length&&Me([...e]),Pe.replace({...Pe.location,state:void 0})})()})(),(async()=>{const e=await Ae(We,ze);e?yt():se(We,ze)})(),ze&&s!==ze&&_e(ze),()=>$e(!1))),[]),(0,y.useEffect)((()=>{null!==Ye&&void 0!==Ye&&Ye.uuid&&be(We,Ye.uuid)}),[Ye]);(0,y.useEffect)((()=>{var e,t;const n=(()=>{const e=Oe.find((e=>e.type===x._Y.SEGMENTER)),t=b().entries(null===e||void 0===e?void 0:e.data).find((e=>{let[t,n]=e;return jn.includes(t)}));return b().isEmpty(t)?-1:t[1]})();ct(n);const a=Oe.find((e=>e.type===x._Y.QUERY));var i,o,r,l,s,d,c,p;(a&&(null===a||void 0===a?void 0:a.customName)!==(null===Ye||void 0===Ye?void 0:Ye.name)&&(je(),qe(m(null===a||void 0===a?void 0:a.customName))),null!==a&&void 0!==a&&null!==(e=a.options)&&void 0!==e&&null!==(t=e.descriptionParameters)&&void 0!==t&&t.uuid)&&((async(e,t)=>{const n=await Se(We,e);ot({...n,uuid:e,name:t})})(null===a||void 0===a||null===(i=a.options)||void 0===i||null===(o=i.descriptionParameters)||void 0===o?void 0:o.uuid,null===a||void 0===a||null===(r=a.options)||void 0===r||null===(l=r.descriptionParameters)||void 0===l?void 0:l.name),(async(e,t)=>{const n=await Ce(We,e);lt({...n,uuid:e,name:t})})(null===a||void 0===a||null===(s=a.options)||void 0===s||null===(d=s.descriptionParameters)||void 0===d?void 0:d.uuid,null===a||void 0===a||null===(c=a.options)||void 0===c||null===(p=c.descriptionParameters)||void 0===p?void 0:p.name))}),[Oe,g]),(0,y.useEffect)((()=>{const e=Boolean(Oe.find((e=>!e.data)));e&&!a&&K(e),e!==Xe&&Ze(e),K(!0)}),[Oe]),(0,y.useEffect)((()=>{Q===Z.$Q.COMPLETED?Ke(Sn):Ve&&Ke(Cn)}),[Q,Ve]);const Ct=(e,t)=>{"clickaway"!==t&&ht(!1)},wt=async()=>{await _e(""),Pe.push((0,S.generatePath)(fe.bw.MAIN.MODEL_BUILD.child.SELECT_SCREEN.path,{projectUUID:We}))},It=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:He,n="";tt({});try{await ne(s,e,t)}catch(a){!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be.current.offsetTop;window.scrollTo({left:0,top:e,behavior:"smooth"})}(De),tt({message:a.message,type:"error"}),n=a.message}return te(),X(),ee(),n};return(0,U.jsxs)(w.A,{className:Fe.root,children:[(0,U.jsxs)(w.A,{mb:2,className:Fe.toptopPanelWrapperFixed,children:[(0,U.jsx)("div",{className:Fe.topPanelTopOverlap}),(0,U.jsx)(w.A,{className:Fe.topPanelWrapper,children:(0,U.jsx)(W.A,{title:Le?d.name:Ee("model-builder.pipeline-panel-header",{pipelineName:d.name}),turncateLenght:Le?Z.xp.TRUNCATE_NAME_OVER_SHORT_TEXT:Z.xp.TRUNCATE_NAME_OVER,onClickBack:Le?null:wt,actionsBtns:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(xe.bw,{variant:"contained",color:"primary",disabled:!(!Xe&&s&&!b().isEmpty(d))||Ve,onClick:()=>(async e=>{if($e(!0),!await It(Oe))try{Ke(Cn),await oe(Oe,He,e||x.xv.AUTO_ML_V2),yt()}catch(t){$e(!1),at(t.message)}})(x.xv.AUTO_ML_V2),isShort:Le,tooltip:Ee("model-builder.pipeline-panel-btn-start-tooltip"),text:Ee("model-builder.pipeline-panel-btn-start"),icon:(0,U.jsx)(D.A,{})}),(0,U.jsx)(xe.bw,{variant:"outlined",color:"primary",disabled:!1,onClick:()=>(async()=>{await ve(),$e(!1)})(),isShort:Le,tooltip:Ee("model-builder.pipeline-panel-btn-stop-tooltip"),text:Ee("model-builder.pipeline-panel-btn-stop"),icon:(0,U.jsx)(P.A,{})}),(0,U.jsx)(xe.bw,{color:"primary",variant:"outlined",onClick:e=>ut(e.currentTarget),isShort:Le,icon:(0,U.jsx)(L.A,{}),endIcon:(0,U.jsx)(R.A,{}),tooltip:Ee("model-builder.pipeline-panel-btn-export-tooltip"),text:Ee("Export")}),(0,U.jsx)(xe.bw,{variant:"outlined",color:"primary",disabled:!1,onClick:()=>wt(),isShort:Le,tooltip:"Switch pipelines",text:Ee("model-builder.pipeline-panel-btn-change"),icon:(0,U.jsx)(F.A,{})})]})})}),(0,U.jsx)("div",{className:Fe.topPanelBottomOverlap})]}),(0,U.jsxs)(I.Ay,{container:!0,spacing:4,children:[(0,U.jsxs)(I.Ay,{item:!0,lg:5,md:6,xs:12,mt:10,children:[bt()?(0,U.jsx)(w.A,{mb:1,children:(0,U.jsx)(yn,{isShowQueryCacheAlert:bt(),selectedQuery:null===Ye||void 0===Ye?void 0:Ye.uuid,queryCacheStatusData:v,loadQuery:()=>be(We,null===Ye||void 0===Ye?void 0:Ye.uuid),onBuildCache:e=>{ye(We,e)},onDismiss:e=>{Ge((t=>[...t,e]))},isButtonsPanel:!0})}):null,jt.message?(0,U.jsx)(N.A,{in:Boolean(jt.message),children:(0,U.jsx)(w.A,{mb:1,children:(0,U.jsx)(B.A,{variant:"outlined",severity:jt.type,children:jt.message})})}):null,(0,U.jsx)(w.A,{className:Fe.builderWrapper,children:(0,U.jsx)(un,{alertBuilder:t,onCloseAlertBuilder:()=>{A()},isCollapsed:!a,selectedSteps:Oe,pipelineSettings:He,pipelineUUID:ze,projectUUID:We,allSteps:o,isAutoML:!0,transforms:r,isOptimizationRunning:Ve,getPipelineStepDescription:f,pipelineData:d,pipelineStatus:G,labelColors:J,onCreateNewStep:(e,t)=>{const n=Oe.map((e=>e)),a=(0,l.LP)();return n.splice(e,0,{...t,mandatory:!1,id:a}),Me(n),It(n),a},onDeleteStep:e=>{const t=Oe.findIndex((t=>t.id===e.id)),n=[...Oe];n.splice(t,1),Me([...n]),It([...n])},onEditStep:async e=>{const t=Oe.findIndex((t=>t.id===e.id));let n=[...Oe];if(e.type===x._Y.QUERY&&(n=await ie(e,!0)),e.type===x._Y.CLASSIFIER){const t=Oe.find((e=>e.type===x._Y.CLASSIFIER)),a=n.findIndex((e=>e.type===x._Y.TRAINING_ALGORITHM));b().isEqual(t.customName,e.customName)||-1===a||(n[a].data=null,n[a].customName="")}n[t]={...e},Me(n);return It([...n])},onEditPipelineSettings:e=>{It(Oe,e),Ue(e)},getPipelineStepDataClass:h,handleChangeIsAutoMLAdvanced:(e,t)=>{K(t)},downloadPipelineStepCache:Ne})})]}),(0,U.jsx)(I.Ay,{item:!0,lg:7,md:6,xs:12,mt:10,children:(0,U.jsx)(w.A,{style:{width:"100%"},children:(0,U.jsxs)(j.A,{top:150,children:[(0,U.jsx)(w.A,{mb:1,children:(0,U.jsx)(_.A,{elevation:0,children:(0,U.jsxs)(k.A,{variant:"fullWidth",value:Je,onChange:(e,t)=>{Ke(t)},indicatorColor:"primary",textColor:"primary",scrollButtons:"auto","aria-label":"scrollable auto tabs",children:[(0,U.jsx)(E.A,{label:Ee("model-builder.tab-result-label-result")}),(0,U.jsx)(E.A,{label:(0,U.jsxs)(w.A,{className:Fe.tabWithCircularProgress,children:[(0,U.jsx)("div",{children:Ee("model-builder.tab-result-label-logs")}),Q?(0,U.jsx)(de,{status:Q}):null]})}),(0,U.jsx)(E.A,{label:(0,U.jsxs)(w.A,{className:Fe.tabWithCircularProgress,children:[(0,U.jsx)("div",{children:"Training Summary"}),Q?(0,U.jsx)(de,{status:Q}):null]})})]})})}),Je===Cn?(0,U.jsx)($,{children:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(pe,{consoleInfoChild:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(de,{status:Q}),(0,U.jsx)(ue,{className:Fe.ml1,status:Q,children:Q})]})}),(0,U.jsx)(le,{logs:q})]})}):Je===wn?(0,U.jsx)(U.Fragment,{children:St?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(me.f,{title:Ee("model-builder.automl-summary-table-title")}),(0,U.jsx)(vn,{iterationMetrics:Y})]}):(0,U.jsx)(me.f,{title:Ee("model-builder.summary-table-title")})}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(me.f,{title:Ee(St?"model-builder.automl-result-table-title":"model-builder.result-table-title")}),(0,U.jsx)(fn,{autosenseMetrics:V,projectUUID:c.uuid,pipelineUUID:s})]})]})})})]}),(0,U.jsx)(ge.O,{isOpen:Boolean(nt),onClose:()=>at(""),message:nt,variant:"error",autoHideDuration:5e3}),(0,U.jsx)(T.A,{anchorOrigin:{vertical:"top",horizontal:"right"},open:xt,autoHideDuration:2e3,onClose:Ct,children:(0,U.jsx)(O.A,{onClose:Ct,variant:vt,message:ft})}),(0,U.jsx)(z.A,{archorEl:pt,isOpen:mt,onClose:()=>{ut(null)},onDownloadPipeline:async e=>{try{await ke(We,ze,e)}catch(a){t="error",n=a.message,gt(n),At(t),ht(!0)}var t,n}})]})},Nn={clearAlertBuilder:c.$G,clearPipelineValidationError:c.FL,setIsAdvancedBuilding:c.lK,setPipelineStep:c.dZ,setPipelineDefaultSteps:c.xe,updatePipelineStepsWithQuery:c.TE,loadPipelinesHierarchyRules:d,checkOptimizationStatus:c.ug,loadPipelineBuilderData:c.i7,loadDataAfterTraining:c.z2,clearOptimizationLogs:p.ac,clearPipelineResults:p.et,clearPipelineStatus:p.Sz,launchModelOptimization:c.cg,stopModelOptimization:c.F5,loadPipelineResults:p.$q,loadQueryCacheStatus:u.lw,buildQueryCache:u.$1,clearQueryCacheStatus:u.QC,loadQueryStatistic:u.RF,loadQuerySegmentStatistic:u.K3,clearPipeline:p.U5,downloadPipelineStepCache:p.ZI,loadPipeline:p.Bp,setSelectedPipeline:p.E5,exportPipeline:p.dU},_n=(0,a.Ng)((e=>{var t,n,a,i,o,r,l,s,d,c,p,u,x,A,b,y,j,S;return{alertBuilder:(null===(t=e.containerBuildModel)||void 0===t?void 0:t.alertBuilder)||{},pipelineValidationError:null===(n=e.containerBuildModel)||void 0===n?void 0:n.pipelineValidationError,isAdvancedBuilding:(null===(a=e.containerBuildModel)||void 0===a?void 0:a.isAdvancedBuilding)||!1,defaultOptions:null===(i=e.router)||void 0===i||null===(o=i.location)||void 0===o?void 0:o.state,pipelineHierarchyRules:null===(r=e.autoML.pipelineHierarchyRules)||void 0===r?void 0:r.data,transforms:null===(l=e.transforms)||void 0===l?void 0:l.data,pipelines:e.pipelines.pipelineList.data,selectedPipeline:null===(s=e.pipelines)||void 0===s?void 0:s.selectedPipeline,pipelineData:(null===(d=e.pipelines)||void 0===d||null===(c=d.pipelineData)||void 0===c?void 0:c.data)||{},selectedProjectObj:(null===(p=e.projects)||void 0===p?void 0:p.selectedProject)||{},selectedSteps:(0,m.q$)(e),autoMLParams:(0,m.VS)(e),navBarIsOpen:null===e||void 0===e||null===(u=e.common)||void 0===u||null===(x=u.values)||void 0===x?void 0:x.navBarIsOpen,labelColors:(0,g.bi)("Label")(e),getQueryData:t=>(0,m.q8)(e,t),getPipelineStepDataClass:t=>(0,v.Ay)({...t,state:e}),getPipelineStepDescription:h,iterationMetrics:e.pipelines.iterationMetrics||[],optimizationLogs:e.pipelines.optimizationLogs||[],pipelineRunningStatus:e.pipelines.pipelineRunningStatus||"",pipelineStatus:null===(A=e.pipelines)||void 0===A?void 0:A.pipelineStatus.data,pipelineResultData:(0,f.Uj)(e),queryList:(null===(b=e.queries)||void 0===b||null===(y=b.queryList)||void 0===y?void 0:y.data)||[],queryCacheStatusData:null===(j=e.queries)||void 0===j||null===(S=j.queryCacheStatus)||void 0===S?void 0:S.data}}),Nn)(In)}}]);
//# sourceMappingURL=899.5474af4c.chunk.js.map